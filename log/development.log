  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateEmployees (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "employees" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" integer, "status" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUsers (20220729114712)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "email" varchar, "password_digest" varchar, "employee_id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_bb0d626f7d"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("email" varchar, "password_digest" varchar, "employee_id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_bb0d626f7d"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_users_on_employee_id" ON "users" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114712"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2022-07-29 12:01:05.790686"], ["updated_at", "2022-07-29 12:01:05.790686"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "users_details"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "users_details"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114712)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114712"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateEmployees (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "employees"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateEmployees (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "employees" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" integer, "status" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserDetails (20220729114712)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_details" ("email" varchar, "password_digest" varchar, "employee_id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_beef2de3b9"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_details_on_employee_id" ON "user_details" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114712"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserDetails (20220729114712)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "user_details"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114712"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateEmployees (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "employees"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" integer, "status" integer, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "employee_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_d5024e73a8"
FOREIGN KEY ("employee_id")
  REFERENCES "employees" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_employee_id" ON "user_roles" ("employee_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" integer, "status" integer, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:36:31 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Entity in 2ms (ActiveRecord: 0.0ms | Allocations: 1119)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.0.3.1) lib/action_controller/metal/request_forgery_protection.rb:251:in `handle_unverified_request'
actionpack (7.0.3.1) lib/action_controller/metal/request_forgery_protection.rb:284:in `handle_unverified_request'
actionpack (7.0.3.1) lib/action_controller/metal/request_forgery_protection.rb:273:in `verify_authenticity_token'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:400:in `block in make_lambda'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:199:in `block (2 levels) in halting'
actionpack (7.0.3.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:200:in `block in halting'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `block in invoke_before'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `each'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `invoke_before'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:116:in `block in run_callbacks'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:138:in `run_callbacks'
actionpack (7.0.3.1) lib/abstract_controller/callbacks.rb:233:in `process_action'
actionpack (7.0.3.1) lib/action_controller/metal/rescue.rb:22:in `process_action'
actionpack (7.0.3.1) lib/action_controller/metal/instrumentation.rb:67:in `block in process_action'
activesupport (7.0.3.1) lib/active_support/notifications.rb:206:in `block in instrument'
activesupport (7.0.3.1) lib/active_support/notifications/instrumenter.rb:24:in `instrument'
activesupport (7.0.3.1) lib/active_support/notifications.rb:206:in `instrument'
actionpack (7.0.3.1) lib/action_controller/metal/instrumentation.rb:66:in `process_action'
actionpack (7.0.3.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.0.3.1) lib/active_record/railties/controller_runtime.rb:27:in `process_action'
actionpack (7.0.3.1) lib/abstract_controller/base.rb:151:in `process'
actionview (7.0.3.1) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.3.1) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.3.1) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.4) lib/rack/tempfile_reaper.rb:15:in `call'
rack (2.2.4) lib/rack/etag.rb:27:in `call'
rack (2.2.4) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.4) lib/rack/head.rb:12:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack (2.2.4) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.4) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/cookies.rb:697:in `call'
activerecord (7.0.3.1) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
web-console (4.2.0) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/show_exceptions.rb:26:in `call'
railties (7.0.3.1) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `block in tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:38:in `tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `tagged'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.4) lib/rack/method_override.rb:24:in `call'
rack (2.2.4) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.3.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/server_timing.rb:20:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.4) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
railties (7.0.3.1) lib/rails/engine.rb:530:in `call'
puma (5.6.4) lib/puma/configuration.rb:252:in `call'
puma (5.6.4) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.4) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.4) lib/puma/request.rb:76:in `handle_request'
puma (5.6.4) lib/puma/server.rb:441:in `process_client'
puma (5.6.4) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:36:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:3:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip102@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 12:06:53.312921"], ["updated_at", "2022-07-30 12:06:53.312921"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 200 OK in 24ms (Views: 0.1ms | ActiveRecord: 2.5ms | Allocations: 9412)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:38:37 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip102@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 12:08:37.513706"], ["updated_at", "2022-07-30 12:08:37.513706"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 2288)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:43:34 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip102@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 12:13:34.312718"], ["updated_at", "2022-07-30 12:13:34.312718"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 2254)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:43:42 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip102@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 12:13:42.999543"], ["updated_at", "2022-07-30 12:13:42.999543"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 2248)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-07-30 17:44:02 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:3:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:4:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip102@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 12:14:02.213905"], ["updated_at", "2022-07-30 12:14:02.213905"]]
  ↳ app/controllers/users_controller.rb:4:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:4:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.6ms | Allocations: 203)
Completed 200 OK in 7ms (Views: 1.5ms | ActiveRecord: 1.0ms | Allocations: 6236)


  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", 0], ["status", 1], ["email", "kasi@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-07-30 16:02:29.581517"], ["updated_at", "2022-07-30 16:02:29.581517"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
Started POST "/api/v1/expense_tracker/user/login" for 127.0.0.1 at 2022-07-30 21:34:29 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}, "session"=>{"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:7:in `current_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:8:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:3:in `create'
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 11406)


Started POST "/api/v1/expense_tracker/user/login" for 127.0.0.1 at 2022-07-30 21:35:03 +0530
Processing by SessionsController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}, "session"=>{"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:7:in `current_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:8:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:3:in `create'
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2231)


Started POST "/api/v1/expense_tracker/user/login" for 127.0.0.1 at 2022-07-30 21:35:58 +0530
Processing by SessionsController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}, "session"=>{"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 3395)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:38:57 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 252ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 5412)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:41:34 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.6ms | Allocations: 368)
Completed 200 OK in 255ms (Views: 2.1ms | ActiveRecord: 1.0ms | Allocations: 7406)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:41:45 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 179)
Completed 200 OK in 249ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 1776)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:49:07 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.7ms | Allocations: 178)
Completed 200 OK in 253ms (Views: 1.3ms | ActiveRecord: 0.8ms | Allocations: 5628)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:49:12 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 1693)


  
NoMethodError (undefined method `errors' for nil:NilClass

    p @user.errors
           ^^^^^^^):
  
app/controllers/sessions_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 21:49:24 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.9ms | Allocations: 4216)


  
NoMethodError (undefined method `error' for nil:NilClass

    p @user.error
           ^^^^^^):
  
app/controllers/sessions_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:01:34 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.7ms | Allocations: 3247)


  
StandardError (Standard Error):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:04:08 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.7ms | Allocations: 3520)


  
StandardError (Standard Errorss):
  
app/controllers/sessions_controller.rb:9:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:06:00 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 4ms (ActiveRecord: 0.7ms | Allocations: 3455)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:07:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 1ms (ActiveRecord: 0.1ms | Allocations: 789)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:07:55 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 1ms (ActiveRecord: 0.1ms | Allocations: 787)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:13:01 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 282216ms (ActiveRecord: 0.4ms | Allocations: 91845)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:18:13 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 13259ms (ActiveRecord: 1.8ms | Allocations: 11407)


  
NoMethodError (undefined method `message' for StandardError:Class

    p StandardError.message
                   ^^^^^^^^):
  
app/controllers/application_controller.rb:18:in `error_response'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:20:16 +0530
  
NameError (undefined local variable or method `error' for ApplicationController:Class

  rescue_from StandardError => error, with: :error_response
                               ^^^^^):
  
app/controllers/application_controller.rb:6:in `<class:ApplicationController>'
app/controllers/application_controller.rb:1:in `<main>'
app/controllers/sessions_controller.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:22:33 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 10555ms (ActiveRecord: 1.6ms | Allocations: 12654)


  
NameError (undefined local variable or method `error' for #<SessionsController:0x0000000002bea8>

    p error.message
      ^^^^^):
  
app/controllers/application_controller.rb:18:in `error_response'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 22:22:56 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 2165ms (ActiveRecord: 1.1ms | Allocations: 9913)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:30:22 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NameError (uninitialized constant ApplicationController::ResponseError

  rescue_from ResponseError, with: :error_response_handler
              ^^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:6:in `<class:ApplicationController>'
app/controllers/application_controller.rb:1:in `<main>'
app/controllers/sessions_controller.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:30:57 +0530
  
NameError (uninitialized constant CustomError

Module CustomError
       ^^^^^^^^^^^):
  
app/controllers/concerns/custom_error.rb:1:in `<main>'
app/controllers/application_controller.rb:6:in `<class:ApplicationController>'
app/controllers/application_controller.rb:1:in `<main>'
app/controllers/sessions_controller.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:31:55 +0530
  
NameError (uninitialized constant CustomError

Module CustomError
       ^^^^^^^^^^^):
  
app/controllers/concerns/custom_error.rb:1:in `<main>'
app/controllers/application_controller.rb:3:in `<class:ApplicationController>'
app/controllers/application_controller.rb:1:in `<main>'
app/controllers/sessions_controller.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:35:22 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.8ms | Allocations: 7537)


  
NameError (uninitialized constant CustomError

Module CustomError
       ^^^^^^^^^^^):
  
app/controllers/concerns/custom_error.rb:1:in `<main>'
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:41:06 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.4ms | Allocations: 5764)


  
NameError (uninitialized constant SessionsController::CustomErrors

      raise CustomError::AuthenticationError.new('Invalid email, email does not exist', CustomErrors.BAD_REQUEST) 
                                                                                        ^^^^^^^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:41:37 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.5ms | Allocations: 4641)


  
NoMethodError (undefined method `BAD_REQUEST' for CustomError:Module

      raise CustomError::AuthenticationError.new('Invalid email, email does not exist', CustomError.BAD_REQUEST) 
                                                                                                   ^^^^^^^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:42:44 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.4ms | Allocations: 4614)


  
NoMethodError (undefined method `BAD_REQUEST' for CustomError:Module

      raise CustomError::AuthenticationError.new('Invalid email, email does not exist', CustomError.BAD_REQUEST) 
                                                                                                   ^^^^^^^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:42:59 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.3ms | Allocations: 6251)


  
NoMethodError (undefined method `BAD_REQUEST' for CustomError:Module

      raise CustomError::AuthenticationError.new('Invalid email, email does not exist', CustomError.BAD_REQUEST) 
                                                                                                   ^^^^^^^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:45:33 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.8ms | Allocations: 4559)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:46:27 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1836)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:46:39 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 1834)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:46:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1834)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:46:55 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 4ms (ActiveRecord: 0.9ms | Allocations: 3460)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:47:22 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 1ms (ActiveRecord: 0.1ms | Allocations: 786)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:48:16 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 20521ms (ActiveRecord: 0.6ms | Allocations: 11850)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:48:57 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3239ms (ActiveRecord: 1.7ms | Allocations: 17338)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:49:24 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 77489ms (ActiveRecord: 0.2ms | Allocations: 15557)


  
NoMethodError (undefined method `status_code' for #<CustomError::AuthenticationError: Invalid email, email does not exist>

    p exception.status_code
               ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:20:in `error_response_handler'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:51:03 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 200 OK in 7860ms (ActiveRecord: 1.3ms | Allocations: 16757)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-07-30 23:52:14 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 400 Bad Request in 659ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 10096)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:30:29 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 9702)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:33:05 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.4ms | Allocations: 7909)


  
NoMethodError (undefined method `error_message' for #<User id: nil, name: "kasinathan", department: 0, status: nil, email: "kasip102@gmail.com", password_digest: nil, created_at: nil, updated_at: nil>):
  
app/controllers/users_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:33:16 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.4ms | Allocations: 7855)


  
NoMethodError (undefined method `errors_message' for #<User id: nil, name: "kasinathan", department: 0, status: nil, email: "kasip102@gmail.com", password_digest: nil, created_at: nil, updated_at: nil>):
  
app/controllers/users_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:33:27 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 400 Bad Request in 9ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 6095)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:34:09 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 8320)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:36:06 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 1.1ms | Allocations: 8833)


  
NoMethodError (undefined method `to_sym' for 0:Integer

        [attribute.to_sym, type, options]
                  ^^^^^^^
Did you mean?  to_s):
  
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:36:20 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 8346)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:37:13 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip102@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip102@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 8285)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:38:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 4977)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:38:58 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 8280)


  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi19@gmail.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi19@gmail.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "axw@gmail.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "axw@gmail.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "aqz@gm.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:46:38 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 12008)


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "aqz@gm.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "aqz@gm.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:52:26 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 400 Bad Request in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 12018)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:53:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 1.1ms | Allocations: 370)
Completed 200 OK in 10ms (Views: 3.7ms | ActiveRecord: 0.7ms | Allocations: 7873)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:54:32 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.6ms | Allocations: 7133)


  
NoMethodError (undefined method `all' for #<ActiveModel::Errors [#<ActiveModel::Error attribute=password, type=blank, options={}>]>

    p @user.errors.all
                  ^^^^
Did you mean?  all?):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:54:48 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.8ms | Allocations: 7102)


  
NoMethodError (undefined method `second' for #<ActiveModel::Errors [#<ActiveModel::Error attribute=password, type=blank, options={}>]>

    p @user.errors.second
                  ^^^^^^^
Did you mean?  send):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:55:05 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 1.1ms | Allocations: 6283)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:57:40 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 399)
Completed 200 OK in 10ms (Views: 2.2ms | ActiveRecord: 0.6ms | Allocations: 11509)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:57:56 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 399)
Completed 200 OK in 10ms (Views: 2.2ms | ActiveRecord: 0.4ms | Allocations: 11518)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:58:22 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :password. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010850e598>, params: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "password"=>"[FILTERED]"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.4ms | Allocations: 178)
Completed 200 OK in 3ms (Views: 1.1ms | ActiveRecord: 0.2ms | Allocations: 3562)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 10:59:40 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip12@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 05:29:41.030084"], ["updated_at", "2022-08-01 05:29:41.030084"]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 200 OK in 256ms (Views: 0.6ms | ActiveRecord: 2.4ms | Allocations: 7877)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:13:31 +0530
Error occurred while parsing request parameters.
Contents:

{
  "user": {
    "email": "kasip12@gmail.com",
    "name":  "kasinathan",
    "department": "Engineering",
  }
}
Processing by UsersController#create as JSON
Completed 400 Bad Request in 0ms (Allocations: 682)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/users_controller.rb:39:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:13:44 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 200 OK in 6ms (Views: 1.2ms | ActiveRecord: 0.9ms | Allocations: 5846)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:16:05 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 1.0ms | Allocations: 6292)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:16:57 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip12@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 05:46:57.480429"], ["updated_at", "2022-08-01 05:46:57.480429"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.3ms | Allocations: 5461)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:17:31 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 0.5ms | Allocations: 4082)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:18:00 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip12@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 05:48:00.493180"], ["updated_at", "2022-08-01 05:48:00.493180"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 5443)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:18:14 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip12@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 05:48:14.107403"], ["updated_at", "2022-08-01 05:48:14.107403"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2247)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:18:25 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.8ms | ActiveRecord: 0.7ms | Allocations: 6329)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:20:54 +0530
  
ArgumentError (You need to supply at least one validation):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:2:in `<main>'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:21:15 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.1ms | Allocations: 6342)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:23:09 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 10ms (Views: 1.0ms | ActiveRecord: 1.2ms | Allocations: 6272)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:23:21 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 399)
Completed 200 OK in 12ms (Views: 3.0ms | ActiveRecord: 0.6ms | Allocations: 11592)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:28:32 +0530
  
ArgumentError (You need to supply at least one validation):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:2:in `<main>'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:31:39 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 3ms (Allocations: 2964)


  
NameError (undefined local variable or method `password' for #<UsersController:0x00000000014780>

    params.require(:user).permit(:name, :email, :department) < ({password => ''})
                                                                 ^^^^^^^^):
  
app/controllers/users_controller.rb:40:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:31:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 1ms (Allocations: 1547)


  
NoMethodError (undefined method `<' for #<ActionController::Parameters {"name"=>"kasinathan", "email"=>"kasip12@gmail.com", "department"=>"Engineering"} permitted: true>

    params.require(:user).permit(:name, :email, :department) < ({'password' => ''})
                                                             ^):
  
app/controllers/users_controller.rb:40:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:32:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 1ms (Allocations: 1511)


  
NoMethodError (undefined method `<' for #<ActionController::Parameters {"name"=>"kasinathan", "email"=>"kasip12@gmail.com", "department"=>"Engineering"} permitted: true>

    params.require(:user).permit(:name, :email, :department) < {'password' => ''}
                                                             ^):
  
app/controllers/users_controller.rb:40:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:32:25 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 1ms (Allocations: 1480)


  
NoMethodError (undefined method `<<' for #<ActionController::Parameters {"name"=>"kasinathan", "email"=>"kasip12@gmail.com", "department"=>"Engineering"} permitted: true>

    params.require(:user).permit(:name, :email, :department) << {'password' => ''}
                                                             ^^):
  
app/controllers/users_controller.rb:40:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:34:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 1ms (Allocations: 1220)


  
NoMethodError (private method `require' called for nil:NilClass

    params = params.require(:user).permit(:name, :email, :department)
                   ^^^^^^^^):
  
app/controllers/users_controller.rb:40:in `onboard_args'
app/controllers/users_controller.rb:5:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:35:34 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.5ms | Allocations: 3347)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, String passed.):
  
app/controllers/users_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:36:02 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 179)
Completed 200 OK in 252ms (Views: 1.0ms | ActiveRecord: 1.4ms | Allocations: 6714)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:41:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 2.6ms | Allocations: 6070)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:41:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 2.0ms | Allocations: 6097)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:43:14 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 258ms (Views: 0.1ms | ActiveRecord: 2.4ms | Allocations: 8638)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:43:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 1.9ms | Allocations: 6539)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 11:45:19 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 262ms (Views: 0.1ms | ActiveRecord: 1.8ms | Allocations: 6478)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:46:20 +0530
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/user/signup"):
  
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:47:02 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 249ms (ActiveRecord: 1.2ms | Allocations: 4183)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:33:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:48:05 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 248ms (ActiveRecord: 0.5ms | Allocations: 4305)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:49:02 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 1.3ms | Allocations: 4169)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:49:51 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.0ms | Allocations: 4173)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:35:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:50:45 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.2ms | Allocations: 4037)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:51:40 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:35:in `set_password'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:35:in `set_password'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:35:in `set_password'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 6825)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:51:58 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:35:in `set_password'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:35:in `set_password'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:35:in `set_password'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 7120)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:52:54 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.0ms | Allocations: 3980)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:53:27 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.1ms | Allocations: 4037)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:53:38 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.1ms | Allocations: 3979)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:34:in `set_password'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:56:25 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `set_password'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:34:in `set_password'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `set_password'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.5ms | Allocations: 176)
Completed 200 OK in 7ms (Views: 1.1ms | ActiveRecord: 1.2ms | Allocations: 7827)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 11:58:28 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:12:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:15:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 7581)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.coms&password=[FILTERED]" for 127.0.0.1 at 2022-08-01 11:58:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.coms", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.coms"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 977)


  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Started POST "/api/v1/expense_tracker/user/login?email=kasip12@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-01 11:59:15 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.1ms | Allocations: 176)
Completed 200 OK in 259ms (Views: 1.6ms | ActiveRecord: 0.1ms | Allocations: 1614)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:22:34 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 9ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 6035)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:23:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 6426)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:23:31 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 6465)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:24:18 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 400 Bad Request in 10ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 11041)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:24:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 6498)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:24:36 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 400 Bad Request in 9ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 11041)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:26:10 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1222@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1222@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip1222@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 06:56:10.408406"], ["updated_at", "2022-08-01 06:56:10.408406"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 1.8ms | Allocations: 388)
Completed 200 OK in 262ms (Views: 3.9ms | ActiveRecord: 2.9ms | Allocations: 10032)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 12:26:27 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:13:in `signup'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 1.7ms | Allocations: 135)
Completed 200 OK in 263ms (Views: 1.9ms | ActiveRecord: 0.4ms | Allocations: 4610)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 12:27:37 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:13:in `signup'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:13:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 200 OK in 253ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 7652)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 12:28:55 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasip12@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:13:in `signup'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:13:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-01 06:58:56.266921"], ["id", 7]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 200 OK in 255ms (Views: 0.8ms | ActiveRecord: 2.1ms | Allocations: 7004)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:44:26 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasip1212@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 07:14:26.368504"], ["updated_at", "2022-08-01 07:14:26.368504"]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 179)
Completed 201 Created in 255ms (Views: 1.6ms | ActiveRecord: 2.4ms | Allocations: 6877)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:53:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 500 Internal Server Error in 253ms (ActiveRecord: 1.4ms | Allocations: 7184)


  
NoMethodError (undefined method `BAD_REQUEST' for CustomError:Module

    raise CustomError::ValidationError.new("unable to onboard user, #{@user.errors.full_messages}", CustomError.BAD_REQUEST) unless @user.save
                                                                                                               ^^^^^^^^^^^^):
  
app/controllers/users_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:54:25 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 400 Bad Request in 256ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 6559)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 12:54:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 403 Forbidden in 254ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 6517)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 13:12:45 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
unable to onboard kasip1212@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 254ms (Views: 0.1ms | ActiveRecord: 1.7ms | Allocations: 6413)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 13:20:01 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
unable to onboard kasip1212@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 255ms (Views: 0.1ms | ActiveRecord: 1.8ms | Allocations: 6430)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 13:20:14 +0530
  
LoadError (cannot load such file -- loggerr
Did you mean?  logger):
  
app/controllers/users_controller.rb:2:in `<class:UsersController>'
app/controllers/users_controller.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 13:20:20 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
unable to onboard kasip1212@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 6947)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 13:20:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip1212@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip1212@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Completed 500 Internal Server Error in 256ms (ActiveRecord: 1.5ms | Allocations: 8377)


  
NameError (undefined local variable or method `loggerr' for #<UsersController:0x00000000040920>

      loggerr.error("unable to onboard #{@user.email}, exception #{@user.errors.full_messages}")
      ^^^^^^^
Did you mean?  logger
               logger=):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 14:28:42 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", 0], ["status", nil], ["email", "kasi1@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 08:58:42.435418"], ["updated_at", "2022-08-01 08:58:42.435418"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 178)
Completed 201 Created in 254ms (Views: 2.0ms | ActiveRecord: 2.0ms | Allocations: 6919)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" varchar, "status" integer, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "users_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_63a9f7241c"
FOREIGN KEY ("users_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_users_id" ON "user_roles" ("users_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:05:30 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
Completed 500 Internal Server Error in 252ms (ActiveRecord: 0.2ms | Allocations: 10508)


  
NoMethodError (undefined method `create' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi1@gmail.com", password_digest: [FILTERED], created_at: nil, updated_at: nil>
Did you mean?  created_at):
  
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:06:37 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 252ms (ActiveRecord: 0.4ms | Allocations: 8388)


  
NoMethodError (undefined method `create' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi1@gmail.com", password_digest: [FILTERED], created_at: nil, updated_at: nil>
Did you mean?  created_at):
  
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:06:48 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 255ms (ActiveRecord: 0.4ms | Allocations: 8363)


  
NoMethodError (undefined method `create' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi1@gmail.com", password_digest: [FILTERED], created_at: nil, updated_at: nil>
Did you mean?  created_at):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:08:19 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 259ms (ActiveRecord: 0.6ms | Allocations: 10182)


  
NameError (uninitialized constant User::Model

    @user.status = Model.status[:active]
                   ^^^^^
Did you mean?  Module):
  
app/models/user.rb:17:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:08:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 249ms (ActiveRecord: 0.6ms | Allocations: 6834)


  
NoMethodError (undefined method `[]' for nil:NilClass

    @user.status = status[:active]
                         ^^^^^^^^^):
  
app/models/user.rb:17:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:09:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 252ms (ActiveRecord: 0.7ms | Allocations: 6829)


  
NoMethodError (undefined method `[]' for nil:NilClass

    @user.status = status[:active]
                         ^^^^^^^^^):
  
app/models/user.rb:18:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:09:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 253ms (ActiveRecord: 0.7ms | Allocations: 6856)


  
NoMethodError (undefined method `[]' for nil:NilClass

    @user.status = status[:active]
                         ^^^^^^^^^):
  
app/models/user.rb:19:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:09:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 257ms (ActiveRecord: 0.6ms | Allocations: 9723)


  
NoMethodError (undefined method `status' for User:Class
Did you mean?  statuses):
  
app/models/user.rb:18:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:10:23 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 251ms (ActiveRecord: 0.5ms | Allocations: 6819)


  
NoMethodError (undefined method `[]' for nil:NilClass

    p status[:active]
            ^^^^^^^^^):
  
app/models/user.rb:18:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:54:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 253ms (ActiveRecord: 0.4ms | Allocations: 6356)


  
NoMethodError (undefined method `status=' for nil:NilClass

    @user.status = 'active'
         ^^^^^^^^^):
  
app/models/user.rb:19:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:55:46 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 257ms (ActiveRecord: 0.6ms | Allocations: 12002)


  
NameError (undefined local variable or method `user' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi1@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 10:25:46.797080000 +0000", updated_at: "2022-08-01 10:25:46.797080000 +0000">
Did you mean?  super):
  
app/models/user.rb:19:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:56:39 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 255ms (ActiveRecord: 0.6ms | Allocations: 11902)


  
NameError (undefined local variable or method `slef' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi1@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 10:26:40.082889000 +0000", updated_at: "2022-08-01 10:26:40.082889000 +0000">
Did you mean?  self):
  
app/models/user.rb:19:in `set_active_status'
app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:57:05 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi1@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:27:06.283561"], ["updated_at", "2022-08-01 10:27:06.283561"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 232)
Completed 201 Created in 257ms (Views: 1.7ms | ActiveRecord: 4.6ms | Allocations: 8640)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:57:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user kasi1@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 7822)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:57:38 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi2@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:27:39.096806"], ["updated_at", "2022-08-01 10:27:39.096806"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 255ms (Views: 0.7ms | ActiveRecord: 0.9ms | Allocations: 3859)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:58:26 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi3@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi3@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:28:26.365693"], ["updated_at", "2022-08-01 10:28:26.365693"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 253ms (Views: 0.8ms | ActiveRecord: 1.6ms | Allocations: 7172)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:58:49 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi4@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi4@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:28:49.965804"], ["updated_at", "2022-08-01 10:28:49.965804"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 253ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 7168)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 15:59:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi4@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user kasi4@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 6957)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:00:13 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi5@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi5@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi5@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:30:14.034838"], ["updated_at", "2022-08-01 10:30:14.034838"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 260ms (Views: 0.7ms | ActiveRecord: 0.9ms | Allocations: 3851)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:00:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi6@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi6@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi6@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:31:00.276033"], ["updated_at", "2022-08-01 10:31:00.276033"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 250ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 7113)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:01:21 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi6@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi6@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user kasi6@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 250ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 6936)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:01:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi7@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi7@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi7@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:31:30.667779"], ["updated_at", "2022-08-01 10:31:30.667779"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 250ms (Views: 0.7ms | ActiveRecord: 1.2ms | Allocations: 3813)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:02:21 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi8@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi8@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi8@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:32:21.818943"], ["updated_at", "2022-08-01 10:32:21.818943"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 254ms (Views: 1.0ms | ActiveRecord: 2.5ms | Allocations: 7676)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:02:40 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi9@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi9@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasi9@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:32:40.840759"], ["updated_at", "2022-08-01 10:32:40.840759"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 254ms (Views: 0.7ms | ActiveRecord: 1.6ms | Allocations: 7338)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:12:20 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasii1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasii1@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:42:21.171069"], ["updated_at", "2022-08-01 10:42:21.171069"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 253ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 6650)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:19:40 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
[31mUnpermitted parameter: :status. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010811dda8>, params: {"user"=>{"email"=>"kasii1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasii1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user kasii1@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 6557)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:19:46 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
[31mUnpermitted parameter: :status. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001082f6210>, params: {"user"=>{"email"=>"kasii2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasii2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasii2@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:49:46.628661"], ["updated_at", "2022-08-01 10:49:46.628661"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 256ms (Views: 0.7ms | ActiveRecord: 1.2ms | Allocations: 3869)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:21:22 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
[31mUnpermitted parameter: :status. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113a3dd60>, params: {"user"=>{"email"=>"kasii3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasii3@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasii3@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:52:00.293221"], ["updated_at", "2022-08-01 10:52:00.293221"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 1.1ms | Allocations: 388)
Completed 201 Created in 47025ms (Views: 31.7ms | ActiveRecord: 2.2ms | Allocations: 39709)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:22:37 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasii4@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", nil], ["email", "kasii4@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 10:52:43.383391"], ["updated_at", "2022-08-01 10:52:43.383391"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:23:52 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii5@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:29:38 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasii9@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.9ms | Allocations: 389)
Completed 201 Created in 33448ms (Views: 37.4ms | ActiveRecord: 1.0ms | Allocations: 42383)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:30:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 2.0ms | Allocations: 178)
Completed 201 Created in 26504ms (Views: 6.1ms | ActiveRecord: 0.0ms | Allocations: 20334)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:32:08 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 389)
Completed 201 Created in 256ms (Views: 4.4ms | ActiveRecord: 0.3ms | Allocations: 7813)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:32:50 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:02:50.463099"], ["updated_at", "2022-08-01 11:02:50.463099"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.4ms | Allocations: 178)
Completed 201 Created in 254ms (Views: 1.3ms | ActiveRecord: 1.2ms | Allocations: 9697)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:36:22 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "status"=>"active"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 9], ["email", "kasi1@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:06:25.485363"], ["updated_at", "2022-08-01 11:06:25.485363"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 1.2ms | Allocations: 388)
Completed 201 Created in 38193ms (Views: 19.4ms | ActiveRecord: 3.1ms | Allocations: 31612)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 16:39:00 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi2@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:09:00.440193"], ["updated_at", "2022-08-01 11:09:00.440193"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.6ms | Allocations: 388)
Completed 201 Created in 255ms (Views: 3.8ms | ActiveRecord: 1.0ms | Allocations: 13296)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:05:28 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001173ef798>, params: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi3@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi3@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:35:29.159989"], ["updated_at", "2022-08-01 11:35:29.159989"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001173ef798>, params: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 266ms (ActiveRecord: 1.4ms | Allocations: 14823)


  
ActiveModel::UnknownAttributeError (unknown attribute 'user_id' for UserRole.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:06:23 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000118956078>, params: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi3@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000118956078>, params: {"user"=>{"email"=>"kasi3@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 51720ms (ActiveRecord: 1.6ms | Allocations: 35364)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:09:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010df5c4a0>, params: {"user"=>{"email"=>"kasi4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi4@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi4@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:39:33.451081"], ["updated_at", "2022-08-01 11:39:33.451081"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010df5c4a0>, params: {"user"=>{"email"=>"kasi4@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 8600ms (ActiveRecord: 3.4ms | Allocations: 34288)


  
ActiveModel::UnknownAttributeError (unknown attribute 'user_id' for UserRole.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:10:22 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi5@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000107591ef8>, params: {"user"=>{"email"=>"kasi5@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi5@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi5@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 11:40:22.635762"], ["updated_at", "2022-08-01 11:40:22.635762"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000107591ef8>, params: {"user"=>{"email"=>"kasi5@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 259ms (ActiveRecord: 1.5ms | Allocations: 17017)


  
ActiveModel::UnknownAttributeError (unknown attribute 'user_id' for UserRole.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:17:13 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010b97de00>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010b97de00>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:20:18 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010990cf90>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010990cf90>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010990cf90>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 258ms (ActiveRecord: 0.6ms | Allocations: 16187)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:11:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:21:46 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010acfd2e8>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010acfd2e8>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>0}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
unable to onboard  user kasi0@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 260ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 12011)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:22:22 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010bb6fa10>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010bb6fa10>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:9:in `create'
unable to onboard  user kasi0@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 258ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3947)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:22:55 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c065808>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c065808>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c065808>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
unable to onboard  user kasi0@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 11079)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:26:05 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000109f98d78>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000109f98d78>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 276ms (ActiveRecord: 0.3ms | Allocations: 6233)


  
Errno::EPIPE (Broken pipe @ io_writev - <STDOUT>):
  
app/controllers/users_controller.rb:8:in `p'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:32:17 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0ec8d0>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0ec8d0>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0ec8d0>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `create'
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:11:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `create'
unable to onboard  user kasi0@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 72193ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 66190)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:33:56 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000105d19218>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000105d19218>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000105d19218>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi0@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:11:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `create'
unable to onboard  user kasi0@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 262ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 18096)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:36:33 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001061147a0>, params: {"user"=>{"email"=>"kasi0@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 358)
Completed 201 Created in 260ms (Views: 4.2ms | ActiveRecord: 0.6ms | Allocations: 8395)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:37:08 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010641cdd0>, params: {"user"=>{"email"=>"kasi01@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 201 Created in 253ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 5833)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:37:19 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi011@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010529fa80>, params: {"user"=>{"email"=>"kasi011@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 256ms (ActiveRecord: 0.4ms | Allocations: 8152)


  
NoMethodError (undefined method `user_role' for #<User id: nil, name: "kasinathan", department: "Engineering", status: nil, email: "kasi011@gmail.com", password_digest: [FILTERED], created_at: nil, updated_at: nil>
Did you mean?  user_roles
               user_roles=):
  
app/controllers/users_controller.rb:9:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:39:43 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi0111@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000109971648>, params: {"user"=>{"email"=>"kasi0111@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 389)
Completed 201 Created in 262ms (Views: 5.3ms | ActiveRecord: 0.6ms | Allocations: 12441)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:40:35 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010ae3e9b8>, params: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.4ms | Allocations: 178)
Completed 201 Created in 253ms (Views: 1.2ms | ActiveRecord: 0.6ms | Allocations: 7668)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:42:40 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010b13f428>, params: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi01w11@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:16:in `create'
unable to onboard  user kasi01w11@gmail.com, exception ["User roles is invalid"]
Completed 400 Bad Request in 265ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 13169)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:51:21 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010a6c0178>, params: {"user"=>{"email"=>"kasi01w11@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi01w11@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi01w11@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:21:21.710705"], ["updated_at", "2022-08-01 12:21:21.710705"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 201 Created in 254ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 7541)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:54:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01w121@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010af27be0>, params: {"user"=>{"email"=>"kasi01w121@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi01w121@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi01w121@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:24:07.439606"], ["updated_at", "2022-08-01 12:24:07.439606"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
Completed 500 Internal Server Error in 258ms (ActiveRecord: 2.9ms | Allocations: 11113)


  
ActiveModel::MissingAttributeError (can't write unknown attribute `user_id`

          raise ActiveModel::MissingAttributeError, "can't write unknown attribute `#{name}`"
          ^^^^^):
  
app/controllers/users_controller.rb:11:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "user_roles"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20220729114313)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "department" varchar, "status" integer, "email" varchar, "password_digest" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729114313"]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateUserRoles (20220729115446)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "user_roles" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "role" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_318345354e"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_user_roles_on_user_id" ON "user_roles" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220729115446"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 17:58:15 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi01w121@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113265598>, params: {"user"=>{"email"=>"kasi01w121@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi01w121@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi01w121@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:28:15.424630"], ["updated_at", "2022-08-01 12:28:15.424630"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:12:in `create'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 1], ["created_at", "2022-08-01 12:28:15.436282"], ["updated_at", "2022-08-01 12:28:15.436282"]]
  ↳ app/controllers/users_controller.rb:12:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:12:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.9ms | Allocations: 387)
Completed 201 Created in 270ms (Views: 4.8ms | ActiveRecord: 2.4ms | Allocations: 21537)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:01:23 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001149179d0>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:31:23.625573"], ["updated_at", "2022-08-01 12:31:23.625573"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
Completed 500 Internal Server Error in 256ms (ActiveRecord: 1.3ms | Allocations: 11289)


  
NoMethodError (undefined method `roles' for #<User id: 2, name: "kasinathan", department: "Engineering", status: "active", email: "k@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 12:31:23.625573000 +0000", updated_at: "2022-08-01 12:31:23.625573000 +0000">):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:01:40 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114e153b0>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114e153b0>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 252ms (ActiveRecord: 0.7ms | Allocations: 7669)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:02:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b478e0>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b478e0>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 254ms (ActiveRecord: 0.2ms | Allocations: 3220)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:02:43 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114e5f140>, params: {"user"=>{"email"=>"k@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard  user k@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 7984)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:02:54 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113027830>, params: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:32:54.905863"], ["updated_at", "2022-08-01 12:32:54.905863"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113027830>, params: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>1}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 3], ["created_at", "2022-08-01 12:32:54.912305"], ["updated_at", "2022-08-01 12:32:54.912305"]]
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 178)
Completed 201 Created in 262ms (Views: 1.6ms | ActiveRecord: 2.8ms | Allocations: 13246)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:03:31 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113f3f548>, params: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113f3f548>, params: {"user"=>{"email"=>"k1@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 250ms (ActiveRecord: 0.3ms | Allocations: 3248)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:03:41 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114846088>, params: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k12@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:33:41.873126"], ["updated_at", "2022-08-01 12:33:41.873126"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114846088>, params: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"basic"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 4], ["created_at", "2022-08-01 12:33:41.875615"], ["updated_at", "2022-08-01 12:33:41.875615"]]
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 201 Created in 255ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 5684)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:04:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b64878>, params: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k12@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b64878>, params: {"user"=>{"email"=>"k12@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 253ms (ActiveRecord: 0.6ms | Allocations: 7975)


  
ActiveRecord::RecordNotSaved (You cannot call create unless the parent is saved):
  
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:04:22 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k132@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000110598c18>, params: {"user"=>{"email"=>"k132@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k132@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k132@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:34:22.387621"], ["updated_at", "2022-08-01 12:34:22.387621"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000110598c18>, params: {"user"=>{"email"=>"k132@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 5], ["created_at", "2022-08-01 12:34:22.391528"], ["updated_at", "2022-08-01 12:34:22.391528"]]
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 81)
Completed 201 Created in 258ms (Views: 0.9ms | ActiveRecord: 2.2ms | Allocations: 8398)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:04:43 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k132@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113fd7668>, params: {"user"=>{"email"=>"k132@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k132@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k132@2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:34:43.369366"], ["updated_at", "2022-08-01 12:34:43.369366"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113fd7668>, params: {"user"=>{"email"=>"k132@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 6], ["created_at", "2022-08-01 12:34:43.375844"], ["updated_at", "2022-08-01 12:34:43.375844"]]
  ↳ app/controllers/users_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:10:in `create'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 201 Created in 259ms (Views: 1.0ms | ActiveRecord: 2.7ms | Allocations: 13207)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:17:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1q32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000115097c50>, params: {"user"=>{"email"=>"k1q32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1q32@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1q32@2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:47:52.766884"], ["updated_at", "2022-08-01 12:47:52.766884"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000115097c50>, params: {"user"=>{"email"=>"k1q32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 7], ["created_at", "2022-08-01 12:47:52.773916"], ["updated_at", "2022-08-01 12:47:52.773916"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.6ms | Allocations: 239)
Completed 201 Created in 264ms (Views: 1.5ms | ActiveRecord: 3.0ms | Allocations: 12738)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:19:04 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001132c4890>, params: {"user"=>{"email"=>"k1qw32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw32@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qw32@2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:49:05.100166"], ["updated_at", "2022-08-01 12:49:05.100166"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001132c4890>, params: {"user"=>{"email"=>"k1qw32@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 8], ["created_at", "2022-08-01 12:49:05.102831"], ["updated_at", "2022-08-01 12:49:05.102831"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 8]]
  ↳ app/views/users/create.jbuilder:5
  Rendered users/create.jbuilder (Duration: 1.9ms | Allocations: 2176)
Completed 201 Created in 258ms (Views: 2.6ms | ActiveRecord: 2.0ms | Allocations: 8452)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:24:08 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw3sdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113f6ed98>, params: {"user"=>{"email"=>"k1qw3sdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw3sdad2@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qw3sdad2@2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:54:08.403608"], ["updated_at", "2022-08-01 12:54:08.403608"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113f6ed98>, params: {"user"=>{"email"=>"k1qw3sdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 9], ["created_at", "2022-08-01 12:54:08.406656"], ["updated_at", "2022-08-01 12:54:08.406656"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.5ms | Allocations: 1096)
Completed 500 Internal Server Error in 256ms (ActiveRecord: 2.3ms | Allocations: 7235)


  
ActionView::Template::Error (wrong number of arguments (given 2, expected 0)):
    1: json.user do
    2:   json.call(@user, :created_at, :updated_at)
    3:   json.roles(@user.user_roles(:role, :created_at))
    4: end
  
app/views/users/create.jbuilder:3
app/views/users/create.jbuilder:1
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:25:31 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw3sdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113fbe7a8>, params: {"user"=>{"email"=>"k1qw3sdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw3sdad2@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user k1qw3sdad2@2gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3914)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:25:36 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw3ssdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011480fba0>, params: {"user"=>{"email"=>"k1qw3ssdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw3ssdad2@2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qw3ssdad2@2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:55:36.729090"], ["updated_at", "2022-08-01 12:55:36.729090"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011480fba0>, params: {"user"=>{"email"=>"k1qw3ssdad2@2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 10], ["created_at", "2022-08-01 12:55:36.731800"], ["updated_at", "2022-08-01 12:55:36.731800"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.6ms | Allocations: 1079)
Completed 500 Internal Server Error in 254ms (ActiveRecord: 1.9ms | Allocations: 7168)


  
ActionView::Template::Error (wrong number of arguments (given 2, expected 0)):
    1: json.user do
    2:   json.(@user, :created_at, :name, :email)
    3:   json.roles(@user.user_roles(:role, :created_at))
    4: end
  
app/views/users/create.jbuilder:3
app/views/users/create.jbuilder:1
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:26:09 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw3ssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011343fd00>, params: {"user"=>{"email"=>"k1qw3ssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw3ssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qw3ssdad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:56:09.648164"], ["updated_at", "2022-08-01 12:56:09.648164"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011343fd00>, params: {"user"=>{"email"=>"k1qw3ssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 11], ["created_at", "2022-08-01 12:56:09.650137"], ["updated_at", "2022-08-01 12:56:09.650137"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.4ms | Allocations: 1012)
Completed 500 Internal Server Error in 255ms (ActiveRecord: 1.7ms | Allocations: 7268)


  
ActionView::Template::Error (wrong number of arguments (given 2, expected 0)):
    1: 
    2:   json.(@user, :created_at, :name, :email)
    3:   json.roles(@user.user_roles(:role, :created_at))
  
app/views/users/create.jbuilder:3
app/controllers/users_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:27:21 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qw3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001148be290>, params: {"user"=>{"email"=>"k1qw3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qw3dssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qw3dssdad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:57:21.547615"], ["updated_at", "2022-08-01 12:57:21.547615"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001148be290>, params: {"user"=>{"email"=>"k1qw3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 12], ["created_at", "2022-08-01 12:57:21.550384"], ["updated_at", "2022-08-01 12:57:21.550384"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.3ms | Allocations: 211)
Completed 201 Created in 255ms (Views: 1.2ms | ActiveRecord: 2.0ms | Allocations: 6497)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:27:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114a06d50>, params: {"user"=>{"email"=>"k1qww3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3dssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qww3dssdad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:57:51.756793"], ["updated_at", "2022-08-01 12:57:51.756793"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114a06d50>, params: {"user"=>{"email"=>"k1qww3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 13], ["created_at", "2022-08-01 12:57:51.759455"], ["updated_at", "2022-08-01 12:57:51.759455"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  Rendered users/create.jbuilder (Duration: 0.3ms | Allocations: 241)
Completed 201 Created in 256ms (Views: 1.3ms | ActiveRecord: 2.0ms | Allocations: 6531)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:28:23 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b54b58>, params: {"user"=>{"email"=>"k1qww3dssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3dssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user k1qww3dssdad2@w2gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3872)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:28:26 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3edssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b9f8d8>, params: {"user"=>{"email"=>"k1qww3edssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3edssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qww3edssdad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:58:26.545435"], ["updated_at", "2022-08-01 12:58:26.545435"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b9f8d8>, params: {"user"=>{"email"=>"k1qww3edssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 14], ["created_at", "2022-08-01 12:58:26.548199"], ["updated_at", "2022-08-01 12:58:26.548199"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 14]]
  ↳ app/views/users/create.jbuilder:5
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 1155)
Completed 201 Created in 262ms (Views: 2.3ms | ActiveRecord: 2.2ms | Allocations: 7258)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:28:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3edssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114e651d0>, params: {"user"=>{"email"=>"k1qww3edssdad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3edssdad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user k1qww3edssdad2@w2gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3821)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:28:54 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3edssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000115066790>, params: {"user"=>{"email"=>"k1qww3edssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3edssddad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qww3edssddad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:58:54.333950"], ["updated_at", "2022-08-01 12:58:54.333950"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000115066790>, params: {"user"=>{"email"=>"k1qww3edssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 15], ["created_at", "2022-08-01 12:58:54.337160"], ["updated_at", "2022-08-01 12:58:54.337160"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 15]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.2ms | Allocations: 1122)
Completed 201 Created in 257ms (Views: 1.9ms | ActiveRecord: 2.7ms | Allocations: 7178)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:29:05 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3edssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011533dfb8>, params: {"user"=>{"email"=>"k1qww3edssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3edssddad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user k1qww3edssddad2@w2gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 254ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3823)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:29:08 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"k1qww3eddssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}}
[31mUnpermitted parameter: :role. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000100f1ec98>, params: {"user"=>{"email"=>"k1qww3eddssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "k1qww3eddssddad2@w2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "k1qww3eddssddad2@w2gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 12:59:08.566585"], ["updated_at", "2022-08-01 12:59:08.566585"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000100f1ec98>, params: {"user"=>{"email"=>"k1qww3eddssddad2@w2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "role"=>"admin"}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mUserRole Create (0.5ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 2], ["user_id", 16], ["created_at", "2022-08-01 12:59:08.570744"], ["updated_at", "2022-08-01 12:59:08.570744"]]
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 16]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.7ms | Allocations: 1141)
Completed 201 Created in 258ms (Views: 3.2ms | ActiveRecord: 3.1ms | Allocations: 7231)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:41:54 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"q2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114836ca0>, params: {"user"=>{"email"=>"q2gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "q2gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user q2gmail.com, exception ["Email Invalid email"]
Completed 400 Bad Request in 251ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 6403)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:42:02 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"q2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114affb58>, params: {"user"=>{"email"=>"q2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "q2@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "q2@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:12:02.289145"], ["updated_at", "2022-08-01 13:12:02.289145"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114affb58>, params: {"user"=>{"email"=>"q2@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 17]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 4.4ms | Allocations: 3889)
Completed 201 Created in 259ms (Views: 5.1ms | ActiveRecord: 1.8ms | Allocations: 8021)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:43:06 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"q2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000115324ba8>, params: {"user"=>{"email"=>"q2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "q2w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "q2w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:13:06.499263"], ["updated_at", "2022-08-01 13:13:06.499263"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 257ms (ActiveRecord: 1.5ms | Allocations: 10925)


  
NameError (undefined local variable or method `roles' for #<UsersController:0x00000000034e18>

      @user.user_roles.create(roles)
                              ^^^^^
Did you mean?  role_args):
  
app/controllers/users_controller.rb:47:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:43:23 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"q2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011505fa58>, params: {"user"=>{"email"=>"q2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "q2w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user q2w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 254ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 7091)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:43:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qs2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001115db8a0>, params: {"user"=>{"email"=>"qs2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qs2w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qs2w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:13:29.368673"], ["updated_at", "2022-08-01 13:13:29.368673"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001115db8a0>, params: {"user"=>{"email"=>"qs2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>[0, 1]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", nil], ["user_id", 19], ["created_at", "2022-08-01 13:13:29.375023"], ["updated_at", "2022-08-01 13:13:29.375023"]]
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 19]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.3ms | Allocations: 1933)
Completed 201 Created in 262ms (Views: 1.9ms | ActiveRecord: 2.3ms | Allocations: 12246)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:43:48 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qs2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113f77678>, params: {"user"=>{"email"=>"qs2w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qs2w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qs2w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3788)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:43:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qs2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001148bca30>, params: {"user"=>{"email"=>"qs2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qs2sw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qs2sw@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:13:52.601019"], ["updated_at", "2022-08-01 13:13:52.601019"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001148bca30>, params: {"user"=>{"email"=>"qs2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", nil], ["user_id", 20], ["created_at", "2022-08-01 13:13:52.604007"], ["updated_at", "2022-08-01 13:13:52.604007"]]
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 20]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 849)
Completed 201 Created in 255ms (Views: 0.9ms | ActiveRecord: 1.5ms | Allocations: 6460)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:44:38 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001150bc7f8>, params: {"user"=>{"email"=>"qss2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2sw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qss2sw@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:14:39.038565"], ["updated_at", "2022-08-01 13:14:39.038565"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001150bc7f8>, params: {"user"=>{"email"=>"qss2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 21]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.6ms | Allocations: 3920)
Completed 201 Created in 257ms (Views: 3.9ms | ActiveRecord: 1.5ms | Allocations: 11217)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:44:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114937460>, params: {"user"=>{"email"=>"qss2sw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2sw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qss2sw@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 254ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 7033)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:45:03 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2ssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114bdc0d0>, params: {"user"=>{"email"=>"qss2ssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2ssw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qss2ssw@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:15:03.350506"], ["updated_at", "2022-08-01 13:15:03.350506"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114bdc0d0>, params: {"user"=>{"email"=>"qss2ssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 22]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 4.2ms | Allocations: 3965)
Completed 201 Created in 260ms (Views: 4.5ms | ActiveRecord: 1.6ms | Allocations: 7896)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:45:47 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000104ed9cc0>, params: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2wssw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qss2wssw@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:15:47.586754"], ["updated_at", "2022-08-01 13:15:47.586754"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000104ed9cc0>, params: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000104ed9cc0>, params: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 23]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.0ms | Allocations: 3921)
Completed 201 Created in 258ms (Views: 3.3ms | ActiveRecord: 2.5ms | Allocations: 11363)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:46:10 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114b875f8>, params: {"user"=>{"email"=>"qss2wssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2wssw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qss2wssw@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 7033)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:46:14 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qss2swssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001150f5ad0>, params: {"user"=>{"email"=>"qss2swssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qss2swssw@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qss2swssw@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:16:14.663303"], ["updated_at", "2022-08-01 13:16:14.663303"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001150f5ad0>, params: {"user"=>{"email"=>"qss2swssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001150f5ad0>, params: {"user"=>{"email"=>"qss2swssw@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 24]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.8ms | Allocations: 3965)
Completed 201 Created in 256ms (Views: 4.0ms | ActiveRecord: 2.1ms | Allocations: 8006)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:47:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001153d7348>, params: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qa1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qa1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:17:30.563098"], ["updated_at", "2022-08-01 13:17:30.563098"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001153d7348>, params: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001153d7348>, params: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 25]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 828)
Completed 201 Created in 253ms (Views: 0.9ms | ActiveRecord: 1.8ms | Allocations: 4626)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 18:48:45 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011699e398>, params: {"user"=>{"email"=>"qa1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qa1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qa1w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 249ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 7032)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:00:32 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000116ccec48>, params: {"user"=>{"email"=>"qaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qaw1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qaw1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:30:32.720193"], ["updated_at", "2022-08-01 13:30:32.720193"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000116ccec48>, params: {"user"=>{"email"=>"qaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000116ccec48>, params: {"user"=>{"email"=>"qaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 26]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.6ms | Allocations: 3915)
Completed 201 Created in 254ms (Views: 4.0ms | ActiveRecord: 1.9ms | Allocations: 10813)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:01:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011702f2c0>, params: {"user"=>{"email"=>"qwaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwaw1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwaw1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:31:54.069433"], ["updated_at", "2022-08-01 13:31:54.069433"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 27]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.6ms | Allocations: 3919)
Completed 201 Created in 256ms (Views: 3.9ms | ActiveRecord: 1.8ms | Allocations: 11067)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:02:21 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c81d050>, params: {"user"=>{"email"=>"qwaw1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwaw1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qwaw1w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 254ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 11638)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:02:26 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwaww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e276730>, params: {"user"=>{"email"=>"qwaww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwaww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwaww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:32:26.356498"], ["updated_at", "2022-08-01 13:32:26.356498"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 28]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 7.7ms | Allocations: 5782)
Completed 201 Created in 264ms (Views: 10.8ms | ActiveRecord: 1.2ms | Allocations: 12051)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:02:41 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwaww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e7b6ab0>, params: {"user"=>{"email"=>"qwwaww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwaww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwaww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:32:42.165617"], ["updated_at", "2022-08-01 13:32:42.165617"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 29]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.0ms | Allocations: 3918)
Completed 201 Created in 256ms (Views: 3.3ms | ActiveRecord: 1.8ms | Allocations: 11086)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:03:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010ea84a30>, params: {"user"=>{"email"=>"qwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwww1aww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwww1aww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:33:08.311325"], ["updated_at", "2022-08-01 13:33:08.311325"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
Completed 500 Internal Server Error in 264ms (ActiveRecord: 2.0ms | Allocations: 10323)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, String passed.):
  
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 19:04:33 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e45f2b8>, params: {"user"=>{"email"=>"qwwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwww1aww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwww1aww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 13:34:34.221256"], ["updated_at", "2022-08-01 13:34:34.221256"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department, :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e45f2b8>, params: {"user"=>{"email"=>"qwwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 31]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.5ms | Allocations: 3924)
Completed 201 Created in 255ms (Views: 3.9ms | ActiveRecord: 1.9ms | Allocations: 11259)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:06:54 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010ea372f8>, params: {"user"=>{"email"=>"qwwww1aww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwww1aww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qwwww1aww1w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 260ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 6574)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:06:58 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwww1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010b2391a8>, params: {"user"=>{"email"=>"qwwww1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwww1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwww1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:36:58.401396"], ["updated_at", "2022-08-01 14:36:58.401396"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010b2391a8>, params: {"user"=>{"email"=>"qwwww1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 32]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 3.4ms | Allocations: 3748)
Completed 201 Created in 257ms (Views: 4.1ms | ActiveRecord: 1.8ms | Allocations: 7748)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:07:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwsw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e08f098>, params: {"user"=>{"email"=>"qwwwsw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwsw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwwsw1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:37:30.771281"], ["updated_at", "2022-08-01 14:37:30.771281"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e08f098>, params: {"user"=>{"email"=>"qwwwsw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e08f098>, params: {"user"=>{"email"=>"qwwwsw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 255ms (ActiveRecord: 1.5ms | Allocations: 10512)


  
ActiveModel::UnknownAttributeError (unknown attribute 'roles' for UserRole.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:09:18 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0e3c80>, params: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwssw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwwssw1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:39:18.331392"], ["updated_at", "2022-08-01 14:39:18.331392"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0e3c80>, params: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c0e3c80>, params: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 257ms (ActiveRecord: 1.9ms | Allocations: 10118)


  
ArgumentError ('["roles", ["admin", "basic"]]' is not a valid role):
  
app/controllers/users_controller.rb:49:in `block in onboard_user'
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:09:49 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e45e9f8>, params: {"user"=>{"email"=>"qwwwssw1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwssw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qwwwssw1asww1w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 7093)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:09:52 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwssws1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e8a4238>, params: {"user"=>{"email"=>"qwwwssws1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwssws1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "qwwwssws1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:39:52.846900"], ["updated_at", "2022-08-01 14:39:52.846900"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e8a4238>, params: {"user"=>{"email"=>"qwwwssws1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e8a4238>, params: {"user"=>{"email"=>"qwwwssws1asww1w@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 257ms (ActiveRecord: 2.2ms | Allocations: 6840)


  
ArgumentError ('["roles", ["admin", "basic"]]' is not a valid role):
  
app/controllers/users_controller.rb:50:in `block in onboard_user'
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:11:28 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108269a90>, params: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwsswsw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinatwhan"], ["department", "Engineering"], ["status", 1], ["email", "qwwwsswsw1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:41:28.352249"], ["updated_at", "2022-08-01 14:41:28.352249"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108269a90>, params: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108269a90>, params: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 261ms (ActiveRecord: 1.5ms | Allocations: 16100)


  
ArgumentError ('["roles", ["admin", "basic"]]' is not a valid role):
  
app/controllers/users_controller.rb:51:in `block in onboard_user'
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:13:31 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108abea88>, params: {"user"=>{"email"=>"qwwwsswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwsswsw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard  user qwwwsswsw1asww1w@gmail.com, exception ["Email has already been taken"]
Completed 400 Bad Request in 255ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 8127)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:13:37 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwwwssswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108c4f8e8>, params: {"user"=>{"email"=>"qwwwssswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwwwssswsw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinatwhan"], ["department", "Engineering"], ["status", 1], ["email", "qwwwssswsw1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:43:38.028478"], ["updated_at", "2022-08-01 14:43:38.028478"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
[31mUnpermitted parameters: :email, :name, :department. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108c4f8e8>, params: {"user"=>{"email"=>"qwwwssswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 253ms (ActiveRecord: 1.5ms | Allocations: 3575)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/users_controller.rb:48:in `onboard_user'
app/controllers/users_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 20:13:57 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"qwswwssswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000108b3cb68>, params: {"user"=>{"email"=>"qwswwssswsw1asww1w@gmail.com", "name"=>"kasinatwhan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "qwswwssswsw1asww1w@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinatwhan"], ["department", "Engineering"], ["status", 1], ["email", "qwswwssswsw1asww1w@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 14:43:57.426622"], ["updated_at", "2022-08-01 14:43:57.426622"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 38], ["created_at", "2022-08-01 14:43:57.435974"], ["updated_at", "2022-08-01 14:43:57.435974"]]
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 38], ["created_at", "2022-08-01 14:43:57.438287"], ["updated_at", "2022-08-01 14:43:57.438287"]]
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:51:in `block in onboard_user'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 38]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 2.3ms | Allocations: 2333)
Completed 201 Created in 268ms (Views: 3.0ms | ActiveRecord: 3.3ms | Allocations: 18572)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "Description" varchar, "Amount" integer, "Date" date, "Invoice_Number" integer, "status" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 22:04:57 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001064595a0>, params: {"user"=>{"email"=>"kasi@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["admin", "basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasi@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 16:34:58.014011"], ["updated_at", "2022-08-01 16:34:58.014011"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 39], ["created_at", "2022-08-01 16:34:58.023746"], ["updated_at", "2022-08-01 16:34:58.023746"]]
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 39], ["created_at", "2022-08-01 16:34:58.025826"], ["updated_at", "2022-08-01 16:34:58.025826"]]
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:46:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 2.1ms | Allocations: 2527)
Completed 201 Created in 270ms (Views: 4.9ms | ActiveRecord: 2.7ms | Allocations: 25437)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 22:07:30 +0530
Error occurred while parsing request parameters.
Contents:

{
  "user": {
    "email": "kasi@gmail.com",
    "password": "123"
}
Processing by UsersController#signup as JSON
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms | Allocations: 664)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/users_controller.rb:14:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 22:07:58 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-01 16:37:58.808628"], ["id", 39]]
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.8ms | Allocations: 180)
Completed 201 Created in 262ms (Views: 1.6ms | ActiveRecord: 1.2ms | Allocations: 4337)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 22:08:45 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-01 16:38:45.593891"], ["id", 39]]
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 201 Created in 260ms (Views: 0.3ms | ActiveRecord: 1.2ms | Allocations: 3187)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-01 22:09:52 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-01 16:39:52.877165"], ["id", 39]]
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:34:in `update_user'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 201 Created in 252ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 2955)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-01 22:10:55 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3441)


  
NameError (undefined local variable or method `user' for #<SessionsController:0x0000000000c120>

    if user.nil?
       ^^^^
Did you mean?  @user):
  
app/controllers/sessions_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-01 22:11:31 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 176)
Completed 200 OK in 253ms (Views: 1.9ms | ActiveRecord: 0.4ms | Allocations: 6795)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-01 22:11:52 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 200 OK in 258ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1198)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "expenses"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "description" varchar, "amount" integer, "date" date, "invoice_Number" integer, "status" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/39/expenses" for 127.0.0.1 at 2022-08-01 22:43:57 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/user/39/expenses"):
  
Started POST "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 22:49:53 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.5ms | Allocations: 15485)


  
NoMethodError (undefined method `nill?' for #<User id: 39, name: "kasinathan", department: "Engineering", status: "active", email: "kasi@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 16:34:58.014011000 +0000", updated_at: "2022-08-01 16:39:52.877165000 +0000">
Did you mean?  nil?):
  
app/controllers/expenses_controller.rb:19:in `fetch_user'
app/controllers/expenses_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 22:50:21 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
[31mUnpermitted parameter: :invoice_number. Context: { controller: ExpensesController, action: create, request: #<ActionDispatch::Request:0x000000011691cc80>, params: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "controller"=>"expenses", "action"=>"create", "user_id"=>"39"} }[0m
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.7ms | Allocations: 12363)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Expense passed.):
  
app/controllers/expenses_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-01 22:57:19 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001170befd8>, params: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasinathan@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-01 17:27:20.207645"], ["updated_at", "2022-08-01 17:27:20.207645"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 40], ["created_at", "2022-08-01 17:27:20.214838"], ["updated_at", "2022-08-01 17:27:20.214838"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 40]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.4ms | Allocations: 2157)
Completed 201 Created in 256ms (Views: 2.1ms | ActiveRecord: 2.2ms | Allocations: 16097)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "expenses"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date, "invoice_Number" integer NOT NULL, "status" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/39/expenses" for 127.0.0.1 at 2022-08-01 23:00:16 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/user/39/expenses"):
  
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:00:57 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.7ms | Allocations: 16288)


  
ActiveModel::UnknownAttributeError (unknown attribute 'invoice_number' for Expense.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/controllers/expenses_controller.rb:8:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "expenses"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateExpenses (20220801162438)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date, "invoice_number" integer NOT NULL, "status" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220801162438"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:02:23 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.7ms | Allocations: 16048)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Expense passed.):
  
app/controllers/expenses_controller.rb:8:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:04:09 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `fetch_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:9:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", nil], ["amount", nil], ["date", nil], ["invoice_number", nil], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:35:02.007307"], ["updated_at", "2022-08-01 17:35:02.007307"]]
  ↳ app/controllers/expenses_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:9:in `create'
Completed 500 Internal Server Error in 49886ms (ActiveRecord: 3.4ms | Allocations: 47493)


  
ActiveRecord::NotNullViolation (SQLite3::ConstraintException: NOT NULL constraint failed: expenses.description):
  
app/controllers/expenses_controller.rb:9:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:05:44 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `fetch_user'
Completed 500 Internal Server Error in 1889ms (ActiveRecord: 2.1ms | Allocations: 28663)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Expense passed.):
  
app/controllers/expenses_controller.rb:9:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:09:07 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Travel", "amount"=>1000, "date"=>"2022-01-01", "invoice_number"=>100}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 1000], ["date", "2022-01-01"], ["invoice_number", 100], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:39:07.704363"], ["updated_at", "2022-08-01 17:39:07.704363"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
No template found for ExpensesController#create, rendering head :no_content
Completed 204 No Content in 24ms (ActiveRecord: 1.6ms | Allocations: 20745)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:14:47 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>101}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 101], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:44:47.445851"], ["updated_at", "2022-08-01 17:44:47.445851"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 2.6ms | Allocations: 4983)
Completed 500 Internal Server Error in 15ms (ActiveRecord: 1.5ms | Allocations: 18744)


  
ActionView::Template::Error (undefined method `id' for nil:NilClass

    attributes.each{ |key| _set_value key, _format_keys(object.public_send(key)) }
                                                              ^^^^^^^^^^^^):
    1: json.user do
    2:     json.(@user, :id, :name, :email)
    3:     json.expense(@user.expenses, :invoice_number, :description, :amount, :status, :date)
    4: end
  
app/views/expenses/create.jbuilder:2
app/views/expenses/create.jbuilder:1
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:15:17 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>101}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 101], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:45:17.783352"], ["updated_at", "2022-08-01 17:45:17.783352"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.9ms | Allocations: 4688)
Completed 500 Internal Server Error in 11ms (ActiveRecord: 1.0ms | Allocations: 9054)


  
ActionView::Template::Error (undefined local variable or method `user' for #<ActionView::Base:0x000000000107c0>

    json.(user, :id, :name, :email)
          ^^^^
Did you mean?  super):
    1: json.user do
    2:     json.(user, :id, :name, :email)
    3:     json.expense(user.expenses, :invoice_number, :description, :amount, :status, :date)
    4: end
  
app/views/expenses/create.jbuilder:2
app/views/expenses/create.jbuilder:1
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:21:00 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>103}, "user_id"=>"39"}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 103], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 103], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:51:00.855729"], ["updated_at", "2022-08-01 17:51:00.855729"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 184)
Completed 200 OK in 11ms (Views: 0.9ms | ActiveRecord: 1.7ms | Allocations: 13625)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:21:09 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>104}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 104], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 104], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:51:09.511027"], ["updated_at", "2022-08-01 17:51:09.511027"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.4ms | Allocations: 4657)
Completed 500 Internal Server Error in 9ms (ActiveRecord: 1.3ms | Allocations: 9986)


  
ActionView::Template::Error (undefined local variable or method `user' for #<ActionView::Base:0x00000000015310>

    json.(user, :id, :name, :email)
          ^^^^
Did you mean?  super):
    1: json.user do
    2:     json.(user, :id, :name, :email)
    3:     json.expense(user.expenses, :invoice_number, :description, :amount, :status, :date)
    4: end
  
app/views/expenses/create.jbuilder:2
app/views/expenses/create.jbuilder:1
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:23:24 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>105}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 105], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 105], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:53:24.677074"], ["updated_at", "2022-08-01 17:53:24.677074"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 2.6ms | Allocations: 4432)
Completed 500 Internal Server Error in 15ms (ActiveRecord: 1.6ms | Allocations: 18356)


  
ActionView::Template::Error (undefined method `invoice_number' for nil:NilClass

    attributes.each{ |key| _set_value key, _format_keys(object.public_send(key)) }
                                                              ^^^^^^^^^^^^):
    1: json.user do
    2:     json.(@user, :id, :name, :email)
    3:     json.expense(@expenses, :invoice_number, :description, :amount, :status, :date)
    4: end
  
app/views/expenses/create.jbuilder:3
app/views/expenses/create.jbuilder:1
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:23:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>105}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 105], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.4ms | Allocations: 7456)


  
NameError (undefined local variable or method `user' for #<ExpensesController:0x0000000001a090>

      logger.error("unable to add expense for user #{@user.id}, exception #{user.errors.full_messages}")
                                                                            ^^^^
Did you mean?  @user):
  
app/controllers/expenses_controller.rb:9:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:24:03 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>105}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 105], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
unable to add expense for user 39, exception []
Completed 400 Bad Request in 12ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 13460)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:24:38 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>105}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 105], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
unable to add expense for user 39, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 12ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 15070)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:25:07 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"description"=>"Food", "amount"=>200, "date"=>"2022-02-01", "invoice_number"=>106}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 106], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 200], ["date", "2022-02-01"], ["invoice_number", 106], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 17:55:07.171455"], ["updated_at", "2022-08-01 17:55:07.171455"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 351)
Completed 200 OK in 6ms (Views: 1.1ms | ActiveRecord: 0.9ms | Allocations: 5570)


  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateActiveStorageTables (20220801180522)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" bigint NOT NULL, "blob_id" bigint NOT NULL, "created_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c3b3935057"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_variant_records" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "blob_id" bigint NOT NULL, "variation_digest" varchar NOT NULL, CONSTRAINT "fk_rails_993965df05"
FOREIGN KEY ("blob_id")
  REFERENCES "active_storage_blobs" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_variant_records_uniqueness" ON "active_storage_variant_records" ("blob_id", "variation_digest")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220801180522"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:42:21 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"{"=>"", "text/plain"=>["{", " \"Food\",", " 200,", " \"2022-02-01\",", " 105"], "}"=>"", "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 400 Bad Request in 17ms (ActiveRecord: 0.5ms | Allocations: 15682)


  
ActionController::ParameterMissing (param is missing or the value is empty: expense):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:43:22 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"{"=>"", "text/plain"=>["{", " \"Food\",", " 200,", " \"2022-02-01\",", " 105"], "}"=>"", "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 400 Bad Request in 1ms (ActiveRecord: 0.1ms | Allocations: 1876)


  
ActionController::ParameterMissing (param is missing or the value is empty: expense):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:48:59 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"\"description\": \"Food\",\n\"amount\": 200,\n\"date\": \"2022-02-01\",\n\"invoice_number\": 105\n", "doc"=>#<ActionDispatch::Http::UploadedFile:0x00000001119240c0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-6r6i5s.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.5ms | Allocations: 11454)


  
NoMethodError (undefined method `permit' for "\"description\": \"Food\",\n\"amount\": 200,\n\"date\": \"2022-02-01\",\n\"invoice_number\": 105\n":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:49:41 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"{\"description\": \"Food\",\n\"amount\": 200,\n\"date\": \"2022-02-01\",\n\"invoice_number\": 105\n}\n", "doc"=>#<ActionDispatch::Http::UploadedFile:0x0000000111965e58 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-gmq00t.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3286)


  
NoMethodError (undefined method `permit' for "{\"description\": \"Food\",\n\"amount\": 200,\n\"date\": \"2022-02-01\",\n\"invoice_number\": 105\n}\n":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:51:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"{ \"invoice_number\" : 200,\n\"amount\" : 199,\n\"description\" : \"others\"\n}", "doc"=>#<ActionDispatch::Http::UploadedFile:0x00000001118dca18 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-2n9c7k.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3182)


  
NoMethodError (undefined method `permit' for "{ \"invoice_number\" : 200,\n\"amount\" : 199,\n\"description\" : \"others\"\n}":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:52:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"{\"invoice_number\":200,\"amount\":199,\"description\":\"others\"}", "doc"=>#<ActionDispatch::Http::UploadedFile:0x00000001118ddb20 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-yfw50w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3167)


  
NoMethodError (undefined method `permit' for "{\"invoice_number\":200,\"amount\":199,\"description\":\"others\"}":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:52:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"{invoice_number:200,amount:199,description:others}", "doc"=>#<ActionDispatch::Http::UploadedFile:0x000000011194e7a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-9mh0mh.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3167)


  
NoMethodError (undefined method `permit' for "{invoice_number:200,amount:199,description:others}":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:53:49 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"text/plain"=>["{\n    \"expense\" :{\n        \"description\" : \"Food\",\n        \"amount\": 200,\n        \"date\": \"2022-02-01\",\n        \"invoice_number\": 101\n    }\n}"], "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 400 Bad Request in 2ms (ActiveRecord: 0.1ms | Allocations: 1716)


  
ActionController::ParameterMissing (param is missing or the value is empty: expense):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:54:18 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"application/json"=>["{\n    \"expense\" :{\n        \"description\" : \"Food\",\n        \"amount\": 200,\n        \"date\": \"2022-02-01\",\n        \"invoice_number\": 101\n    }\n}"], "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 400 Bad Request in 1ms (ActiveRecord: 0.1ms | Allocations: 1713)


  
ActionController::ParameterMissing (param is missing or the value is empty: expense):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:55:04 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>"{\n        \"description\" : \"Food\",\n        \"amount\": 200,\n        \"date\": \"2022-02-01\",\n        \"invoice_number\": 101\n}\n", "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 3167)


  
NoMethodError (undefined method `permit' for "{\n        \"description\" : \"Food\",\n        \"amount\": 200,\n        \"date\": \"2022-02-01\",\n        \"invoice_number\": 101\n}\n":String

    params.require(:expense).permit(:description, :amount, :date, :invoice_number, :doc)
                            ^^^^^^^):
  
app/controllers/expenses_controller.rb:27:in `expense_args'
app/controllers/expenses_controller.rb:7:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:58:38 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"500", "description"=>"others"}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 500], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 500], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:28:38.206840"], ["updated_at", "2022-08-01 18:28:38.206840"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.9ms | Allocations: 411)
Completed 200 OK in 39ms (Views: 2.0ms | ActiveRecord: 1.9ms | Allocations: 19359)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-01 23:59:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"501", "description"=>"others"}, "doc"=>#<ActionDispatch::Http::UploadedFile:0x00000001140d7568 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220801-36397-dx27kq.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 501], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 501], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:29:00.774445"], ["updated_at", "2022-08-01 18:29:00.774445"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 132)
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.9ms | Allocations: 5002)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:02:48 +0530
  [1m[35m (7.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"502", "description"=>"others"}, "doc"=>#<ActionDispatch::Http::UploadedFile:0x0000000108507d88 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-44912-76fwsq.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 502], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 502], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:32:48.921174"], ["updated_at", "2022-08-01 18:32:48.921174"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.1ms | Allocations: 580)
Completed 200 OK in 32ms (Views: 3.4ms | ActiveRecord: 1.7ms | Allocations: 27649)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:03:57 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"503", "description"=>"others"}, "doc"=>#<ActionDispatch::Http::UploadedFile:0x000000010caac7f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-48044-ynh06m.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 503], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 503], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:34:05.610140"], ["updated_at", "2022-08-01 18:34:05.610140"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.7ms | Allocations: 580)
Completed 200 OK in 4958ms (Views: 4.4ms | ActiveRecord: 3.6ms | Allocations: 40295)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:04:17 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"504", "description"=>"others"}, "doc"=>#<ActionDispatch::Http::UploadedFile:0x000000010c226750 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-48044-b3nhtb.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"doc\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 504], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 504], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:34:22.923508"], ["updated_at", "2022-08-01 18:34:22.923508"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.5ms | Allocations: 283)
Completed 200 OK in 148285ms (Views: 4.1ms | ActiveRecord: 3.0ms | Allocations: 31386)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:14:10 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "invoice_number"=>"5011", "description"=>"others"}, "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107cdb790 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-57785-bchfst.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"document\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "user_id"=>"39"}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5011], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 5011], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:44:10.209737"], ["updated_at", "2022-08-01 18:44:10.209737"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.7ms | Allocations: 580)
Completed 200 OK in 28ms (Views: 2.3ms | ActiveRecord: 1.6ms | Allocations: 27710)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:15:38 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001089b7e50 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-57785-j84um1.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5012", "description"=>"others"}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5012], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 5012], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:45:38.158916"], ["updated_at", "2022-08-01 18:45:38.158916"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "118aqtu8hv5z2pljvt6f1yfbtzov"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-01 18:45:38.173917"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 14], ["blob_id", 1], ["created_at", "2022-08-01 18:45:38.175082"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-01 18:45:38.175968"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 118aqtu8hv5z2pljvt6f1yfbtzov (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.4ms | Allocations: 285)
Completed 200 OK in 47ms (Views: 1.0ms | ActiveRecord: 2.7ms | Allocations: 43540)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:20:21 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001090453d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-57785-ud1gb8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"50112", "description"=>"others"}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:18:in `fetch_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 50112], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 50112], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 18:50:21.304423"], ["updated_at", "2022-08-01 18:50:21.304423"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "025t5nzgglvhi13b5stsd716k39r"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-01 18:50:21.309450"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 15], ["blob_id", 2], ["created_at", "2022-08-01 18:50:21.310312"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-01 18:50:21.310883"], ["id", 15]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 025t5nzgglvhi13b5stsd716k39r (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 518)
Completed 200 OK in 16ms (Views: 1.1ms | ActiveRecord: 1.9ms | Allocations: 14124)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:43:56 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000115bccfd0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-28505-vhfr4q.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"others"}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 5], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 19:13:56.156457"], ["updated_at", "2022-08-01 19:13:56.156457"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 16], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 16], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vs47er2b8ygo2bwjznhv30pkbu9y"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-01 19:13:56.166417"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 16], ["blob_id", 3], ["created_at", "2022-08-01 19:13:56.167335"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-01 19:13:56.167943"], ["id", 16]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: vs47er2b8ygo2bwjznhv30pkbu9y (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 48ms (ActiveRecord: 3.2ms | Allocations: 53793)


  
Pundit::NotDefinedError (unable to find policy `UserPolicy` for `#<User id: 39, name: "kasinathan", department: "Engineering", status: "active", email: "kasi@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 16:34:58.014011000 +0000", updated_at: "2022-08-01 16:39:52.877165000 +0000">`):
  
app/controllers/expenses_controller.rb:8:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:45:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001109bdb90 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-28505-v6t7z4.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"others"}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 39ms (ActiveRecord: 1.9ms | Allocations: 28044)


  
NoMethodError (undefined method `status_active?' for #<User id: 39, name: "kasinathan", department: "Engineering", status: "active", email: "kasi@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 16:34:58.014011000 +0000", updated_at: "2022-08-01 16:39:52.877165000 +0000">
Did you mean?  status_changed?):
  
app/policies/user_policy.rb:6:in `create?'
app/controllers/expenses_controller.rb:8:in `create'
Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:46:52 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010717b800 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-28505-2spcxd.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"others"}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
unable to add expense for user 39, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 24ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 24842)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:47:01 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000115b46a98 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-28505-iaxxdh.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"51", "description"=>"others"}, "user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 51], ["status", 0], ["user_id", 39], ["created_at", "2022-08-01 19:17:01.890688"], ["updated_at", "2022-08-01 19:17:01.890688"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 17], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 17], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "h9j85iuxzpsouzwg5yg808yn7scz"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-01 19:17:01.898010"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 17], ["blob_id", 4], ["created_at", "2022-08-01 19:17:01.898981"]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-01 19:17:01.899634"], ["id", 17]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: h9j85iuxzpsouzwg5yg808yn7scz (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 362)
Completed 200 OK in 20ms (Views: 1.2ms | ActiveRecord: 2.5ms | Allocations: 21142)


Started POST "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:47:23 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106764fd8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-28505-7t8cua.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"51", "description"=>"others"}, "user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `fetch_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:7:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
unable to add expense for user 39, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 22ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 23605)


Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:58:40 +0530
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:32: syntax error, unexpected end-of-input, expecting `end'):
  
app/controllers/expenses_controller.rb:32: syntax error, unexpected end-of-input, expecting `end'
app/controllers/expenses_controller.rb:32: syntax error, unexpected end-of-input, expecting `end'
app/controllers/expenses_controller.rb:32: syntax error, unexpected end-of-input, expecting `end'
Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 00:59:04 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:22:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  [1m[36mCACHE Expense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  Rendered expenses/index.jbuilder (Duration: 16.4ms | Allocations: 14748)
Completed 500 Internal Server Error in 24ms (ActiveRecord: 0.6ms | Allocations: 21638)


  
ActionView::Template::Error (undefined method `invoice_number' for #<ActiveRecord::Associations::CollectionProxy [#<Expense id: 1, description: "Travel", amount: 1000, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-01 17:39:07.704363000 +0000">, #<Expense id: 2, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:44:47.445851000 +0000", updated_at: "2022-08-01 17:44:47.445851000 +0000">, #<Expense id: 3, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:45:17.783352000 +0000", updated_at: "2022-08-01 17:45:17.783352000 +0000">, #<Expense id: 4, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 103, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:00.855729000 +0000", updated_at: "2022-08-01 17:51:00.855729000 +0000">, #<Expense id: 5, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 104, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:09.511027000 +0000", updated_at: "2022-08-01 17:51:09.511027000 +0000">, #<Expense id: 6, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 105, status: "drafted", user_id: 39, created_at: "2022-08-01 17:53:24.677074000 +0000", updated_at: "2022-08-01 17:53:24.677074000 +0000">, #<Expense id: 7, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 106, status: "drafted", user_id: 39, created_at: "2022-08-01 17:55:07.171455000 +0000", updated_at: "2022-08-01 17:55:07.171455000 +0000">, #<Expense id: 8, description: "others", amount: 100, date: nil, invoice_number: 500, status: "drafted", user_id: 39, created_at: "2022-08-01 18:28:38.206840000 +0000", updated_at: "2022-08-01 18:28:38.206840000 +0000">, #<Expense id: 9, description: "others", amount: 100, date: nil, invoice_number: 501, status: "drafted", user_id: 39, created_at: "2022-08-01 18:29:00.774445000 +0000", updated_at: "2022-08-01 18:29:00.774445000 +0000">, #<Expense id: 10, description: "others", amount: 100, date: nil, invoice_number: 502, status: "drafted", user_id: 39, created_at: "2022-08-01 18:32:48.921174000 +0000", updated_at: "2022-08-01 18:32:48.921174000 +0000">, ...]>):
    1: json.expenses do
    2:     json.(@user.expenses, :invoice_number, :amount, :description, :status)
    3: end
  
app/views/expenses/index.jbuilder:2
app/views/expenses/index.jbuilder:1
Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:02:17 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  [1m[36mCACHE Expense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  Rendered expenses/index.jbuilder (Duration: 17.6ms | Allocations: 19415)
Completed 500 Internal Server Error in 31ms (ActiveRecord: 0.8ms | Allocations: 32289)


  
ActionView::Template::Error (undefined method `invoice_number' for #<ActiveRecord::Associations::CollectionProxy [#<Expense id: 1, description: "Travel", amount: 1000, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-01 17:39:07.704363000 +0000">, #<Expense id: 2, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:44:47.445851000 +0000", updated_at: "2022-08-01 17:44:47.445851000 +0000">, #<Expense id: 3, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:45:17.783352000 +0000", updated_at: "2022-08-01 17:45:17.783352000 +0000">, #<Expense id: 4, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 103, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:00.855729000 +0000", updated_at: "2022-08-01 17:51:00.855729000 +0000">, #<Expense id: 5, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 104, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:09.511027000 +0000", updated_at: "2022-08-01 17:51:09.511027000 +0000">, #<Expense id: 6, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 105, status: "drafted", user_id: 39, created_at: "2022-08-01 17:53:24.677074000 +0000", updated_at: "2022-08-01 17:53:24.677074000 +0000">, #<Expense id: 7, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 106, status: "drafted", user_id: 39, created_at: "2022-08-01 17:55:07.171455000 +0000", updated_at: "2022-08-01 17:55:07.171455000 +0000">, #<Expense id: 8, description: "others", amount: 100, date: nil, invoice_number: 500, status: "drafted", user_id: 39, created_at: "2022-08-01 18:28:38.206840000 +0000", updated_at: "2022-08-01 18:28:38.206840000 +0000">, #<Expense id: 9, description: "others", amount: 100, date: nil, invoice_number: 501, status: "drafted", user_id: 39, created_at: "2022-08-01 18:29:00.774445000 +0000", updated_at: "2022-08-01 18:29:00.774445000 +0000">, #<Expense id: 10, description: "others", amount: 100, date: nil, invoice_number: 502, status: "drafted", user_id: 39, created_at: "2022-08-01 18:32:48.921174000 +0000", updated_at: "2022-08-01 18:32:48.921174000 +0000">, ...]>):
    1: json.expenses do
    2:     json.(@user.expenses, :invoice_number, :amount, :description, :status)
    3: end
  
app/views/expenses/index.jbuilder:2
app/views/expenses/index.jbuilder:1
Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:03:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:1
  Rendered expenses/index.jbuilder (Duration: 2.1ms | Allocations: 2532)
Completed 200 OK in 5ms (Views: 2.6ms | ActiveRecord: 0.3ms | Allocations: 4544)


Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:04:03 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:1
  Rendered expenses/index.jbuilder (Duration: 1.4ms | Allocations: 1660)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 3603)


Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:04:34 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:1
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 1953)
Completed 200 OK in 4ms (Views: 2.2ms | ActiveRecord: 0.2ms | Allocations: 3904)


Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:05:12 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:1
  Rendered expenses/index.jbuilder (Duration: 1.1ms | Allocations: 1678)
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 3118)


Started GET "//api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:05:51 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.1ms | Allocations: 3444)
Completed 200 OK in 4ms (Views: 2.5ms | ActiveRecord: 0.2ms | Allocations: 5309)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 01:10:55 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:23:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.1ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 2.2ms | ActiveRecord: 0.2ms | Allocations: 4544)


Started GET "/api/v1/expense_tracker/users/39/expenses/500" for 127.0.0.1 at 2022-08-02 01:11:46 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"500"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 500], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:22:in `show'
Completed 404 Not Found in 14ms (ActiveRecord: 0.9ms | Allocations: 11457)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=500 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:22:in `show'
Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 01:13:04 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:22:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.9ms | Allocations: 354)
Completed 200 OK in 5ms (Views: 1.6ms | ActiveRecord: 0.2ms | Allocations: 5187)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 10:05:12 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:22:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.9ms | Allocations: 169)
Completed 200 OK in 12ms (Views: 1.6ms | ActiveRecord: 0.7ms | Allocations: 3111)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 10:18:15 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.6ms | Allocations: 398)
Completed 200 OK in 256ms (Views: 1.9ms | ActiveRecord: 0.4ms | Allocations: 12499)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 10:18:58 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.5ms | Allocations: 178)
Completed 200 OK in 250ms (Views: 1.2ms | ActiveRecord: 0.1ms | Allocations: 1817)


Started POST "/api/v1/expense_tracker/user/login?email=kasinathan@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 10:19:17 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasinathan@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
password mismatch for user kasinathan@gmail.com
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1039)


Started POST "/api/v1/expense_tracker/user/login?email=kasinathan@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 10:19:26 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasinathan@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 200 OK in 252ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1127)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:20:07 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.2ms | Allocations: 3085)


  
Pundit::NotAuthorizedError (not allowed to index? this User):
  
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:21:33 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 61.2ms | Allocations: 13587)
Completed 200 OK in 20832ms (Views: 63.4ms | ActiveRecord: 2.4ms | Allocations: 45579)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:22:10 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (2.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 35.4ms | Allocations: 3224)
Completed 200 OK in 4748ms (Views: 34.0ms | ActiveRecord: 3.5ms | Allocations: 17633)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:22:26 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 29.6ms | Allocations: 3224)
Completed 200 OK in 52998ms (Views: 31.2ms | ActiveRecord: 1.1ms | Allocations: 24312)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:23:29 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 84.9ms | Allocations: 18689)
Completed 200 OK in 37198ms (Views: 88.9ms | ActiveRecord: 3.4ms | Allocations: 52446)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:44 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 14.3ms | Allocations: 13593)
Completed 200 OK in 28ms (Views: 15.6ms | ActiveRecord: 0.9ms | Allocations: 26565)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:45 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 3221)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 4798)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:45 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 3104)
Completed 200 OK in 3ms (Views: 1.9ms | ActiveRecord: 0.2ms | Allocations: 4498)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:47 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.0ms | Allocations: 3104)
Completed 200 OK in 4ms (Views: 2.4ms | ActiveRecord: 0.2ms | Allocations: 4486)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 3104)
Completed 200 OK in 3ms (Views: 1.9ms | ActiveRecord: 0.2ms | Allocations: 4489)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.6ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 1.7ms | ActiveRecord: 0.2ms | Allocations: 4466)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.6ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 4475)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:49 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 0.2ms | Allocations: 4484)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:49 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.2ms | Allocations: 3102)
Completed 200 OK in 4ms (Views: 2.4ms | ActiveRecord: 0.2ms | Allocations: 4502)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:50 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.5ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 1.7ms | ActiveRecord: 0.3ms | Allocations: 4478)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:50 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 4490)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:50 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 3102)
Completed 200 OK in 11ms (Views: 2.1ms | ActiveRecord: 0.3ms | Allocations: 4475)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:52 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 3102)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.2ms | Allocations: 4484)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:24:53 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.6ms | Allocations: 3102)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 4484)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:25:43 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 106.0ms | Allocations: 13570)
Completed 200 OK in 148700ms (Views: 110.0ms | ActiveRecord: 2.4ms | Allocations: 72575)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:28:29 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 80.2ms | Allocations: 9740)
Completed 200 OK in 9047ms (Views: 83.7ms | ActiveRecord: 3.4ms | Allocations: 57418)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:32:30 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 32.8ms | Allocations: 3290)
Completed 200 OK in 12881ms (Views: 34.4ms | ActiveRecord: 1.2ms | Allocations: 51437)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:32:51 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 80.7ms | Allocations: 9734)
Completed 200 OK in 7643ms (Views: 84.1ms | ActiveRecord: 3.2ms | Allocations: 57132)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:34:56 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 40], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 40], ["LIMIT", 11]]
  ↳ app/policies/user_policy.rb:10:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 90.0ms | Allocations: 11513)
Completed 200 OK in 10693ms (Views: 88.5ms | ActiveRecord: 11.5ms | Allocations: 78893)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:36:09 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 68.2ms | Allocations: 9767)
Completed 200 OK in 5791ms (Views: 69.2ms | ActiveRecord: 3.5ms | Allocations: 47777)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:41:19 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 75.5ms | Allocations: 9703)
Completed 200 OK in 9856ms (Views: 77.1ms | ActiveRecord: 4.7ms | Allocations: 70347)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:43:56 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 5314ms (ActiveRecord: 3.2ms | Allocations: 49889)


  
Pundit::NotAuthorizedError (not allowed to index? this User):
  
app/controllers/expenses_controller.rb:19:in `index'
Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:46:54 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 19ms (ActiveRecord: 0.6ms | Allocations: 15745)


  
Pundit::NotAuthorizedError (not allowed to index? this User):
  
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:52:16 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 11ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 10383)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:52:28 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 40]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 5.5ms | Allocations: 5484)
Completed 200 OK in 8ms (Views: 5.8ms | ActiveRecord: 0.3ms | Allocations: 8025)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:52:34 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2461)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 10:53:27 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.5ms | Allocations: 176)
Completed 200 OK in 254ms (Views: 2.1ms | ActiveRecord: 0.1ms | Allocations: 2012)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 10:53:37 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 6.3ms | Allocations: 7402)
Completed 200 OK in 10ms (Views: 6.4ms | ActiveRecord: 0.4ms | Allocations: 9560)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:53:42 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2531)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:54:55 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 79745ms (Views: 1.0ms | ActiveRecord: 2.6ms | Allocations: 72758)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:56:35 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 29277ms (Views: 0.7ms | ActiveRecord: 3.9ms | Allocations: 61022)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:57:07 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 25056ms (Views: 0.9ms | ActiveRecord: 2.5ms | Allocations: 51576)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 10:57:36 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 40]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 25.7ms | Allocations: 5567)
Completed 200 OK in 3150ms (Views: 29.6ms | ActiveRecord: 3.2ms | Allocations: 57011)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:32:36 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 3912ms (ActiveRecord: 1.3ms | Allocations: 47665)


  
NoMethodError (undefined method `role' for UserRole:Class
Did you mean?  roles):
  
app/models/user.rb:24:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:32:59 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 2492ms (ActiveRecord: 2.6ms | Allocations: 32824)


  
NoMethodError (undefined method `admin' for {"basic"=>0, "admin"=>1}:ActiveSupport::HashWithIndifferentAccess

    user_roles.roles.keys.include? UserRole.roles.admin
                                                 ^^^^^^):
  
app/models/user.rb:24:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:34:40 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
Completed 500 Internal Server Error in 501ms (ActiveRecord: 0.0ms | Allocations: 9480)


  
TypeError (wrong argument type Class (expected Module)):
  
app/models/user.rb:3:in `include'
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:2:in `<main>'
app/controllers/application_controller.rb:10:in `current_user'
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:36:26 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 4401ms (ActiveRecord: 2.7ms | Allocations: 53021)


  
NoMethodError (undefined method `role' for UserRole:Class
Did you mean?  roles):
  
app/models/user.rb:24:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:36:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 2816ms (ActiveRecord: 3.2ms | Allocations: 36026)


  
NoMethodError (undefined method `admin' for {"basic"=>0, "admin"=>1}:ActiveSupport::HashWithIndifferentAccess

    user_roles.roles.keys.include? UserRole::roles.admin
                                                  ^^^^^^):
  
app/models/user.rb:24:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/expenses_controller.rb:18:in `index'
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:40:42 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 9124ms (Views: 1.0ms | ActiveRecord: 2.7ms | Allocations: 41171)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:41:06 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:41:57 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 62382ms (Views: 1.1ms | ActiveRecord: 3.2ms | Allocations: 70924)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:43:04 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 40]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 28.9ms | Allocations: 5573)
Completed 200 OK in 1832ms (Views: 32.3ms | ActiveRecord: 3.9ms | Allocations: 38982)


Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:53:23 +0530
Started GET "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 11:53:34 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 40]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 5.6ms | Allocations: 5596)
Completed 200 OK in 29ms (Views: 6.7ms | ActiveRecord: 1.0ms | Allocations: 25669)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 11:53:38 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 6.1ms | Allocations: 7072)
Completed 200 OK in 9ms (Views: 6.2ms | ActiveRecord: 0.4ms | Allocations: 10047)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 11:53:49 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 1.0ms | Allocations: 289)
Completed 200 OK in 4ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 2847)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 11:55:03 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.2ms | Allocations: 170)
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 2311)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 11:56:30 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99}, "user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:34:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:34:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 99], ["updated_at", "2022-08-02 06:26:30.858291"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:34:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:34:in `update'
No template found for ExpensesController#update, rendering head :no_content
Completed 204 No Content in 5ms (ActiveRecord: 0.8ms | Allocations: 6550)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:01:29 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 278)
Completed 200 OK in 11ms (Views: 0.9ms | ActiveRecord: 0.9ms | Allocations: 14111)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:02:07 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 101], ["updated_at", "2022-08-02 06:32:07.352421"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 115)
Completed 200 OK in 15ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 5462)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 12:10:27 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:51:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 6.6ms | Allocations: 9351)
Completed 200 OK in 20ms (Views: 7.0ms | ActiveRecord: 1.1ms | Allocations: 21065)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 12:10:44 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:51:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 72.7ms | Allocations: 11786)
Completed 200 OK in 22821ms (Views: 85.2ms | ActiveRecord: 4.7ms | Allocations: 83814)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:21:20 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.7ms | Allocations: 523)
Completed 200 OK in 74398ms (Views: 6.7ms | ActiveRecord: 3.6ms | Allocations: 53258)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:22:45 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 5905ms (ActiveRecord: 3.3ms | Allocations: 35716)


  
NoMethodError (undefined method `draft?' for #<Expense id: 1, description: "Domestic travel", amount: 101, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-02 06:32:07.352421000 +0000">
Did you mean?  drafted?):
  
app/policies/expense_policy.rb:4:in `update?'
app/controllers/expenses_controller.rb:69:in `authorize_expense_status'
app/controllers/expenses_controller.rb:28:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:27:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 2494ms (ActiveRecord: 3.6ms | Allocations: 27766)


  
NameError (undefined local variable or method `expense' for #<ExpensePolicy:0x000000011513f6f8 @user=#<User id: 39, name: "kasinathan", department: "Engineering", status: "active", email: "kasi@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 16:34:58.014011000 +0000", updated_at: "2022-08-01 16:39:52.877165000 +0000">, @record=#<Expense id: 1, description: "Domestic travel", amount: 101, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-02 06:32:07.352421000 +0000">>

    p expense    
      ^^^^^^^):
  
app/policies/expense_policy.rb:4:in `update?'
app/controllers/expenses_controller.rb:69:in `authorize_expense_status'
app/controllers/expenses_controller.rb:28:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:28:05 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 77057ms (ActiveRecord: 3.2ms | Allocations: 39508)


  
NoMethodError (undefined method `draft?' for #<Expense id: 1, description: "Domestic travel", amount: 101, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-02 06:32:07.352421000 +0000">
Did you mean?  drafted?):
  
app/policies/expense_policy.rb:5:in `update?'
app/controllers/expenses_controller.rb:69:in `authorize_expense_status'
app/controllers/expenses_controller.rb:28:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:30:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.4ms | Allocations: 275)
Completed 200 OK in 6137ms (Views: 6.3ms | ActiveRecord: 4.3ms | Allocations: 49745)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:31:21 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.3ms | Allocations: 178)
Completed 200 OK in 672ms (Views: 3.5ms | ActiveRecord: 3.5ms | Allocations: 20045)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:32:02 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 403 Forbidden in 3149ms (Views: 1.0ms | ActiveRecord: 2.9ms | Allocations: 28312)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 12:33:42 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:38:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 403 Forbidden in 1620ms (Views: 0.4ms | ActiveRecord: 2.8ms | Allocations: 28141)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 13:59:00 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:68:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."role" = ? /* loading for inspect */ LIMIT ?[0m  [["role", 1], ["LIMIT", 11]]
  ↳ app/models/user.rb:24:in `p'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 3.4ms | Allocations: 352)
Completed 200 OK in 8067ms (Views: 5.8ms | ActiveRecord: 4.3ms | Allocations: 57895)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 13:59:29 +0530
Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 13:59:40 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:68:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 11.2ms | Allocations: 12102)
Completed 200 OK in 37ms (Views: 12.9ms | ActiveRecord: 0.9ms | Allocations: 29557)


  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateReports (20220802085148)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "reports" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "status" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220802085148"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
Migrating to AddReferencesToExpense (20220802085645)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aexpenses" ("id" integer NOT NULL PRIMARY KEY, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date DEFAULT NULL, "invoice_number" integer NOT NULL, "status" integer DEFAULT NULL, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aexpenses_on_user_id" ON "aexpenses" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "aexpenses" ("id","description","amount","date","invoice_number","status","user_id","created_at","updated_at")
                     SELECT "id","description","amount","date","invoice_number","status","user_id","created_at","updated_at" FROM "expenses"[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE "expenses"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer NOT NULL PRIMARY KEY, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date DEFAULT NULL, "invoice_number" integer NOT NULL, "status" integer DEFAULT NULL, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "report_id" integer NOT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "expenses" ("id","description","amount","date","invoice_number","status","user_id","created_at","updated_at")
                     SELECT "id","description","amount","date","invoice_number","status","user_id","created_at","updated_at" FROM "aexpenses"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateReports (20220802085148)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE "reports"[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220802085148"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateReports (20220802085148)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "reports" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "status" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220802085148"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
Migrating to AddReferencesToExpense (20220802085645)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "expenses" ADD "report_id" integer[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_report_id" ON "expenses" ("report_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aexpenses" ("id" integer NOT NULL PRIMARY KEY, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date DEFAULT NULL, "invoice_number" integer NOT NULL, "status" integer DEFAULT NULL, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "report_id" integer DEFAULT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aexpenses_on_report_id" ON "aexpenses" ("report_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aexpenses_on_user_id" ON "aexpenses" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "aexpenses" ("id","description","amount","date","invoice_number","status","user_id","created_at","updated_at","report_id")
                     SELECT "id","description","amount","date","invoice_number","status","user_id","created_at","updated_at","report_id" FROM "expenses"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "expenses"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "expenses" ("id" integer NOT NULL PRIMARY KEY, "description" varchar NOT NULL, "amount" integer NOT NULL, "date" date DEFAULT NULL, "invoice_number" integer NOT NULL, "status" integer DEFAULT NULL, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "report_id" integer DEFAULT NULL, CONSTRAINT "fk_rails_c3ee69df61"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
, CONSTRAINT "fk_rails_39be32d1e4"
FOREIGN KEY ("report_id")
  REFERENCES "reports" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_user_id" ON "expenses" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_expenses_on_report_id" ON "expenses" ("report_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "expenses" ("id","description","amount","date","invoice_number","status","user_id","created_at","updated_at","report_id")
                     SELECT "id","description","amount","date","invoice_number","status","user_id","created_at","updated_at","report_id" FROM "aexpenses"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "aexpenses"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220802085645"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "//api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:08:21 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/users/39/reports"):
  
Started POST "//api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:08:55 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/users/39/reports"):
  
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:09:15 +0530
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/users/39/reports"):
  
Started POST "/api/v1/expense_tracker/users/39/report" for 127.0.0.1 at 2022-08-02 15:10:10 +0530
  
ActionController::RoutingError (uninitialized constant ReportController

      Object.const_get(camel_cased_word)
            ^^^^^^^^^^
Did you mean?  ReportsController

            raise MissingController.new(error.message, error.name)
            ^^^^^):
  
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:10:36 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 20ms (ActiveRecord: 1.8ms | Allocations: 9590)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:12:46 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.8ms | Allocations: 8051)


  
NameError (undefined local variable or method `drafted' for #<ReportsController:0x00000000017200>

        @report = Report.new(status: drafted)
                                     ^^^^^^^):
  
app/controllers/reports_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:13:14 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 6ms (ActiveRecord: 0.8ms | Allocations: 6788)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:13:46 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.8ms | Allocations: 6663)


  
ArgumentError ('draftedd' is not a valid status):
  
app/controllers/reports_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:26:31 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `fetch_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 30ms (ActiveRecord: 1.8ms | Allocations: 18095)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:27:15 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 10ms (ActiveRecord: 1.0ms | Allocations: 14611)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 15:27:41 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:68:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.5ms | Allocations: 3638)
Completed 200 OK in 8ms (Views: 3.1ms | ActiveRecord: 0.4ms | Allocations: 8736)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 15:28:19 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:68:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 6.9ms | Allocations: 10026)
Completed 200 OK in 20ms (Views: 7.1ms | ActiveRecord: 1.1ms | Allocations: 20072)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:28:22 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.3ms | Allocations: 7107)


  [1m[36mCACHE Expense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  
NoMethodError (undefined method `id' for #<ActiveRecord::Associations::CollectionProxy [#<Expense id: 1, description: "Domestic travel", amount: 101, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-02 06:32:07.352421000 +0000", report_id: nil>, #<Expense id: 2, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:44:47.445851000 +0000", updated_at: "2022-08-01 17:44:47.445851000 +0000", report_id: nil>, #<Expense id: 3, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:45:17.783352000 +0000", updated_at: "2022-08-01 17:45:17.783352000 +0000", report_id: nil>, #<Expense id: 4, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 103, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:00.855729000 +0000", updated_at: "2022-08-01 17:51:00.855729000 +0000", report_id: nil>, #<Expense id: 5, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 104, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:09.511027000 +0000", updated_at: "2022-08-01 17:51:09.511027000 +0000", report_id: nil>, #<Expense id: 6, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 105, status: "drafted", user_id: 39, created_at: "2022-08-01 17:53:24.677074000 +0000", updated_at: "2022-08-01 17:53:24.677074000 +0000", report_id: nil>, #<Expense id: 7, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 106, status: "drafted", user_id: 39, created_at: "2022-08-01 17:55:07.171455000 +0000", updated_at: "2022-08-01 17:55:07.171455000 +0000", report_id: nil>, #<Expense id: 8, description: "others", amount: 100, date: nil, invoice_number: 500, status: "drafted", user_id: 39, created_at: "2022-08-01 18:28:38.206840000 +0000", updated_at: "2022-08-01 18:28:38.206840000 +0000", report_id: nil>, #<Expense id: 9, description: "others", amount: 100, date: nil, invoice_number: 501, status: "drafted", user_id: 39, created_at: "2022-08-01 18:29:00.774445000 +0000", updated_at: "2022-08-01 18:29:00.774445000 +0000", report_id: nil>, #<Expense id: 10, description: "others", amount: 100, date: nil, invoice_number: 502, status: "drafted", user_id: 39, created_at: "2022-08-01 18:32:48.921174000 +0000", updated_at: "2022-08-01 18:32:48.921174000 +0000", report_id: nil>, ...]>
Did you mean?  ids):
  
app/controllers/reports_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:28:32 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mExpense Pluck (0.1ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
Completed 500 Internal Server Error in 14ms (ActiveRecord: 1.1ms | Allocations: 18312)


  [1m[36mCACHE Expense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 39], ["LIMIT", 11]]
  
NoMethodError (undefined method `id' for #<ActiveRecord::Associations::CollectionProxy [#<Expense id: 1, description: "Domestic travel", amount: 101, date: "2022-01-01", invoice_number: 100, status: "drafted", user_id: 39, created_at: "2022-08-01 17:39:07.704363000 +0000", updated_at: "2022-08-02 06:32:07.352421000 +0000", report_id: nil>, #<Expense id: 2, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:44:47.445851000 +0000", updated_at: "2022-08-01 17:44:47.445851000 +0000", report_id: nil>, #<Expense id: 3, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 101, status: "drafted", user_id: 39, created_at: "2022-08-01 17:45:17.783352000 +0000", updated_at: "2022-08-01 17:45:17.783352000 +0000", report_id: nil>, #<Expense id: 4, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 103, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:00.855729000 +0000", updated_at: "2022-08-01 17:51:00.855729000 +0000", report_id: nil>, #<Expense id: 5, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 104, status: "drafted", user_id: 39, created_at: "2022-08-01 17:51:09.511027000 +0000", updated_at: "2022-08-01 17:51:09.511027000 +0000", report_id: nil>, #<Expense id: 6, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 105, status: "drafted", user_id: 39, created_at: "2022-08-01 17:53:24.677074000 +0000", updated_at: "2022-08-01 17:53:24.677074000 +0000", report_id: nil>, #<Expense id: 7, description: "Food", amount: 200, date: "2022-02-01", invoice_number: 106, status: "drafted", user_id: 39, created_at: "2022-08-01 17:55:07.171455000 +0000", updated_at: "2022-08-01 17:55:07.171455000 +0000", report_id: nil>, #<Expense id: 8, description: "others", amount: 100, date: nil, invoice_number: 500, status: "drafted", user_id: 39, created_at: "2022-08-01 18:28:38.206840000 +0000", updated_at: "2022-08-01 18:28:38.206840000 +0000", report_id: nil>, #<Expense id: 9, description: "others", amount: 100, date: nil, invoice_number: 501, status: "drafted", user_id: 39, created_at: "2022-08-01 18:29:00.774445000 +0000", updated_at: "2022-08-01 18:29:00.774445000 +0000", report_id: nil>, #<Expense id: 10, description: "others", amount: 100, date: nil, invoice_number: 502, status: "drafted", user_id: 39, created_at: "2022-08-01 18:32:48.921174000 +0000", updated_at: "2022-08-01 18:32:48.921174000 +0000", report_id: nil>, ...]>
Did you mean?  ids):
  
app/controllers/reports_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:28:41 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mExpense Pluck (0.1ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 14ms (ActiveRecord: 1.3ms | Allocations: 11751)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:28:55 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mExpense Pluck (0.1ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:16:in `fetch_user'
  [1m[36mCACHE Expense Pluck (0.0ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 11ms (ActiveRecord: 1.6ms | Allocations: 12730)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:29:59 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:12:in `fetch_user'
  [1m[36mExpense Pluck (0.1ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 9ms (ActiveRecord: 1.2ms | Allocations: 11518)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:30:26 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:13:in `fetch_user'
  [1m[36mExpense Pluck (0.1ms)[0m  [1m[34mSELECT "expenses"."id" FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 9ms (ActiveRecord: 1.1ms | Allocations: 11499)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:41:40 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:11:41.049642"], ["updated_at", "2022-08-02 10:11:41.049642"]]
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:13:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:7:in `create'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 16ms (ActiveRecord: 1.7ms | Allocations: 16130)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:48:16 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:18:17.015996"], ["updated_at", "2022-08-02 10:18:17.015996"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 2], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:7:in `p'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:13:in `fetch_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:18:17.026590"], ["report_id", 2], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 2], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:9:in `p'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 21ms (ActiveRecord: 2.8ms | Allocations: 25814)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:49:58 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:19:58.703801"], ["updated_at", "2022-08-02 10:19:58.703801"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 3], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:7:in `p'
  [1m[36mCACHE Expense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 3], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:10:in `p'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 16ms (ActiveRecord: 1.9ms | Allocations: 13091)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:50:58 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:20:58.500995"], ["updated_at", "2022-08-02 10:20:58.500995"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 4], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:7:in `p'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:14:in `fetch_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:25:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:20:58.513647"], ["report_id", 4], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 4], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:10:in `p'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 24ms (ActiveRecord: 3.8ms | Allocations: 26663)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:55:23 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:25:23.655350"], ["updated_at", "2022-08-02 10:25:23.655350"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 5], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:7:in `p'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:14:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:25:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:25:23.665213"], ["report_id", 5], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 5], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:10:in `p'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 20ms (ActiveRecord: 2.9ms | Allocations: 26779)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:57:05 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 6], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:27:05.994275"], ["updated_at", "2022-08-02 10:27:05.994275"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 6], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:7:in `p'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:14:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:25:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 103], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:27:05.999387"], ["report_id", 6], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 104], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:27:06.001998"], ["report_id", 6], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 105], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:27:06.006846"], ["report_id", 6], ["id", 6]]
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 6], ["LIMIT", 11]]
  ↳ app/controllers/reports_controller.rb:10:in `p'
No template found for ReportsController#create, rendering head :no_content
Completed 204 No Content in 16ms (ActiveRecord: 3.4ms | Allocations: 14186)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 15:59:45 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 6], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 10:29:45.317476"], ["updated_at", "2022-08-02 10:29:45.317476"]]
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:5:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:11:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:22:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 103], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:29:45.331268"], ["report_id", 7], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 104], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:29:45.333603"], ["report_id", 7], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 105], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:29:45.335889"], ["report_id", 7], ["id", 6]]
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:24:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 7]]
  ↳ app/views/reports/create.jbuilder:2
  Rendered reports/create.jbuilder (Duration: 1.7ms | Allocations: 2775)
Completed 200 OK in 27ms (Views: 2.2ms | ActiveRecord: 3.7ms | Allocations: 28099)


Started POST "//api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:21:18 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a486588 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-59qyp7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"51", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:26:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
unable to add expense for user 40, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 44ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 36739)


Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:21:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a995768 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-akvu8v.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"51", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:26:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
unable to add expense for user 40, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 6368)


Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:21:40 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010ab3f7d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-gw1csa.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"59", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:26:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 59], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 59], ["status", 0], ["user_id", 40], ["created_at", "2022-08-02 10:51:40.489031"], ["updated_at", "2022-08-02 10:51:40.489031"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 18], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 18], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Create (1.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "rfl6fvffurjcuckg7gcmooxeb3fo"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 10:51:40.507026"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 18], ["blob_id", 5], ["created_at", "2022-08-02 10:51:40.509264"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:51:40.509924"], ["id", 18]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: rfl6fvffurjcuckg7gcmooxeb3fo (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.1ms | Allocations: 531)
Completed 200 OK in 34ms (Views: 2.5ms | ActiveRecord: 4.0ms | Allocations: 34863)


Started POST "/api/v1/expense_tracker/user/logout" for 127.0.0.1 at 2022-08-02 16:22:29 +0530
Processing by SessionsController#destroy as JSON
  Parameters: {"session"=>{}}
  Rendering sessions/destroy.jbuilder
  Rendered sessions/destroy.jbuilder (Duration: 0.7ms | Allocations: 178)
Completed 200 OK in 2ms (Views: 1.5ms | ActiveRecord: 0.0ms | Allocations: 1162)


Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:22:34 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b1d4c58 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-806zos.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"59", "description"=>"others"}, "user_id"=>"40"}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 1610)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("User not logged in #{@current_user.email}")
                                                      ^^^^^^):
  
app/controllers/application_controller.rb:15:in `require_user_logged_in!'
Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:23:28 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a3b2c60 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-kh1q9u.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"59", "description"=>"others"}, "user_id"=>"40"}
User not logged in
Completed 401 Unauthorized in 1ms (Views: 0.1ms | Allocations: 838)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 16:23:33 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>101, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
User not logged in
Completed 401 Unauthorized in 0ms (Views: 0.1ms | Allocations: 791)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 16:23:35 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
User not logged in
Completed 401 Unauthorized in 0ms (Views: 0.1ms | Allocations: 690)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 16:23:38 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
User not logged in
Completed 401 Unauthorized in 0ms (Views: 0.1ms | Allocations: 597)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:23:41 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 6], "user_id"=>"39", "report"=>{}}
User not logged in
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 842)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 16:23:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.5ms | Allocations: 177)
Completed 200 OK in 257ms (Views: 1.1ms | ActiveRecord: 0.4ms | Allocations: 5881)


Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:23:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a997810 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-49710-efe65z.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"512", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:26:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 512], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 512], ["status", 0], ["user_id", 40], ["created_at", "2022-08-02 10:53:56.200557"], ["updated_at", "2022-08-02 10:53:56.200557"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 19], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 19], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ijbu8huexo2kovxmc4g0nqgmnxl7"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 10:53:56.207517"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 19], ["blob_id", 6], ["created_at", "2022-08-02 10:53:56.208625"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 10:53:56.209207"], ["id", 19]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: ijbu8huexo2kovxmc4g0nqgmnxl7 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 221)
Completed 200 OK in 28ms (Views: 0.7ms | ActiveRecord: 3.4ms | Allocations: 30908)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:24:25 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:26:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Completed 404 Not Found in 4ms (ActiveRecord: 0.3ms | Allocations: 2796)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=40 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:33:31 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Completed 404 Not Found in 7ms (ActiveRecord: 0.5ms | Allocations: 8063)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=40 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:34:00 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Completed 404 Not Found in 13ms (ActiveRecord: 0.7ms | Allocations: 14244)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=40 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:35:20 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Completed 404 Not Found in 4641ms (ActiveRecord: 3.6ms | Allocations: 26887)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=40 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:39:30 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
Completed 404 Not Found in 35408ms (ActiveRecord: 4.8ms | Allocations: 22323)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=40 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:33:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:40:11 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Completed 500 Internal Server Error in 10618ms (ActiveRecord: 7.7ms | Allocations: 31580)


  
NameError (undefined local variable or method `e' for #<ExpensesController:0x00000000017ac0>

    logger.error("Forbidden request, expense is not in draft version. #{e.inspect}")
                                                                        ^):
  
app/controllers/expenses_controller.rb:36:in `rescue in update'
app/controllers/expenses_controller.rb:27:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:42:04 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Expense not found, expense id 40 for the user 39
Completed 500 Internal Server Error in 1621ms (ActiveRecord: 4.2ms | Allocations: 26676)


  
NoMethodError (undefined method `new' for 400:Integer

    raise CustomError::VALIDATION_ERROR.new('Forbidden, cannot edit expense once it is submitted for approval',
                                       ^^^^
Did you mean?  next):
  
app/controllers/expenses_controller.rb:37:in `rescue in update'
app/controllers/expenses_controller.rb:27:in `update'
Started PATCH "//api/v1/expense_tracker/users/39/expenses/40" for 127.0.0.1 at 2022-08-02 16:45:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"40"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
Expense not found, expense id 40 for the user 39
Completed 403 Forbidden in 2143ms (Views: 1.6ms | ActiveRecord: 3.3ms | Allocations: 26846)


Started PATCH "//api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 16:46:58 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"39", "id"=>"1"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Update (1.7ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 1], ["updated_at", "2022-08-02 11:17:05.651871"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.0ms | Allocations: 333)
Completed 200 OK in 5466ms (Views: 5.9ms | ActiveRecord: 7.8ms | Allocations: 44520)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 16:47:24 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 39.1ms | Allocations: 4221)
Completed 200 OK in 5808ms (Views: 40.5ms | ActiveRecord: 2.2ms | Allocations: 47900)


Started GET "/api/v1/expense_tracker/users/39/expenses/1" for 127.0.0.1 at 2022-08-02 16:47:44 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"39", "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 39], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:13:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 4.5ms | Allocations: 333)
Completed 200 OK in 3996ms (Views: 6.6ms | ActiveRecord: 1.5ms | Allocations: 28993)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:48:00 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 6], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mReport Create (0.8ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:18:02.693841"], ["updated_at", "2022-08-02 11:18:02.693841"]]
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:6:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:25:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 103], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:18:02.731098"], ["report_id", 8], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 104], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:18:02.750974"], ["report_id", 8], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 105], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:18:02.770834"], ["report_id", 8], ["id", 6]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 8]]
  ↳ app/views/reports/create.jbuilder:2
  Rendered reports/create.jbuilder (Duration: 13.7ms | Allocations: 2761)
Completed 200 OK in 2533ms (Views: 16.0ms | ActiveRecord: 9.5ms | Allocations: 23397)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:53:14 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 7], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 876ms (ActiveRecord: 3.2ms | Allocations: 14623)


  
Pundit::NotDefinedError (unable to find policy `NilClassPolicy` for `nil`):
  
app/controllers/concerns/user_authorization.rb:11:in `authorize_active_user'
app/controllers/reports_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:57:39 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5, 7], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 8237ms (ActiveRecord: 0.7ms | Allocations: 31734)


  
Pundit::NotDefinedError (unable to find policy `NilClassPolicy` for `nil`):
  
app/controllers/concerns/user_authorization.rb:11:in `authorize_active_user'
app/controllers/reports_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:58:45 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[3, 4, 5], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 4433ms (ActiveRecord: 0.6ms | Allocations: 27271)


  
Pundit::NotDefinedError (unable to find policy `NilClassPolicy` for `nil`):
  
app/controllers/concerns/user_authorization.rb:11:in `authorize_active_user'
app/controllers/reports_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 16:58:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f58f3f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-3340-we9rh0.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"512", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 512], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
unable to add expense for user 40, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 7937ms (Views: 0.9ms | ActiveRecord: 3.8ms | Allocations: 80296)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 16:59:14 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[3, 4, 5], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 6133ms (ActiveRecord: 0.6ms | Allocations: 27261)


  
Pundit::NotDefinedError (unable to find policy `NilClassPolicy` for `nil`):
  
app/controllers/concerns/user_authorization.rb:11:in `authorize_active_user'
app/controllers/reports_controller.rb:6:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:00:28 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[3, 4, 5], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:30:39.686217"], ["updated_at", "2022-08-02 11:30:39.686217"]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:26:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 103], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:30:39.785272"], ["report_id", 9], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 104], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:30:39.806121"], ["report_id", 9], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 9]]
  ↳ app/views/reports/create.jbuilder:2
  Rendered reports/create.jbuilder (Duration: 12.9ms | Allocations: 2535)
Completed 200 OK in 9228ms (Views: 15.2ms | ActiveRecord: 12.5ms | Allocations: 74070)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:14:21 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[3, 4, 5], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (1.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:44:27.216851"], ["updated_at", "2022-08-02 11:44:27.216851"]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:16:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
expense 4 is already mapped with report 9
expense 5 is already mapped with report 9
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 10]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 10.5ms | Allocations: 2295)
Completed 200 OK in 3570ms (Views: 13.1ms | ActiveRecord: 5.6ms | Allocations: 53707)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:15:10 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 6, 7], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:45:21.163862"], ["updated_at", "2022-08-02 11:45:21.163862"]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:16:in `map_expense_with_report'
expense 5 is already mapped with report 9
expense 6 is already mapped with report 8
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 106], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:45:21.200696"], ["report_id", 11], ["id", 7]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 11]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 7.0ms | Allocations: 944)
Completed 200 OK in 10763ms (Views: 8.7ms | ActiveRecord: 5.6ms | Allocations: 46849)


Started GET "/api/v1/expense_tracker/users/39/expenses" for 127.0.0.1 at 2022-08-02 17:15:32 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"39"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 36.9ms | Allocations: 3486)
Completed 200 OK in 2048ms (Views: 39.3ms | ActiveRecord: 1.7ms | Allocations: 19896)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:15:52 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11, 12, 13], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:45:56.376240"], ["updated_at", "2022-08-02 11:45:56.376240"]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:16:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 503], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:45:56.410913"], ["report_id", 12], ["id", 11]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 504], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:45:56.431124"], ["report_id", 12], ["id", 12]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5011], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 11:45:56.451288"], ["report_id", 12], ["id", 13]]
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:19:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 12]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 10.6ms | Allocations: 1183)
Completed 200 OK in 3513ms (Views: 11.9ms | ActiveRecord: 8.4ms | Allocations: 38728)


Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:16:04 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11, 12, 13], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:46:08.297744"], ["updated_at", "2022-08-02 11:46:08.297744"]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:16:in `map_expense_with_report'
expense 11 is already mapped with report 12
expense 12 is already mapped with report 12
expense 13 is already mapped with report 12
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 5.2ms | Allocations: 775)
Completed 200 OK in 3779ms (Views: 6.6ms | ActiveRecord: 4.0ms | Allocations: 39197)


Started GET "/api/v1/expense_tracker/users/39/reports/1" for 127.0.0.1 at 2022-08-02 17:18:33 +0530
  
AbstractController::ActionNotFound (The action 'show' could not be found for ReportsController):
  
actionpack (7.0.3.1) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.3.1) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.3.1) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.3.1) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.4) lib/rack/tempfile_reaper.rb:15:in `call'
rack (2.2.4) lib/rack/etag.rb:27:in `call'
rack (2.2.4) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.4) lib/rack/head.rb:12:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack (2.2.4) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.4) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/cookies.rb:697:in `call'
activerecord (7.0.3.1) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
web-console (4.2.0) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/show_exceptions.rb:26:in `call'
railties (7.0.3.1) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `block in tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:38:in `tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `tagged'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.4) lib/rack/method_override.rb:24:in `call'
rack (2.2.4) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.3.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/server_timing.rb:20:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.4) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
railties (7.0.3.1) lib/rails/engine.rb:530:in `call'
puma (5.6.4) lib/puma/configuration.rb:252:in `call'
puma (5.6.4) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.4) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.4) lib/puma/request.rb:76:in `handle_request'
puma (5.6.4) lib/puma/server.rb:441:in `process_client'
puma (5.6.4) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:26:19 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11, 12, 13], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (1.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:56:24.004026"], ["updated_at", "2022-08-02 11:56:24.004026"]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:17:in `map_expense_with_report'
expense 11 is already mapped with report 12
Completed 500 Internal Server Error in 2896ms (ActiveRecord: 6.5ms | Allocations: 55593)


  
NoMethodError (undefined method `push' for nil:NilClass

    @already_mapped_expenses.push(expense.id)
                            ^^^^^):
  
app/controllers/reports_controller.rb:29:in `log_mapped_expenses'
app/controllers/reports_controller.rb:22:in `block in map_expense_with_report'
app/controllers/reports_controller.rb:18:in `each'
app/controllers/reports_controller.rb:18:in `map_expense_with_report'
app/controllers/reports_controller.rb:11:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:27:23 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11, 12, 13], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (1.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:57:27.976945"], ["updated_at", "2022-08-02 11:57:27.976945"]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:17:in `map_expense_with_report'
expense 11 is already mapped with report 12
Completed 500 Internal Server Error in 2892ms (ActiveRecord: 6.7ms | Allocations: 60023)


  
NoMethodError (undefined method `push' for nil:NilClass

    @already_mapped_expenses.push(expense.id)
                            ^^^^^):
  
app/controllers/reports_controller.rb:29:in `log_mapped_expenses'
app/controllers/reports_controller.rb:22:in `block in map_expense_with_report'
app/controllers/reports_controller.rb:18:in `each'
app/controllers/reports_controller.rb:18:in `map_expense_with_report'
app/controllers/reports_controller.rb:11:in `create'
Started POST "/api/v1/expense_tracker/users/39/reports" for 127.0.0.1 at 2022-08-02 17:29:17 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11, 12, 13], "user_id"=>"39", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 11:59:21.829649"], ["updated_at", "2022-08-02 11:59:21.829649"]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 39]]
  ↳ app/controllers/reports_controller.rb:18:in `map_expense_with_report'
expense 11 is already mapped with report 12
expense 12 is already mapped with report 12
expense 13 is already mapped with report 12
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 16]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 10.5ms | Allocations: 2359)
Completed 200 OK in 2358ms (Views: 12.9ms | ActiveRecord: 7.5ms | Allocations: 40024)


Started GET "/api/v1/expense_tracker/users/39/reports/1" for 127.0.0.1 at 2022-08-02 17:32:07 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"39", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 3726ms (ActiveRecord: 4.1ms | Allocations: 45776)


  
NoMethodError (undefined method `reports' for #<User id: 39, name: "kasinathan", department: "Engineering", status: "active", email: "kasi@gmail.com", password_digest: [FILTERED], created_at: "2022-08-01 16:34:58.014011000 +0000", updated_at: "2022-08-01 16:39:52.877165000 +0000">):
  
app/controllers/reports_controller.rb:17:in `show'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddReferencesToReports (20220802120753)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "areports" ("id" integer NOT NULL PRIMARY KEY, "status" integer DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "areports" ("id","status","created_at","updated_at")
                     SELECT "id","status","created_at","updated_at" FROM "reports"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "reports"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "reports" ("id" integer NOT NULL PRIMARY KEY, "status" integer DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "reports" ("id","status","created_at","updated_at")
                     SELECT "id","status","created_at","updated_at" FROM "areports"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "areports"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_reports_on_user_id" ON "reports" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "areports" ("id" integer NOT NULL PRIMARY KEY, "status" integer DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE INDEX "tindex_areports_on_user_id" ON "areports" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "areports" ("id","status","created_at","updated_at","user_id")
                     SELECT "id","status","created_at","updated_at","user_id" FROM "reports"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "reports"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "reports" ("id" integer NOT NULL PRIMARY KEY, "status" integer DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL, CONSTRAINT "fk_rails_c7699d537d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_reports_on_user_id" ON "reports" ("user_id")[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "reports" ("id","status","created_at","updated_at","user_id")
                     SELECT "id","status","created_at","updated_at","user_id" FROM "areports"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "areports"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220802120753"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-02 17:38:56 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000114935098>, params: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasinathan@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-02 12:09:00.195607"], ["updated_at", "2022-08-02 12:09:00.195607"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.5ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 41], ["created_at", "2022-08-02 12:09:07.569947"], ["updated_at", "2022-08-02 12:09:07.569947"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.4ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 41], ["created_at", "2022-08-02 12:09:07.584761"], ["updated_at", "2022-08-02 12:09:07.584761"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 41]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 19.8ms | Allocations: 2189)
Completed 201 Created in 8354ms (Views: 23.0ms | ActiveRecord: 6.3ms | Allocations: 29607)


Started POST "/api/v1/expense_tracker/user/login?email=kasinathan@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 17:39:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasinathan@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 2.0ms | Allocations: 177)
Completed 200 OK in 264ms (Views: 4.6ms | ActiveRecord: 0.4ms | Allocations: 1992)


Started POST "/api/v1/expense_tracker/user/logout" for 127.0.0.1 at 2022-08-02 17:39:44 +0530
Processing by SessionsController#destroy as JSON
  Parameters: {"session"=>{}}
  Rendering sessions/destroy.jbuilder
  Rendered sessions/destroy.jbuilder (Duration: 1.4ms | Allocations: 135)
Completed 200 OK in 5ms (Views: 2.9ms | ActiveRecord: 0.0ms | Allocations: 780)


Started POST "/api/v1/expense_tracker/user/login?email=kasinathan@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-02 17:39:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasinathan@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.5ms | Allocations: 44)
Completed 200 OK in 260ms (Views: 2.3ms | ActiveRecord: 0.3ms | Allocations: 1128)


Started POST "/api/v1/expense_tracker/users/40/expenses" for 127.0.0.1 at 2022-08-02 17:40:04 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107d03d08 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-46458-urv0p.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"100", "description"=>"others"}, "user_id"=>"40"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 3086ms (ActiveRecord: 1.2ms | Allocations: 15067)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=40):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:17:in `create'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-02 17:41:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001073b70d8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-46458-b0zs45.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"100", "description"=>"others"}, "user_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 2238ms (ActiveRecord: 1.1ms | Allocations: 14478)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:17:in `create'
Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 17:41:43 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000114bd6dd8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-46458-zc9i5w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"100", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 100], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Create (0.7ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 100], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 12:11:48.965255"], ["updated_at", "2022-08-02 12:11:48.965255"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "z546kspwkw1dxaml2jhm4d4f1oua"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 12:11:49.034459"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 7], ["created_at", "2022-08-02 12:11:49.043375"]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 12:11:49.051107"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: z546kspwkw1dxaml2jhm4d4f1oua (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:19:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 6.0ms | Allocations: 324)
Completed 200 OK in 6541ms (Views: 11.8ms | ActiveRecord: 8.1ms | Allocations: 92942)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 17:42:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"41", "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 1], ["updated_at", "2022-08-02 12:12:41.643426"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.0ms | Allocations: 269)
Completed 200 OK in 3001ms (Views: 4.6ms | ActiveRecord: 3.7ms | Allocations: 34078)


Started GET "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 17:43:01 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"41"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 41]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 15.1ms | Allocations: 1893)
Completed 200 OK in 2996ms (Views: 16.9ms | ActiveRecord: 1.6ms | Allocations: 29764)


Started GET "/api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 17:43:19 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"41", "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:13:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 3.8ms | Allocations: 316)
Completed 200 OK in 3179ms (Views: 6.0ms | ActiveRecord: 1.4ms | Allocations: 28878)


Started POST "/api/v1/expense_tracker/users/41/reports" for 127.0.0.1 at 2022-08-02 17:43:51 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1], "user_id"=>"41", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (1.8ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 12:13:55.139104"], ["updated_at", "2022-08-02 12:13:55.139104"]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
Completed 500 Internal Server Error in 3392ms (ActiveRecord: 4.0ms | Allocations: 33030)


  
ActiveRecord::NotNullViolation (SQLite3::ConstraintException: NOT NULL constraint failed: reports.user_id):
  
app/controllers/reports_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/users/41/reports" for 127.0.0.1 at 2022-08-02 17:45:59 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1], "user_id"=>"41", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 4819ms (ActiveRecord: 3.3ms | Allocations: 47743)


  
NameError (undefined local variable or method `user' for #<ReportsController:0x00000000025648>

    @report = user.reports.create(status: 'drafted')
              ^^^^
Did you mean?  @user):
  
app/controllers/reports_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/users/41/reports" for 127.0.0.1 at 2022-08-02 17:46:30 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1], "user_id"=>"41", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 10121ms (ActiveRecord: 4.1ms | Allocations: 55841)


  
NoMethodError (undefined method `reports' for #<User id: 41, name: "kasinathan", department: "Engineering", status: "active", email: "kasinathan@gmail.com", password_digest: [FILTERED], created_at: "2022-08-02 12:09:00.195607000 +0000", updated_at: "2022-08-02 12:09:00.195607000 +0000">):
  
app/controllers/reports_controller.rb:10:in `create'
Started POST "/api/v1/expense_tracker/users/41/reports" for 127.0.0.1 at 2022-08-02 17:47:24 +0530
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1], "user_id"=>"41", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-02 12:17:31.030376"], ["updated_at", "2022-08-02 12:17:31.030376"], ["user_id", 41]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 41]]
  ↳ app/controllers/reports_controller.rb:25:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 12:17:34.335469"], ["report_id", 1], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 13.0ms | Allocations: 2726)
Completed 200 OK in 7989ms (Views: 17.4ms | ActiveRecord: 7.7ms | Allocations: 85523)


Started GET "/api/v1/expense_tracker/users/39/reports/1" for 127.0.0.1 at 2022-08-02 17:48:56 +0530
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"39", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 426ms (ActiveRecord: 3.2ms | Allocations: 8328)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=39):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/41/reports/1" for 127.0.0.1 at 2022-08-02 17:49:06 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"41", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  Rendered reports/show.jbuilder (Duration: 2.6ms | Allocations: 305)
Completed 200 OK in 4327ms (Views: 5.4ms | ActiveRecord: 2.5ms | Allocations: 44397)


Started GET "/api/v1/expense_tracker/users/41/reports/1" for 127.0.0.1 at 2022-08-02 17:50:18 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"41", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 1], ["LIMIT", 11]]
  ↳ app/views/reports/show.jbuilder:1
  Rendered reports/show.jbuilder (Duration: 91.5ms | Allocations: 16543)
Completed 500 Internal Server Error in 2418ms (ActiveRecord: 2.6ms | Allocations: 36438)


  
ActionView::Template::Error (#<ActiveRecord::Associations::CollectionProxy [#<Expense id: 1, description: "Domestic travel", amount: 1, date: nil, invoice_number: 100, status: "drafted", user_id: 41, created_at: "2022-08-02 12:11:48.965255000 +0000", updated_at: "2022-08-02 12:17:34.335469000 +0000", report_id: 1>]> is not a symbol nor a string):
    1: json.report(@report, @report.expenses)
  
app/views/reports/show.jbuilder:1
Started GET "/api/v1/expense_tracker/users/41/reports/1" for 127.0.0.1 at 2022-08-02 17:51:31 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"41", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 15.1ms | Allocations: 1986)
Completed 200 OK in 2440ms (Views: 18.2ms | ActiveRecord: 2.6ms | Allocations: 21998)


Started GET "/api/v1/expense_tracker/users/41/reports/1" for 127.0.0.1 at 2022-08-02 17:51:51 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"41", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 8.6ms | Allocations: 1158)
Completed 200 OK in 2733ms (Views: 11.4ms | ActiveRecord: 1.3ms | Allocations: 25608)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 17:57:38 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel"}, "user_id"=>"41", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.8ms | Allocations: 521)
Completed 200 OK in 29ms (Views: 2.6ms | ActiveRecord: 1.1ms | Allocations: 24782)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 17:57:59 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010a3b73a0>, params: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"41", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 256)
Completed 200 OK in 5ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 5959)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 18:03:10 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 100], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-02 12:33:10.812499"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 177)
Completed 200 OK in 15ms (Views: 0.8ms | ActiveRecord: 1.8ms | Allocations: 16492)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 18:03:53 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.2ms | Allocations: 4935)


  
NoMethodError (undefined method `new' for 400:Integer

    raise CustomError::VALIDATION_ERROR.new('Forbidden, cannot edit expense once it is submitted for approval',
                                       ^^^^
Did you mean?  next):
  
app/controllers/expenses_controller.rb:51:in `rescue in authorize_expense_status'
app/controllers/expenses_controller.rb:47:in `authorize_expense_status'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 18:04:40 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 13ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 12540)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 19:06:36 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:63: syntax error, unexpected end-of-input, expecting `end'):
  
app/controllers/expenses_controller.rb:63: syntax error, unexpected end-of-input, expecting `end'
app/controllers/expenses_controller.rb:63: syntax error, unexpected end-of-input, expecting `end'
app/controllers/expenses_controller.rb:63: syntax error, unexpected end-of-input, expecting `end'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/1" for 127.0.0.1 at 2022-08-02 19:07:09 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>1, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 24ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 20411)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:07:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a75ddd8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-92754-nbyo4i.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 101], ["date", nil], ["invoice_number", 101], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 13:37:32.259918"], ["updated_at", "2022-08-02 13:37:32.259918"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "xczpi2uiouifqped0oa5q5qqx0vw"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 13:37:32.271264"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 8], ["created_at", "2022-08-02 13:37:32.272328"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 13:37:32.273046"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: xczpi2uiouifqped0oa5q5qqx0vw (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 363)
Completed 200 OK in 35ms (Views: 1.3ms | ActiveRecord: 2.7ms | Allocations: 35724)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/2" for 127.0.0.1 at 2022-08-02 19:07:53 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1736ms (ActiveRecord: 0.2ms | Allocations: 13750)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:43:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/2" for 127.0.0.1 at 2022-08-02 19:11:13 +0530
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:44: syntax error, unexpected local variable or method, expecting ')'
      p "response"
      ^
):
  
app/controllers/expenses_controller.rb:44: syntax error, unexpected local variable or method, expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected local variable or method, expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected local variable or method, expecting ')'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/2" for 127.0.0.1 at 2022-08-02 19:11:45 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 2135ms (ActiveRecord: 0.8ms | Allocations: 14241)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:43:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started GET "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:19:08 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"41"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 41]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 3.2ms | Allocations: 2187)
Completed 200 OK in 17ms (Views: 4.0ms | ActiveRecord: 1.0ms | Allocations: 7567)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/2" for 127.0.0.1 at 2022-08-02 19:19:46 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1129ms (ActiveRecord: 0.8ms | Allocations: 16335)


  
NameError (undefined local variable or method `responseex' for #<ExpensesController:0x00000000039fa8>

      p responseex
        ^^^^^^^^^^
Did you mean?  response
               response=
               @_response):
  
app/controllers/expenses_controller.rb:46:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/2" for 127.0.0.1 at 2022-08-02 19:20:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 13:50:39.187990"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.6ms | Allocations: 269)
Completed 200 OK in 491ms (Views: 2.8ms | ActiveRecord: 3.8ms | Allocations: 17339)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:23:31 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"102", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010cf7d0c0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-92754-wirh23.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"102", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 102], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 102], ["date", nil], ["invoice_number", 102], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 13:53:31.367872"], ["updated_at", "2022-08-02 13:53:31.367872"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ntq9ds1ijspg9u138keeqzh9v17x"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 13:53:31.376149"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 9], ["created_at", "2022-08-02 13:53:31.377575"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 13:53:31.378485"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: ntq9ds1ijspg9u138keeqzh9v17x (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 223)
Completed 200 OK in 48ms (Views: 1.1ms | ActiveRecord: 3.9ms | Allocations: 38140)


Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:23:49 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1843ms (ActiveRecord: 0.3ms | Allocations: 5352)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:24:40 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1844ms (ActiveRecord: 0.8ms | Allocations: 14230)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:28:02 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1867ms (ActiveRecord: 0.9ms | Allocations: 14224)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:28:42 +0530
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
...om/invoices.json?key=b490bb80', { invoice_id: '2' } )
...                              ^
/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
...=b490bb80', { invoice_id: '2' } )
...                              ^
):
  
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:28:44 +0530
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
...om/invoices.json?key=b490bb80', { invoice_id: '2' } )
...                              ^
/Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
...=b490bb80', { invoice_id: '2' } )
...                              ^
):
  
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
app/controllers/expenses_controller.rb:44: syntax error, unexpected ',', expecting ')'
app/controllers/expenses_controller.rb:44: syntax error, unexpected '}', expecting `end'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:29:45 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1973ms (ActiveRecord: 1.1ms | Allocations: 14245)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:36:28 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (4.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1784ms (ActiveRecord: 4.5ms | Allocations: 13174)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "//api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:37:20 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 102], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 14:07:22.647328"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 178)
Completed 200 OK in 1817ms (Views: 1.5ms | ActiveRecord: 3.2ms | Allocations: 18094)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/3" for 127.0.0.1 at 2022-08-02 19:42:48 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"3"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 11ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 11462)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:43:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010cd8eb10 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-92754-5otlar.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"103", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 103], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 103], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 14:13:00.569310"], ["updated_at", "2022-08-02 14:13:00.569310"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6k3155f09wu2eymw98sks3tbpc6q"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 14:13:00.587343"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 10], ["created_at", "2022-08-02 14:13:00.588645"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 14:13:00.589398"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 6k3155f09wu2eymw98sks3tbpc6q (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 220)
Completed 200 OK in 43ms (Views: 1.3ms | ActiveRecord: 3.2ms | Allocations: 26851)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/4" for 127.0.0.1 at 2022-08-02 19:43:09 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 103], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 14:13:11.846813"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 135)
Completed 200 OK in 1960ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 8060)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:44:29 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010c464ee0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-92754-n8eif.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"104", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 104], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 104], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 14:14:29.445218"], ["updated_at", "2022-08-02 14:14:29.445218"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vkzoqkpci0nj7kx46kusv89usoke"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 14:14:29.451999"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 11], ["created_at", "2022-08-02 14:14:29.453452"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 14:14:29.454335"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: vkzoqkpci0nj7kx46kusv89usoke (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 222)
Completed 200 OK in 41ms (Views: 0.8ms | ActiveRecord: 5.7ms | Allocations: 38127)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/5" for 127.0.0.1 at 2022-08-02 19:44:36 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"5"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 104], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 14:14:38.556007"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 160)
Completed 200 OK in 1811ms (Views: 0.8ms | ActiveRecord: 2.7ms | Allocations: 8523)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:45:10 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b15f390 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-92754-kng1kv.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"105", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 105], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 105], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 14:15:10.823877"], ["updated_at", "2022-08-02 14:15:10.823877"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ntthgn52hcm6eafbqgeherqo7l6l"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 14:15:10.831942"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 12], ["created_at", "2022-08-02 14:15:10.833080"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 14:15:10.833798"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: ntthgn52hcm6eafbqgeherqo7l6l (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 222)
Completed 200 OK in 36ms (Views: 0.8ms | ActiveRecord: 3.6ms | Allocations: 38179)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/6" for 127.0.0.1 at 2022-08-02 19:45:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 105], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (1.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 14:15:19.726847"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 160)
Completed 200 OK in 1830ms (Views: 0.9ms | ActiveRecord: 3.2ms | Allocations: 8523)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:46:11 +0530
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b2b5dc0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-86766-6j7vbh.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"106", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 106], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.9ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 106], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 14:16:16.112999"], ["updated_at", "2022-08-02 14:16:16.112999"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.8ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vhdkuqvhbbe3rcv3p6z9cuif36w1"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 14:16:17.071963"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 13], ["created_at", "2022-08-02 14:16:17.092795"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 14:16:17.111637"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: vhdkuqvhbbe3rcv3p6z9cuif36w1 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 13]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 5.4ms | Allocations: 538)
Completed 200 OK in 5677ms (Views: 13.7ms | ActiveRecord: 12.2ms | Allocations: 89501)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/7" for 127.0.0.1 at 2022-08-02 19:46:28 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"7"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 106], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 14:17:36.109458"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.6ms | Allocations: 286)
Completed 200 OK in 67638ms (Views: 5.7ms | ActiveRecord: 4.2ms | Allocations: 57087)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 19:47:51 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010c856dc8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-86766-utm2y6.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"107", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 107], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 107], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 14:17:57.171764"], ["updated_at", "2022-08-02 14:17:57.171764"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "1k36386btbwfg37f6q9gz1p77beh"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 14:17:57.263082"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 14], ["created_at", "2022-08-02 14:17:57.280525"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 14:17:57.294751"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 1k36386btbwfg37f6q9gz1p77beh (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 4.8ms | Allocations: 331)
Completed 200 OK in 4918ms (Views: 9.7ms | ActiveRecord: 11.7ms | Allocations: 89025)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/7" for 127.0.0.1 at 2022-08-02 19:48:03 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"7"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 18046ms (Views: 1.5ms | ActiveRecord: 2.0ms | Allocations: 35670)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/8" for 127.0.0.1 at 2022-08-02 19:48:27 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"8"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 107], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:04:19.599486"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.2ms | Allocations: 161)
Completed 200 OK in 9952309ms (Views: 8.4ms | ActiveRecord: 4.6ms | Allocations: 57081)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 22:37:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b6c4a60 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-86766-bw7jhd.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"108", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 108], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 108], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:07:17.415794"], ["updated_at", "2022-08-02 17:07:17.415794"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "3sqhpip5uqojbnotmx2i2883mmtn"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:07:17.508172"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 9], ["blob_id", 15], ["created_at", "2022-08-02 17:07:17.524925"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:07:17.538451"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 3sqhpip5uqojbnotmx2i2883mmtn (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 15]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 4.8ms | Allocations: 222)
Completed 200 OK in 10125ms (Views: 12.5ms | ActiveRecord: 12.1ms | Allocations: 88752)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/9" for 127.0.0.1 at 2022-08-02 22:37:29 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"9"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Started PATCH "/api/v1/expense_tracker/users/41/expenses/9" for 127.0.0.1 at 2022-08-02 22:39:53 +0530
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"9"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 108], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:11:06.512875"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.4ms | Allocations: 520)
Completed 200 OK in 69484ms (Views: 8.5ms | ActiveRecord: 7.2ms | Allocations: 93370)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/9" for 127.0.0.1 at 2022-08-02 22:41:19 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"9"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 4485ms (Views: 1.5ms | ActiveRecord: 5.0ms | Allocations: 44405)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 22:41:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010fa07728 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-1448-2uyddg.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"109", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 109], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (1.0ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 109], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:11:47.449501"], ["updated_at", "2022-08-02 17:11:47.449501"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "onqy4hzffxoeqhjvra64tzbs7uam"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:11:47.551906"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 10], ["blob_id", 16], ["created_at", "2022-08-02 17:11:47.568126"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:11:48.171159"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: onqy4hzffxoeqhjvra64tzbs7uam (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 16]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.8ms | Allocations: 480)
Completed 200 OK in 15507ms (Views: 8.5ms | ActiveRecord: 10.2ms | Allocations: 122337)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/10" for 127.0.0.1 at 2022-08-02 22:41:56 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"10"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 109], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:12:25.128776"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.6ms | Allocations: 263)
Completed 200 OK in 28286ms (Views: 4.5ms | ActiveRecord: 4.9ms | Allocations: 55204)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 22:43:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010ebdf1f0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-1448-zzgpne.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1110", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1110], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 1110], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:14:05.028618"], ["updated_at", "2022-08-02 17:14:05.028618"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "oqu0f6b2i7eu1krv2r6dheedt8h4"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:14:05.118085"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 11], ["blob_id", 17], ["created_at", "2022-08-02 17:14:05.133926"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:14:05.146783"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: oqu0f6b2i7eu1krv2r6dheedt8h4 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 17]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.4ms | Allocations: 223)
Completed 200 OK in 6219ms (Views: 8.9ms | ActiveRecord: 11.9ms | Allocations: 88801)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/11" for 127.0.0.1 at 2022-08-02 22:44:14 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"11"}
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1110], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (1.3ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:16:01.045853"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.9ms | Allocations: 160)
Completed 200 OK in 106330ms (Views: 4.0ms | ActiveRecord: 6.2ms | Allocations: 53564)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 22:46:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000118b4cc88 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-1448-ii3s18.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1111", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1111], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 1111], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:16:32.150498"], ["updated_at", "2022-08-02 17:16:32.150498"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "2gp3nal0yftyztc08ker4qjqsx0o"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:16:32.242875"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 12], ["blob_id", 18], ["created_at", "2022-08-02 17:16:32.259277"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:16:32.273188"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 2gp3nal0yftyztc08ker4qjqsx0o (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.5ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 18]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 4.7ms | Allocations: 222)
Completed 200 OK in 4898ms (Views: 12.3ms | ActiveRecord: 11.6ms | Allocations: 70731)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/11" for 127.0.0.1 at 2022-08-02 22:46:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"11"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 6402ms (Views: 1.6ms | ActiveRecord: 1.9ms | Allocations: 35480)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/12" for 127.0.0.1 at 2022-08-02 22:46:47 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"12"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1111], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (2.1ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:17:02.420321"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.0ms | Allocations: 160)
Completed 200 OK in 14593ms (Views: 4.1ms | ActiveRecord: 5.5ms | Allocations: 48438)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 23:09:56 +0530
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107816188 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-63589-a4rptt.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"112", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 112], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (1.1ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 112], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:40:00.172201"], ["updated_at", "2022-08-02 17:40:00.172201"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "t88uy6zk64x86m6w97328oymscn6"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:40:00.270183"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 13], ["blob_id", 19], ["created_at", "2022-08-02 17:40:00.287296"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:40:00.300211"], ["id", 13]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: t88uy6zk64x86m6w97328oymscn6 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 19]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 5.8ms | Allocations: 538)
Completed 200 OK in 4286ms (Views: 15.5ms | ActiveRecord: 11.4ms | Allocations: 79892)


Started PATCH "/api/v1/expense_tracker/users/41/expenses/13" for 127.0.0.1 at 2022-08-02 23:10:12 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"13"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 23101ms (ActiveRecord: 2.1ms | Allocations: 59386)


  
NoMethodError (undefined method `status' for {"id"=>1, "biller name"=>"Blogtags", "status"=>false}:Hash

      if json.status
             ^^^^^^^):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 23:11:31 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001078650a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-63589-lowgvn.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"113", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 113], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.7ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 113], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:41:37.124550"], ["updated_at", "2022-08-02 17:41:37.124550"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "hm1orftnqpjt8scr7g0h3uhqm5yg"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:41:37.230069"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 14], ["blob_id", 20], ["created_at", "2022-08-02 17:41:37.246664"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:41:37.260292"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: hm1orftnqpjt8scr7g0h3uhqm5yg (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 5b23d322-0642-4e65-a89e-c953a845d59a) to Async(default) with arguments: #<GlobalID:0x0000000110336c40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/1>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 20]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 6.3ms | Allocations: 331)
Completed 200 OK in 4906ms (Views: 23.8ms | ActiveRecord: 14.4ms | Allocations: 83927)


[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a] Performing ActiveStorage::PurgeJob (Job ID: 5b23d322-0642-4e65-a89e-c953a845d59a) from Async(default) enqueued at 2022-08-02T17:41:37Z with arguments: #<GlobalID:0x0000000106ea7048 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/1>>
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mActiveStorage::Attachment Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mActiveStorage::VariantRecord Load (0.5ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mActiveStorage::Blob Destroy (0.4ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: 118aqtu8hv5z2pljvt6f1yfbtzov[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b23d322-0642-4e65-a89e-c953a845d59a] Performed ActiveStorage::PurgeJob (Job ID: 5b23d322-0642-4e65-a89e-c953a845d59a) from Async(default) in 195.04ms
Started PATCH "/api/v1/expense_tracker/users/41/expenses/14" for 127.0.0.1 at 2022-08-02 23:11:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"14"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 11094ms (ActiveRecord: 4.6ms | Allocations: 60881)


  
NoMethodError (undefined method `status' for {"id"=>1, "biller name"=>"Buzzdog", "status"=>false}:Hash

      if json.status
             ^^^^^^^):
  
app/controllers/expenses_controller.rb:44:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/41/expenses/14" for 127.0.0.1 at 2022-08-02 23:13:01 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"14"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 113], ["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 1], ["updated_at", "2022-08-02 17:43:14.332082"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.1ms | Allocations: 287)
Completed 200 OK in 11211ms (Views: 6.5ms | ActiveRecord: 8.3ms | Allocations: 58320)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-02 23:13:59 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107e2cdb0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220802-63589-8414wm.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"114", "description"=>"others"}, "user_id"=>"41"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 114], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.7ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 114], ["status", 0], ["user_id", 41], ["created_at", "2022-08-02 17:44:03.540929"], ["updated_at", "2022-08-02 17:44:03.540929"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.8ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 2]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "5jz21phd1gzetb87e54u1ky3yzuy"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-02 17:44:04.305256"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 15], ["blob_id", 21], ["created_at", "2022-08-02 17:44:04.328172"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-02 17:44:04.347631"], ["id", 15]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 5jz21phd1gzetb87e54u1ky3yzuy (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 6ce8295e-05bb-4d78-a678-0170b1d68140) to Async(default) with arguments: #<GlobalID:0x000000010795f580 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/2>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 21]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.5ms | Allocations: 222)
Completed 200 OK in 3080ms (Views: 8.7ms | ActiveRecord: 16.9ms | Allocations: 62498)


[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140] Performing ActiveStorage::PurgeJob (Job ID: 6ce8295e-05bb-4d78-a678-0170b1d68140) from Async(default) enqueued at 2022-08-02T17:44:04Z with arguments: #<GlobalID:0x0000000107b45d68 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/2>>
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mActiveStorage::Attachment Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 2], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mActiveStorage::VariantRecord Load (0.6ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mActiveStorage::Blob Destroy (0.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 2]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140]   [1m[36mTRANSACTION (15.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140] [36m  Disk Storage (1.4ms) [0m[31mDeleted file from key: 025t5nzgglvhi13b5stsd716k39r[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce8295e-05bb-4d78-a678-0170b1d68140] Performed ActiveStorage::PurgeJob (Job ID: 6ce8295e-05bb-4d78-a678-0170b1d68140) from Async(default) in 205.57ms
Started PATCH "/api/v1/expense_tracker/users/41/expenses/15" for 127.0.0.1 at 2022-08-02 23:14:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"15"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 44210ms (ActiveRecord: 1.9ms | Allocations: 77337)


  
NoMethodError (undefined method `staus=' for #<Expense id: 15, description: "others", amount: 99, date: nil, invoice_number: 114, status: "drafted", user_id: 41, created_at: "2022-08-02 17:44:03.540929000 +0000", updated_at: "2022-08-02 17:44:04.347631000 +0000", report_id: nil>
Did you mean?  status=
               status
               status?):
  
app/controllers/expenses_controller.rb:45:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/41/expenses/15" for 127.0.0.1 at 2022-08-02 23:16:35 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"15"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 18970ms (ActiveRecord: 6.3ms | Allocations: 71938)


  
NoMethodError (undefined method `staus=' for #<Expense id: 15, description: "others", amount: 99, date: nil, invoice_number: 114, status: "drafted", user_id: 41, created_at: "2022-08-02 17:44:03.540929000 +0000", updated_at: "2022-08-02 17:44:04.347631000 +0000", report_id: nil>
Did you mean?  status=
               status
               status?):
  
app/controllers/expenses_controller.rb:45:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/41/expenses/15" for 127.0.0.1 at 2022-08-02 23:17:26 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"15"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1545ms (ActiveRecord: 0.8ms | Allocations: 27952)


  
NoMethodError (undefined method `staus=' for #<Expense id: 15, description: "others", amount: 99, date: nil, invoice_number: 114, status: "drafted", user_id: 41, created_at: "2022-08-02 17:44:03.540929000 +0000", updated_at: "2022-08-02 17:44:04.347631000 +0000", report_id: nil>
Did you mean?  status=
               status
               status?):
  
app/controllers/expenses_controller.rb:45:in `expense_pre_processing'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/41/expenses/15" for 127.0.0.1 at 2022-08-02 23:19:27 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"41", "id"=>"15"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 41], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 114], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 2], ["updated_at", "2022-08-02 17:49:29.031114"], ["id", 15]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.2ms | Allocations: 353)
Completed 200 OK in 1686ms (Views: 2.4ms | ActiveRecord: 2.6ms | Allocations: 19515)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvoiceValidators (20220802175620)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "invoice_validators" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "biller" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_be9acc5f61"
FOREIGN KEY ("invoice_number")
  REFERENCES "expenses" ("id")
)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvoiceValidators (20220802175620)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "invoice_validators" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "biller" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_be9acc5f61"
FOREIGN KEY ("invoice_number")
  REFERENCES "expenses" ("id")
)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvoiceValidators (20220802175620)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "invoice_validators" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "biller" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_be9acc5f61"
FOREIGN KEY ("invoice_number")
  REFERENCES "expenses" ("id")
)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvoiceValidators (20220802175620)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "invoice_validators" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "biller" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_be9acc5f61"
FOREIGN KEY ("invoice_number")
  REFERENCES "expenses" ("id")
)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddUniqueInvoiceInExpense (20220803013801)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_expenses_on_invoice_number" ON "expenses" ("invoice_number")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220803013801"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvoices (20220803014624)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "invoices" ("invoice_number" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "biller" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220803014624"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddReferencesInvoice (20220803015251)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "ainvoices" ("invoice_number" integer NOT NULL PRIMARY KEY, "biller" varchar DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "ainvoices" ("invoice_number","biller","created_at","updated_at")
                     SELECT "invoice_number","biller","created_at","updated_at" FROM "invoices"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "invoices"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "invoices" ("invoice_number" integer NOT NULL PRIMARY KEY, "biller" varchar DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c2e4ad1b1c"
FOREIGN KEY ("invoice_number")
  REFERENCES "expenses" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number","biller","created_at","updated_at")
                     SELECT "invoice_number","biller","created_at","updated_at" FROM "ainvoices"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "ainvoices"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220803015251"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddReferencesInvoice (20220803015251)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "ainvoices" ("invoice_number" integer NOT NULL PRIMARY KEY, "biller" varchar DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[32mINSERT INTO "ainvoices" ("invoice_number","biller","created_at","updated_at")
                     SELECT "invoice_number","biller","created_at","updated_at" FROM "invoices"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "invoices"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "invoices" ("invoice_number" integer NOT NULL PRIMARY KEY, "biller" varchar DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number","biller","created_at","updated_at")
                     SELECT "invoice_number","biller","created_at","updated_at" FROM "ainvoices"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "ainvoices"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Delete All (0.1ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = ?[0m  [["version", "20220803015251"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-03 07:32:28 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mCACHE ActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate RAILS_ENV=development

You have 1 pending migration:

20220803015251_add_references_invoice.rb


):
  
activerecord (7.0.3.1) lib/active_record/migration.rb:627:in `check_pending!'
activerecord (7.0.3.1) lib/active_record/migration.rb:592:in `block (2 levels) in call'
activesupport (7.0.3.1) lib/active_support/file_update_checker.rb:83:in `execute'
activerecord (7.0.3.1) lib/active_record/migration.rb:597:in `block in call'
activerecord (7.0.3.1) lib/active_record/migration.rb:589:in `synchronize'
activerecord (7.0.3.1) lib/active_record/migration.rb:589:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
web-console (4.2.0) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/show_exceptions.rb:26:in `call'
railties (7.0.3.1) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `block in tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:38:in `tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `tagged'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.4) lib/rack/method_override.rb:24:in `call'
rack (2.2.4) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.3.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/server_timing.rb:20:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.4) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
railties (7.0.3.1) lib/rails/engine.rb:530:in `call'
puma (5.6.4) lib/puma/configuration.rb:252:in `call'
puma (5.6.4) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.4) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.4) lib/puma/request.rb:76:in `handle_request'
puma (5.6.4) lib/puma/server.rb:441:in `process_client'
puma (5.6.4) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-03 07:33:13 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001161d7628 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-84731-ubh71w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"115", "description"=>"others"}, "user_id"=>"41"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 404 Not Found in 8ms (ActiveRecord: 0.4ms | Allocations: 7408)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=41):
  
app/controllers/application_controller.rb:10:in `current_user'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 07:33:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001162c7fb0>, params: {"user"=>{"email"=>"kasinathan@gmail.com", "name"=>"kasinathan", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasinathan"], ["department", "Engineering"], ["status", 1], ["email", "kasinathan@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 02:03:29.786345"], ["updated_at", "2022-08-03 02:03:29.786345"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 42], ["created_at", "2022-08-03 02:03:29.801571"], ["updated_at", "2022-08-03 02:03:29.801571"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 42], ["created_at", "2022-08-03 02:03:29.804622"], ["updated_at", "2022-08-03 02:03:29.804622"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 42]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 2.6ms | Allocations: 2299)
Completed 201 Created in 279ms (Views: 3.5ms | ActiveRecord: 3.8ms | Allocations: 21810)


Started POST "/api/v1/expense_tracker/user/login?email=kasinathan@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 07:34:03 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasinathan@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasinathan@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.1ms | Allocations: 178)
Completed 200 OK in 255ms (Views: 1.6ms | ActiveRecord: 0.1ms | Allocations: 1986)


Started POST "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 07:34:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116d9c2d8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-84731-yx1sld.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"115", "description"=>"others"}, "user_id"=>"42"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 115], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 115], ["status", 0], ["user_id", 42], ["created_at", "2022-08-03 02:04:14.054166"], ["updated_at", "2022-08-03 02:04:14.054166"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 7]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "erdggnphg63qk8i5gka3xkho7zyh"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 02:04:14.065448"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 22], ["created_at", "2022-08-03 02:04:14.066359"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 02:04:14.066974"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: erdggnphg63qk8i5gka3xkho7zyh (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb) to Async(default) with arguments: #<GlobalID:0x000000011545db28 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/7>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 22]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 345)
Completed 200 OK in 46ms (Views: 1.2ms | ActiveRecord: 2.8ms | Allocations: 45657)


[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 7], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb] Performing ActiveStorage::PurgeJob (Job ID: ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb) from Async(default) enqueued at 2022-08-03T02:04:14Z with arguments: #<GlobalID:0x000000011571d430 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/7>>
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 7], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 7]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 7]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: z546kspwkw1dxaml2jhm4d4f1oua[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb] Performed ActiveStorage::PurgeJob (Job ID: ed5a8b45-7f60-4b99-8ffc-a965c0b89eeb) from Async(default) in 29.58ms
Started PATCH "/api/v1/expense_tracker/users/42/expenses/16" for 127.0.0.1 at 2022-08-03 07:34:27 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"16"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
Completed 404 Not Found in 2ms (ActiveRecord: 0.2ms | Allocations: 2672)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=16 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/42/expenses/1" for 127.0.0.1 at 2022-08-03 07:34:43 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 115], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 4], ["updated_at", "2022-08-03 02:04:45.526697"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.5ms | Allocations: 274)
Completed 200 OK in 1824ms (Views: 2.0ms | ActiveRecord: 2.3ms | Allocations: 16315)


Started POST "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 07:35:25 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001125e7078 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-84731-rzrkv1.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"116", "description"=>"others"}, "user_id"=>"42"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 116], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 116], ["status", 0], ["user_id", 42], ["created_at", "2022-08-03 02:05:25.355122"], ["updated_at", "2022-08-03 02:05:25.355122"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 8]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "3gqmvtben3qxw60tyk975tlhkj9q"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 02:05:25.359355"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 23], ["created_at", "2022-08-03 02:05:25.360311"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 02:05:25.360796"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: 3gqmvtben3qxw60tyk975tlhkj9q (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6) to Async(default) with arguments: #<GlobalID:0x000000011536c020 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/8>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 23]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 139)
Completed 200 OK in 16ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 15558)


[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 8], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6] Performing ActiveStorage::PurgeJob (Job ID: c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6) from Async(default) enqueued at 2022-08-03T02:05:25Z with arguments: #<GlobalID:0x00000001154950c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/8>>
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mActiveStorage::Attachment Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 8], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 8]]
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 8]]
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: xczpi2uiouifqped0oa5q5qqx0vw[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6] Performed ActiveStorage::PurgeJob (Job ID: c5a4c5ca-14ca-4cb3-9165-a13ac000f5b6) from Async(default) in 26.08ms
Started PATCH "/api/v1/expense_tracker/users/42/expenses/2" for 127.0.0.1 at 2022-08-03 07:35:31 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mInvoice Create (0.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 116], ["biller", nil], ["created_at", "2022-08-03 02:05:33.636965"], ["updated_at", "2022-08-03 02:05:33.636965"]]
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 116], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 2], ["updated_at", "2022-08-03 02:05:33.642962"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 145)
Completed 200 OK in 1797ms (Views: 0.5ms | ActiveRecord: 2.7ms | Allocations: 17832)


Started POST "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 07:36:38 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000111daea28 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-84731-35pqob.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"118", "description"=>"others"}, "user_id"=>"42"}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 118], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 118], ["status", 0], ["user_id", 42], ["created_at", "2022-08-03 02:06:39.013971"], ["updated_at", "2022-08-03 02:06:39.013971"], ["report_id", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 9]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "wdc63z6pgu7yta2mk06utsnvsa3e"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 02:06:39.024971"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 24], ["created_at", "2022-08-03 02:06:39.025847"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 02:06:39.026515"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: wdc63z6pgu7yta2mk06utsnvsa3e (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 241010c6-a1e3-41e6-94a4-5d798d903424) to Async(default) with arguments: #<GlobalID:0x000000011617eaa0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/9>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 24]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 221)
Completed 200 OK in 45ms (Views: 1.1ms | ActiveRecord: 4.0ms | Allocations: 41579)


[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 9], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424] Performing ActiveStorage::PurgeJob (Job ID: 241010c6-a1e3-41e6-94a4-5d798d903424) from Async(default) enqueued at 2022-08-03T02:06:39Z with arguments: #<GlobalID:0x00000001162bd628 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/9>>
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 9], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 9]]
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 9]]
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: ntq9ds1ijspg9u138keeqzh9v17x[0m
[ActiveJob] [ActiveStorage::PurgeJob] [241010c6-a1e3-41e6-94a4-5d798d903424] Performed ActiveStorage::PurgeJob (Job ID: 241010c6-a1e3-41e6-94a4-5d798d903424) from Async(default) in 27.16ms
Started PATCH "/api/v1/expense_tracker/users/42/expenses/3" for 127.0.0.1 at 2022-08-03 07:36:44 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:30:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mInvoice Create (0.5ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 118], ["biller", "Pixoboo"], ["created_at", "2022-08-03 02:06:45.678207"], ["updated_at", "2022-08-03 02:06:45.678207"]]
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:54:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 118], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 2], ["updated_at", "2022-08-03 02:06:45.684873"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 160)
Completed 200 OK in 1472ms (Views: 0.7ms | ActiveRecord: 3.9ms | Allocations: 11887)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddApprovedAmountToExpenses (20220803022725)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "expenses" ADD "approved_amount" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220803022725"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/expense_tracker/users/43/expenses" for 127.0.0.1 at 2022-08-03 08:57:05 +0530
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"43"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 4893ms (ActiveRecord: 2.9ms | Allocations: 24287)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=43):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:7:in `index'
Started GET "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 08:57:36 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"42"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 42]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 105.7ms | Allocations: 11137)
Completed 200 OK in 12939ms (Views: 108.1ms | ActiveRecord: 4.5ms | Allocations: 68939)


Started GET "/api/v1/expense_tracker/users/42/expenses/1" for 127.0.0.1 at 2022-08-03 08:58:19 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"42", "id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:14:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 4.9ms | Allocations: 327)
Completed 200 OK in 9089ms (Views: 7.8ms | ActiveRecord: 2.3ms | Allocations: 41740)


Started PATCH "/api/v1/expense_tracker/users/42/expenses/3" for 127.0.0.1 at 2022-08-03 08:59:31 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"3"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 6088ms (Views: 1.7ms | ActiveRecord: 5.4ms | Allocations: 52063)


Started PATCH "/api/v1/expense_tracker/users/42/expenses/3" for 127.0.0.1 at 2022-08-03 08:59:56 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"3"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 61031ms (Views: 1.2ms | ActiveRecord: 2.1ms | Allocations: 54472)


Started POST "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 09:02:09 +0530
  [1m[35m (2.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106e66a70 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-83695-2agyuf.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"119", "description"=>"others"}, "user_id"=>"42"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 119], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 119], ["status", 0], ["user_id", 42], ["created_at", "2022-08-03 03:32:09.531087"], ["updated_at", "2022-08-03 03:32:09.531087"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 10]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vrpe4pchtuqom0g335w01a7bftkd"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 03:32:09.544470"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 25], ["created_at", "2022-08-03 03:32:09.545612"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 03:32:09.546206"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: vrpe4pchtuqom0g335w01a7bftkd (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 33e813ae-41bd-4fbf-b801-79f14abd269a) to Async(default) with arguments: #<GlobalID:0x0000000106a9d1c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/10>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 25]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.0ms | Allocations: 648)
Completed 200 OK in 79ms (Views: 3.6ms | ActiveRecord: 4.4ms | Allocations: 60913)


[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a] Performing ActiveStorage::PurgeJob (Job ID: 33e813ae-41bd-4fbf-b801-79f14abd269a) from Async(default) enqueued at 2022-08-03T03:32:09Z with arguments: #<GlobalID:0x0000000106ba5408 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/10>>
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 10], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 10]]
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 10]]
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: 6k3155f09wu2eymw98sks3tbpc6q[0m
[ActiveJob] [ActiveStorage::PurgeJob] [33e813ae-41bd-4fbf-b801-79f14abd269a] Performed ActiveStorage::PurgeJob (Job ID: 33e813ae-41bd-4fbf-b801-79f14abd269a) from Async(default) in 33.1ms
Started PATCH "/api/v1/expense_tracker/users/42/expenses/4" for 127.0.0.1 at 2022-08-03 09:02:23 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted"}, "user_id"=>"42", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 42], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:40:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 119], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 4], ["updated_at", "2022-08-03 03:32:25.812994"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.2ms | Allocations: 290)
Completed 200 OK in 1911ms (Views: 2.3ms | ActiveRecord: 2.5ms | Allocations: 12643)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 09:11:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"Mike@gmail.com", "name"=>"Mike", "department"=>"Operations", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001070c66d0>, params: {"user"=>{"email"=>"Mike@gmail.com", "name"=>"Mike", "department"=>"Operations", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Mike"], ["department", "Operations"], ["status", 1], ["email", "Mike@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 03:41:30.053711"], ["updated_at", "2022-08-03 03:41:30.053711"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 43], ["created_at", "2022-08-03 03:41:30.059094"], ["updated_at", "2022-08-03 03:41:30.059094"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 43], ["created_at", "2022-08-03 03:41:30.061137"], ["updated_at", "2022-08-03 03:41:30.061137"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.8ms | Allocations: 2173)
Completed 201 Created in 260ms (Views: 2.4ms | ActiveRecord: 2.8ms | Allocations: 16665)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 09:12:03 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"David@gmail.com", "name"=>"David", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001069308f8>, params: {"user"=>{"email"=>"David@gmail.com", "name"=>"David", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "David@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "David"], ["department", "Engineering"], ["status", 1], ["email", "David@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 03:42:03.986189"], ["updated_at", "2022-08-03 03:42:03.986189"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 44], ["created_at", "2022-08-03 03:42:03.988849"], ["updated_at", "2022-08-03 03:42:03.988849"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 854)
Completed 201 Created in 260ms (Views: 0.9ms | ActiveRecord: 1.9ms | Allocations: 6130)


Started POST "/api/v1/expense_tracker/user/login?email=David@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 09:12:36 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"David@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "David@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 178)
Completed 200 OK in 256ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 2014)


Started POST "/api/v1/expense_tracker/users/42/expenses" for 127.0.0.1 at 2022-08-03 09:12:50 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106c35a08 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-83695-rkesqr.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"others"}, "user_id"=>"42"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 2ms (ActiveRecord: 0.2ms | Allocations: 2361)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=42):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:18:in `create'
Started POST "/api/v1/expense_tracker/users/43/expenses" for 127.0.0.1 at 2022-08-03 09:12:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106f9ef28 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-83695-43hgq.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"others"}, "user_id"=>"43"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.1ms | Allocations: 4819)


  
NameError (uninitialized constant UserAuthorization::FORBIDDEN

    raise CustomError::AuthenticationError.new('Forbidden, user is not active or logged in', FORBIDDEN)
                                                                                             ^^^^^^^^^):
  
app/controllers/concerns/user_authorization.rb:14:in `rescue in authorize_active_user'
app/controllers/concerns/user_authorization.rb:10:in `authorize_active_user'
app/controllers/expenses_controller.rb:19:in `create'
Started POST "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 09:13:17 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010681c1b0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-83695-uc5ytk.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"others"}, "user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 1], ["status", 0], ["user_id", 44], ["created_at", "2022-08-03 03:43:17.937790"], ["updated_at", "2022-08-03 03:43:17.937790"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 22]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vc7nj3jjnez5w8hcygbo8rfgps0g"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 03:43:17.946759"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 26], ["created_at", "2022-08-03 03:43:17.947633"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 03:43:17.948300"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: vc7nj3jjnez5w8hcygbo8rfgps0g (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 883b43df-2bb2-4810-bac0-fe0743c96c08) to Async(default) with arguments: #<GlobalID:0x0000000106f57538 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/22>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 26]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.3ms | Allocations: 361)
Completed 200 OK in 45ms (Views: 2.5ms | ActiveRecord: 2.5ms | Allocations: 41685)


[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 22], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08] Performing ActiveStorage::PurgeJob (Job ID: 883b43df-2bb2-4810-bac0-fe0743c96c08) from Async(default) enqueued at 2022-08-03T03:43:17Z with arguments: #<GlobalID:0x0000000106fbe3c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/22>>
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 22], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mActiveStorage::VariantRecord Load (0.2ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 22]]
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 22], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 22]]
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: erdggnphg63qk8i5gka3xkho7zyh[0m
[ActiveJob] [ActiveStorage::PurgeJob] [883b43df-2bb2-4810-bac0-fe0743c96c08] Performed ActiveStorage::PurgeJob (Job ID: 883b43df-2bb2-4810-bac0-fe0743c96c08) from Async(default) in 27.16ms
Started PATCH "/api/v1/expense_tracker/users/42/expenses/4" for 127.0.0.1 at 2022-08-03 09:14:06 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"42", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 1ms (ActiveRecord: 0.1ms | Allocations: 1718)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=42):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/4" for 127.0.0.1 at 2022-08-03 09:14:15 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"4"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:47:in `admin_update'
Completed 404 Not Found in 3ms (ActiveRecord: 0.3ms | Allocations: 2808)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=4):
  
app/controllers/expenses_controller.rb:47:in `admin_update'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:14:25 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:47:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001105850c8>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-03 03:44:25.134978"], ["approved_amount", 50], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:31:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 163)
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 6930)


Started POST "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 09:16:23 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000110647740 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-83695-1uue0l.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"others"}, "user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 2], ["status", 0], ["user_id", 44], ["created_at", "2022-08-03 03:46:23.157524"], ["updated_at", "2022-08-03 03:46:23.157524"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 23]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "whs6jqhhxqdkbd7rvd58ed99w455"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 03:46:23.161416"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 27], ["created_at", "2022-08-03 03:46:23.162266"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 03:46:23.162915"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: whs6jqhhxqdkbd7rvd58ed99w455 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 276f9490-9484-45af-9f0a-7c874ff9353a) to Async(default) with arguments: #<GlobalID:0x000000011083e760 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/23>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 27]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 138)
Completed 200 OK in 16ms (Views: 0.5ms | ActiveRecord: 2.3ms | Allocations: 15447)


[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 23], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a] Performing ActiveStorage::PurgeJob (Job ID: 276f9490-9484-45af-9f0a-7c874ff9353a) from Async(default) enqueued at 2022-08-03T03:46:23Z with arguments: #<GlobalID:0x0000000110894368 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/23>>
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 23], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 23]]
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 23], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 23]]
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: 3gqmvtben3qxw60tyk975tlhkj9q[0m
[ActiveJob] [ActiveStorage::PurgeJob] [276f9490-9484-45af-9f0a-7c874ff9353a] Performed ActiveStorage::PurgeJob (Job ID: 276f9490-9484-45af-9f0a-7c874ff9353a) from Async(default) in 6.96ms
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:18:28 +0530
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010f11d7e8>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.9ms | Allocations: 525)
Completed 200 OK in 8477ms (Views: 9.8ms | ActiveRecord: 7.0ms | Allocations: 76719)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:19:59 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001063c6a70>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.7ms | Allocations: 525)
Completed 200 OK in 27ms (Views: 2.0ms | ActiveRecord: 1.1ms | Allocations: 28832)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:21:09 +0530
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106031888>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 4.3ms | Allocations: 525)
Completed 200 OK in 292547ms (Views: 10.5ms | ActiveRecord: 7.5ms | Allocations: 136252)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:26:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001068dd9a0>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.9ms | Allocations: 278)
Completed 200 OK in 41006ms (Views: 7.3ms | ActiveRecord: 7.4ms | Allocations: 97423)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:26:54 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010667cc88>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.4ms | Allocations: 150)
Completed 200 OK in 141676ms (Views: 5.1ms | ActiveRecord: 3.3ms | Allocations: 72656)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:29:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106f87878>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.2ms | Allocations: 182)
Completed 200 OK in 26378ms (Views: 5.9ms | ActiveRecord: 7.4ms | Allocations: 86366)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:29:47 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001060d25f8>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.3ms | Allocations: 182)
Completed 200 OK in 82013ms (Views: 6.2ms | ActiveRecord: 7.8ms | Allocations: 85088)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:31:24 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:27:in `p'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 43], ["LIMIT", 11]]
  ↳ app/models/user.rb:27:in `p'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001066c50c8>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.2ms | Allocations: 181)
Completed 200 OK in 83604ms (Views: 6.0ms | ActiveRecord: 9.1ms | Allocations: 107950)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:32:52 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
Completed 500 Internal Server Error in 5423ms (ActiveRecord: 3.6ms | Allocations: 61795)


  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  
NoMethodError (undefined method `keys' for #<ActiveRecord::Associations::CollectionProxy [#<UserRole id: 29, role: "basic", user_id: 44, created_at: "2022-08-03 03:42:03.988849000 +0000", updated_at: "2022-08-03 03:42:03.988849000 +0000">]>):
  
app/models/user.rb:27:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/concerns/user_authorization.rb:4:in `authorize_user'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:37:35 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
Completed 500 Internal Server Error in 331ms (Allocations: 2939)


  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/models/user.rb:35: syntax error, unexpected `end', expecting end-of-input):
  
app/models/user.rb:35: syntax error, unexpected `end', expecting end-of-input
app/models/user.rb:35: syntax error, unexpected `end', expecting end-of-input
app/models/user.rb:35: syntax error, unexpected `end', expecting end-of-input
app/controllers/application_controller.rb:10:in `current_user'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:39:10 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 5488ms (ActiveRecord: 4.1ms | Allocations: 56908)


  
NameError (undefined local variable or method `user' for #<User id: 44, name: "David", department: "Engineering", status: "active", email: "David@gmail.com", password_digest: [FILTERED], created_at: "2022-08-03 03:42:03.986189000 +0000", updated_at: "2022-08-03 03:42:03.986189000 +0000">
Did you mean?  super):
  
app/models/user.rb:26:in `admin?'
app/policies/user_policy.rb:8:in `index?'
app/controllers/concerns/user_authorization.rb:4:in `authorize_user'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:40:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:26:in `admin?'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:26:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001067fcc70>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.7ms | Allocations: 181)
Completed 200 OK in 4432ms (Views: 7.2ms | ActiveRecord: 9.7ms | Allocations: 65770)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:41:06 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:26:in `admin?'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:26:in `admin?'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010694cfa8>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.7ms | Allocations: 149)
Completed 200 OK in 74972ms (Views: 5.6ms | ActiveRecord: 5.6ms | Allocations: 84862)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:42:36 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 43], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106ce4260>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.1ms | Allocations: 181)
Completed 200 OK in 52829ms (Views: 7.7ms | ActiveRecord: 13.0ms | Allocations: 123220)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:43:36 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 43], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001073ecf80>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.9ms | Allocations: 181)
Completed 200 OK in 72018ms (Views: 7.4ms | ActiveRecord: 12.1ms | Allocations: 122475)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:44:52 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 43], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameters: :amount, :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001070269a0>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"43", "id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.0ms | Allocations: 181)
Completed 200 OK in 97864ms (Views: 7.7ms | ActiveRecord: 14.2ms | Allocations: 134848)


Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:46:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:48:35 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 500 Internal Server Error in 23ms (ActiveRecord: 0.9ms | Allocations: 22366)


  
NameError (uninitialized constant UserAuthorization::FORBIDDEN

    raise CustomError::AuthenticationError.new('Forbidden, user not allowed to perform this action', FORBIDDEN)
                                                                                                     ^^^^^^^^^):
  
app/controllers/concerns/user_authorization.rb:7:in `rescue in authorize_user'
app/controllers/concerns/user_authorization.rb:3:in `authorize_user'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/43/expenses/1" for 127.0.0.1 at 2022-08-03 09:50:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"43", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 18ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 14231)


Started PATCH "/api/v1/expense_tracker/users/42/expenses/1" for 127.0.0.1 at 2022-08-03 09:51:21 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"42", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 1ms (ActiveRecord: 0.1ms | Allocations: 1736)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=42):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "/api/v1/expense_tracker/users/44/expenses/1" for 127.0.0.1 at 2022-08-03 09:51:33 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 17ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 18549)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/1" for 127.0.0.1 at 2022-08-03 09:51:48 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 44], ["LIMIT", 11]]
  ↳ app/models/user.rb:26:in `p'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:27:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 6482)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/1" for 127.0.0.1 at 2022-08-03 09:53:15 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 21ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 18761)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/1" for 127.0.0.1 at 2022-08-03 09:53:43 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 16ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 18680)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/1" for 127.0.0.1 at 2022-08-03 09:54:42 +0530
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 164394ms (Views: 1.9ms | ActiveRecord: 8.6ms | Allocations: 216752)


Started POST "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 09:57:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010641f620 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-96218-gfi3vx.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"others"}, "user_id"=>"44"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (1.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 4], ["status", 0], ["user_id", 44], ["created_at", "2022-08-03 04:28:02.668121"], ["updated_at", "2022-08-03 04:28:02.668121"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.6ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 24]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6wq4bdm7mtzvbyyb13lqm8rnb615"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 04:28:02.842923"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 28], ["created_at", "2022-08-03 04:28:02.864014"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 04:28:02.880382"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 6wq4bdm7mtzvbyyb13lqm8rnb615 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 24], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 0f8159ac-54d5-444e-ae64-b04c8a5c6b99) to Async(default) with arguments: #<GlobalID:0x0000000106ccf900 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/24>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 28]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 8.8ms | Allocations: 578)
Completed 200 OK in 6280ms (Views: 19.2ms | ActiveRecord: 17.8ms | Allocations: 104871)


[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 24], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99] Performing ActiveStorage::PurgeJob (Job ID: 0f8159ac-54d5-444e-ae64-b04c8a5c6b99) from Async(default) enqueued at 2022-08-03T04:28:02Z with arguments: #<GlobalID:0x00000001064ef2f8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/24>>
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mActiveStorage::Attachment Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 24], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mActiveStorage::VariantRecord Load (0.4ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 24]]
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 24], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mActiveStorage::Blob Destroy (0.6ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 24]]
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99]   [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: wdc63z6pgu7yta2mk06utsnvsa3e[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0f8159ac-54d5-444e-ae64-b04c8a5c6b99] Performed ActiveStorage::PurgeJob (Job ID: 0f8159ac-54d5-444e-ae64-b04c8a5c6b99) from Async(default) in 244.37ms
Started PATCH "/api/v1/expense_tracker/users/44/expenses/2" for 127.0.0.1 at 2022-08-03 09:58:34 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"2"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
  [1m[36mInvoice Create (0.8ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 2], ["biller", "Zoomcast"], ["created_at", "2022-08-03 04:29:04.954241"], ["updated_at", "2022-08-03 04:29:04.954241"]]
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
[31mUnpermitted parameter: :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001066cfb68>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"44", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 2], ["updated_at", "2022-08-03 04:29:05.006563"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 4.4ms | Allocations: 294)
Completed 200 OK in 28633ms (Views: 8.7ms | ActiveRecord: 15.0ms | Allocations: 181306)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/2" for 127.0.0.1 at 2022-08-03 10:00:25 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 25ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 26763)


Started POST "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 10:00:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011d61d4b0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-5318-7pzu6w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"others"}, "user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 6], ["status", 0], ["user_id", 44], ["created_at", "2022-08-03 04:30:32.945441"], ["updated_at", "2022-08-03 04:30:32.945441"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 25]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "h1oqbgvea3gdgai48yyx1v1j2d9f"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 04:30:32.961110"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 29], ["created_at", "2022-08-03 04:30:32.962329"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 04:30:32.963142"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: h1oqbgvea3gdgai48yyx1v1j2d9f (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5) to Async(default) with arguments: #<GlobalID:0x000000011c1faa28 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/25>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 29]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 25], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5] Performing ActiveStorage::PurgeJob (Job ID: 2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5) from Async(default) enqueued at 2022-08-03T04:30:32Z with arguments: #<GlobalID:0x000000011c4b7f40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/25>>
  Rendered expenses/create.jbuilder (Duration: 8.6ms | Allocations: 3174)
Completed 200 OK in 76ms (Views: 17.9ms | ActiveRecord: 3.4ms | Allocations: 43767)


[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 25], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 25]]
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 25], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 25]]
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5]   [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: vrpe4pchtuqom0g335w01a7bftkd[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5] Performed ActiveStorage::PurgeJob (Job ID: 2c73b94a-1d17-4fcf-9e50-7c5c5b67fff5) from Async(default) in 28.99ms
Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:00:43 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "user_id"=>"44", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
  [1m[36mInvoice Create (0.4ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 4], ["biller", "Eayo"], ["created_at", "2022-08-03 04:30:46.221059"], ["updated_at", "2022-08-03 04:30:46.221059"]]
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `store_invoice_validations'
[31mUnpermitted parameter: :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000011d0a68b0>, params: {"expense"=>{"amount"=>100, "description"=>"Domestic travel", "status"=>"submitted", "approved_amount"=>50}, "controller"=>"expenses", "action"=>"update", "user_id"=>"44", "id"=>"3"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Domestic travel"], ["amount", 100], ["status", 2], ["updated_at", "2022-08-03 04:30:46.228503"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.0ms | Allocations: 274)
Completed 200 OK in 2906ms (Views: 1.4ms | ActiveRecord: 3.5ms | Allocations: 15339)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 10:13:32 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.4ms | Allocations: 177)
Completed 200 OK in 251ms (Views: 2.0ms | ActiveRecord: 0.3ms | Allocations: 2540)


Started GET "/api/v1/expense_tracker/users/43/expenses" for 127.0.0.1 at 2022-08-03 10:13:45 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"43"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 1744)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.3ms | Allocations: 4656)


Started GET "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 10:13:49 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 7.2ms | Allocations: 1338)
Completed 200 OK in 15ms (Views: 7.4ms | ActiveRecord: 0.4ms | Allocations: 3786)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:14:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>50}, "user_id"=>"44", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 21ms (Views: 2.1ms | ActiveRecord: 0.4ms | Allocations: 4892)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:16:12 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>50}, "user_id"=>"44", "id"=>"3"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 75726ms (Views: 2.3ms | ActiveRecord: 10.0ms | Allocations: 181404)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:17:31 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>50}, "user_id"=>"44", "id"=>"3"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 44], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `user_update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 50331ms (Views: 1.8ms | ActiveRecord: 10.6ms | Allocations: 177367)


Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:21:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>50}, "user_id"=>"44", "id"=>"3"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 04:51:20.145757"], ["approved_amount", 50], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 5.3ms | Allocations: 494)
Completed 200 OK in 8924ms (Views: 12.5ms | ActiveRecord: 11.8ms | Allocations: 111026)


Started GET "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 10:21:53 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 44]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 8.5ms | Allocations: 10801)
Completed 200 OK in 32ms (Views: 9.6ms | ActiveRecord: 1.2ms | Allocations: 32051)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 10:49:36 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasip09@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000105940470>, params: {"user"=>{"email"=>"kasip09@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "kasip09@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 05:19:36.564339"], ["updated_at", "2022-08-03 05:19:36.564339"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 45], ["created_at", "2022-08-03 05:19:36.570004"], ["updated_at", "2022-08-03 05:19:36.570004"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 2073)
Completed 201 Created in 259ms (Views: 2.2ms | ActiveRecord: 2.5ms | Allocations: 15160)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 10:49:52 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.1ms | Allocations: 177)
Completed 200 OK in 255ms (Views: 1.6ms | ActiveRecord: 0.2ms | Allocations: 2013)


Started POST "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 10:50:01 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106c97c30 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-19450-qnbevj.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"123", "description"=>"others"}, "user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3402)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 10:50:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106e6c3d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-19450-v1pbms.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"123", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 123], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 123], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 05:20:14.226417"], ["updated_at", "2022-08-03 05:20:14.226417"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 11]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "2ihz1g1tnkk8vt07xp4ym891gu9y"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 05:20:14.237967"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 30], ["created_at", "2022-08-03 05:20:14.239076"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 05:20:14.239802"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 2ihz1g1tnkk8vt07xp4ym891gu9y (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 07939752-919e-4a2f-be79-836350c41b09) to Async(default) with arguments: #<GlobalID:0x00000001073fe320 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/11>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 30]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 345)
Completed 200 OK in 47ms (Views: 1.4ms | ActiveRecord: 2.9ms | Allocations: 50322)


[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 11], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09] Performing ActiveStorage::PurgeJob (Job ID: 07939752-919e-4a2f-be79-836350c41b09) from Async(default) enqueued at 2022-08-03T05:20:14Z with arguments: #<GlobalID:0x00000001051420e8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/11>>
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 11], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 11]]
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 11]]
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: vkzoqkpci0nj7kx46kusv89usoke[0m
[ActiveJob] [ActiveStorage::PurgeJob] [07939752-919e-4a2f-be79-836350c41b09] Performed ActiveStorage::PurgeJob (Job ID: 07939752-919e-4a2f-be79-836350c41b09) from Async(default) in 35.23ms
Started PATCH "/api/v1/expense_tracker/users/44/expenses/3" for 127.0.0.1 at 2022-08-03 10:51:06 +0530
Error occurred while parsing request parameters.
Contents:

{
    "expense" :{
        "amount": "200"
        "status": "submitted"
    }
}
Processing by ExpensesController#update as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 400 Bad Request in 1ms (ActiveRecord: 0.1ms | Allocations: 1502)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:29:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/5" for 127.0.0.1 at 2022-08-03 10:52:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"5"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 123], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 4], ["updated_at", "2022-08-03 05:22:10.173073"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.2ms | Allocations: 267)
Completed 200 OK in 1716ms (Views: 1.6ms | ActiveRecord: 2.9ms | Allocations: 18702)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/5" for 127.0.0.1 at 2022-08-03 10:53:18 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"5"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 13ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 19134)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 10:53:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106f66f60 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-19450-oe9rf7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"125", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 125], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 125], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 05:23:32.359317"], ["updated_at", "2022-08-03 05:23:32.359317"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 12]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "dks73x1x80wmewv7shtwmcqkr9jv"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 05:23:32.367796"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 31], ["created_at", "2022-08-03 05:23:32.368664"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 05:23:32.369177"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: dks73x1x80wmewv7shtwmcqkr9jv (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 4118ee7d-439e-41a5-a469-0a18d4117d5a) to Async(default) with arguments: #<GlobalID:0x0000000107217a70 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/12>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 31]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 221)
Completed 200 OK in 59ms (Views: 3.3ms | ActiveRecord: 2.6ms | Allocations: 29973)


[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 12], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a] Performing ActiveStorage::PurgeJob (Job ID: 4118ee7d-439e-41a5-a469-0a18d4117d5a) from Async(default) enqueued at 2022-08-03T05:23:32Z with arguments: #<GlobalID:0x00000001053070e0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/12>>
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 12], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 12]]
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 12]]
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: ntthgn52hcm6eafbqgeherqo7l6l[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4118ee7d-439e-41a5-a469-0a18d4117d5a] Performed ActiveStorage::PurgeJob (Job ID: 4118ee7d-439e-41a5-a469-0a18d4117d5a) from Async(default) in 25.52ms
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 10:53:44 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 2.0ms | Allocations: 2511)
  Rendered layout layouts/mailer.text.erb (Duration: 2.2ms | Allocations: 2605)
UserMailer#expense_update: processed outbound mail in 9.1ms
Completed 500 Internal Server Error in 2088ms (ActiveRecord: 0.7ms | Allocations: 25074)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

            @virtual_path = "user_mailer/expense_update";;@output_buffer.safe_append='Please find below details on your expense '.freeze;@output_buffer.safe_expr_append=( @expense.description);@output_buffer.safe_append='
                                                                                                                                                                                   ^^^^^^^^^^^^):
    1: Please find below details on your expense <%= @expense.description%>
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
  
app/views/user_mailer/expense_update.text.erb:1
app/mailers/user_mailer.rb:4:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 10:54:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 3.1ms | Allocations: 2202)
  Rendered layout layouts/mailer.text.erb (Duration: 3.3ms | Allocations: 2296)
UserMailer#expense_update: processed outbound mail in 7.9ms
Completed 500 Internal Server Error in 1558ms (ActiveRecord: 0.2ms | Allocations: 11171)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

expense description is: '.freeze;@output_buffer.safe_expr_append=( @expense.description );@output_buffer.safe_append='
                                                                           ^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
    5: expense amount <%=@expense.amount%>
  
app/views/user_mailer/expense_update.text.erb:2
app/mailers/user_mailer.rb:4:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 10:56:23 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 2.6ms | Allocations: 1994)
  Rendered layout layouts/mailer.text.erb (Duration: 2.8ms | Allocations: 2088)
UserMailer#expense_update: processed outbound mail in 5.5ms
Completed 500 Internal Server Error in 1995ms (ActiveRecord: 1.1ms | Allocations: 25707)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

expense description is: '.freeze;@output_buffer.safe_expr_append=( @expense.description );@output_buffer.safe_append='
                                                                           ^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
    5: expense amount <%=@expense.amount%>
  
app/views/user_mailer/expense_update.text.erb:2
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 10:58:31 +0530
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 184.9ms | Allocations: 2800)
  Rendered layout layouts/mailer.text.erb (Duration: 186.6ms | Allocations: 2916)
UserMailer#expense_update: processed outbound mail in 1386295.3ms
Completed 500 Internal Server Error in 1419565ms (ActiveRecord: 9.9ms | Allocations: 238902)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

expense description is: '.freeze;@output_buffer.safe_expr_append=( @expense.description );@output_buffer.safe_append='
                                                                           ^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
    5: expense amount <%=@expense.amount%>
  
app/views/user_mailer/expense_update.text.erb:2
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:22:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 197.9ms | Allocations: 2207)
  Rendered layout layouts/mailer.text.erb (Duration: 200.4ms | Allocations: 2305)
UserMailer#expense_update: processed outbound mail in 54144.2ms
Completed 500 Internal Server Error in 147449ms (ActiveRecord: 4.0ms | Allocations: 213883)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

expense description is: '.freeze;@output_buffer.safe_expr_append=( @expense.description );@output_buffer.safe_append='
                                                                           ^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
    5: expense amount <%=@expense.amount%>
  
app/views/user_mailer/expense_update.text.erb:2
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:26:45 +0530
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 18778ms (ActiveRecord: 8.6ms | Allocations: 159144)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:76:in `invoice_validator_response'
app/controllers/expenses_controller.rb:59:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:28:01 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 2080ms (ActiveRecord: 1.2ms | Allocations: 29945)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:76:in `invoice_validator_response'
app/controllers/expenses_controller.rb:59:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:29:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1929ms (ActiveRecord: 1.3ms | Allocations: 20788)


  
RestClient::InternalServerError (500 Internal Server Error):
  
app/controllers/expenses_controller.rb:76:in `invoice_validator_response'
app/controllers/expenses_controller.rb:59:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:29:58 +0530
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:32:56 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 196.8ms | Allocations: 2802)
  Rendered layout layouts/mailer.text.erb (Duration: 198.6ms | Allocations: 2918)
UserMailer#expense_update: processed outbound mail in 14372.2ms
Completed 500 Internal Server Error in 38041ms (ActiveRecord: 8.7ms | Allocations: 185298)


  
ActionView::Template::Error (undefined method `description' for nil:NilClass

expense description is: '.freeze;@output_buffer.safe_expr_append=( @expense.description );@output_buffer.safe_append='
                                                                           ^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: expense description is: <%= @expense.description %>
    3: expense invoice number is: <%= @expense.invoice_number %>
    4: expense status <%=@expense.status %>
    5: expense amount <%=@expense.amount%>
  
app/views/user_mailer/expense_update.text.erb:2
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/6" for 127.0.0.1 at 2022-08-03 11:35:18 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"6"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 2.8ms | Allocations: 154)
  Rendered layout layouts/mailer.text.erb (Duration: 7.4ms | Allocations: 382)
UserMailer#expense_update: processed outbound mail in 1527.4ms
Delivered mail 62ea1034a31b1_86d1f4c434574@CALTM00564.local.mail (4432.3ms)
Date: Wed, 03 Aug 2022 11:35:40 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea1034a31b1_86d1f4c434574@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 



have a great day!


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 125], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 4], ["updated_at", "2022-08-03 06:05:45.146163"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.8ms | Allocations: 348)
Completed 200 OK in 26388ms (Views: 8.4ms | ActiveRecord: 7.1ms | Allocations: 169401)


Started GET "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 11:37:31 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"44"}
Started GET "/api/v1/expense_tracker/users/44/expenses" for 127.0.0.1 at 2022-08-03 11:37:52 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"44"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 20ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 20054)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:37:57 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 8.0ms | Allocations: 10553)
Completed 200 OK in 15ms (Views: 9.0ms | ActiveRecord: 0.7ms | Allocations: 14844)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:38:08 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010bc87a38 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-w1x521.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"127", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 127], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 127], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:08:08.902247"], ["updated_at", "2022-08-03 06:08:08.902247"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 13]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "h6smy01p5f4p6f0bkx1tmudmn5mc"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:08:08.915159"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 32], ["created_at", "2022-08-03 06:08:08.916100"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:08:08.916793"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: h6smy01p5f4p6f0bkx1tmudmn5mc (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 045b439e-4ec1-4d0a-a484-603ac45fbfe5) to Async(default) with arguments: #<GlobalID:0x000000010a9699b0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/13>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 32]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 335)
Completed 200 OK in 49ms (Views: 1.0ms | ActiveRecord: 2.9ms | Allocations: 38796)


[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 13], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5] Performing ActiveStorage::PurgeJob (Job ID: 045b439e-4ec1-4d0a-a484-603ac45fbfe5) from Async(default) enqueued at 2022-08-03T06:08:08Z with arguments: #<GlobalID:0x000000010aa79ff8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/13>>
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 13], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mActiveStorage::VariantRecord Load (0.2ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 13]]
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 13]]
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5] [36m  Disk Storage (0.1ms) [0m[31mDeleted file from key: vhdkuqvhbbe3rcv3p6z9cuif36w1[0m
[ActiveJob] [ActiveStorage::PurgeJob] [045b439e-4ec1-4d0a-a484-603ac45fbfe5] Performed ActiveStorage::PurgeJob (Job ID: 045b439e-4ec1-4d0a-a484-603ac45fbfe5) from Async(default) in 30.86ms
Started PATCH "/api/v1/expense_tracker/users/45/expenses/7" for 127.0.0.1 at 2022-08-03 11:38:20 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"7"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 3.9ms | Allocations: 2616)
  Rendered layout layouts/mailer.text.erb (Duration: 4.2ms | Allocations: 2725)
UserMailer#expense_update: processed outbound mail in 8.8ms
Completed 500 Internal Server Error in 2408ms (ActiveRecord: 0.3ms | Allocations: 29043)


  
ActionView::Template::Error (undefined method `invoice_number' for nil:NilClass

expense invoice number is: '.freeze;@output_buffer.safe_expr_append=( @expense.invoice_number );@output_buffer.safe_append='
                                                                              ^^^^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: 
    3: 
    4: expense invoice number is: <%= @expense.invoice_number %>
    5: expense status <%=@expense.status %>
    6: expense amount <%=@expense.amount%>
    7: approved amount <%=@expense.approved_amount%>
  
app/views/user_mailer/expense_update.text.erb:4
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/7" for 127.0.0.1 at 2022-08-03 11:39:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"7"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 178)
  Rendered layout layouts/mailer.text.erb (Duration: 2.2ms | Allocations: 401)
UserMailer#expense_update: processed outbound mail in 20.4ms
Delivered mail 62ea113831ba3_93b4f26c9845b@CALTM00564.local.mail (2844.0ms)
Date: Wed, 03 Aug 2022 11:40:00 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea113831ba3_93b4f26c9845b@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email kasip09@gmail.com


have a great day!


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 127], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 4], ["updated_at", "2022-08-03 06:10:03.052618"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.5ms | Allocations: 250)
Completed 200 OK in 11575ms (Views: 2.8ms | ActiveRecord: 2.4ms | Allocations: 25474)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/7" for 127.0.0.1 at 2022-08-03 11:40:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"7"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 5360)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:40:43 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010aadf7b8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-ibi1vp.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"129", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 129], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 129], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:10:43.967467"], ["updated_at", "2022-08-03 06:10:43.967467"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 14]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "g3bvzl1stuglk57d0sit0pnwuk1l"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:10:43.972271"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 33], ["created_at", "2022-08-03 06:10:43.973314"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:10:43.974031"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: g3bvzl1stuglk57d0sit0pnwuk1l (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 9d0cbf26-e11c-4924-a268-06d3ed6586ea) to Async(default) with arguments: #<GlobalID:0x000000010adae110 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/14>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 33]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.1ms | Allocations: 432)
Completed 200 OK in 17ms (Views: 1.9ms | ActiveRecord: 2.2ms | Allocations: 16338)


[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 14], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea] Performing ActiveStorage::PurgeJob (Job ID: 9d0cbf26-e11c-4924-a268-06d3ed6586ea) from Async(default) enqueued at 2022-08-03T06:10:43Z with arguments: #<GlobalID:0x000000010adf7d60 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/14>>
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 14], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 14]]
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 14]]
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea]   [1m[36mTRANSACTION (17.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: 1k36386btbwfg37f6q9gz1p77beh[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9d0cbf26-e11c-4924-a268-06d3ed6586ea] Performed ActiveStorage::PurgeJob (Job ID: 9d0cbf26-e11c-4924-a268-06d3ed6586ea) from Async(default) in 23.09ms
Started PATCH "/api/v1/expense_tracker/users/45/expenses/8" for 127.0.0.1 at 2022-08-03 11:40:49 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 4.0ms | Allocations: 2247)
  Rendered layout layouts/mailer.text.erb (Duration: 4.2ms | Allocations: 2341)
UserMailer#expense_update: processed outbound mail in 7.5ms
Completed 500 Internal Server Error in 2058ms (ActiveRecord: 0.2ms | Allocations: 10997)


  
ActionView::Template::Error (undefined method `invoice_number' for nil:NilClass

expense invoice number is: '.freeze;@output_buffer.safe_expr_append=( @expense.invoice_number );@output_buffer.safe_append='
                                                                              ^^^^^^^^^^^^^^^):
    1: Please find below details on your expense 
    2: 
    3: email <%= @user.email %>
    4: expense invoice number is: <%= @expense.invoice_number %>
    5: expense status <%=@expense.status %>
    6: expense amount <%=@expense.amount%>
    7: approved amount <%=@expense.approved_amount%>
  
app/views/user_mailer/expense_update.text.erb:4
app/mailers/user_mailer.rb:5:in `expense_update'
app/controllers/expenses_controller.rb:54:in `notify_user'
app/controllers/expenses_controller.rb:65:in `expense_pre_processing'
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/8" for 127.0.0.1 at 2022-08-03 11:41:23 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"8"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 34)
  Rendered layout layouts/mailer.text.erb (Duration: 1.0ms | Allocations: 286)
UserMailer#expense_update: processed outbound mail in 3.2ms
Delivered mail 62ea118d9ae79_93b4f25898514@CALTM00564.local.mail (3765.2ms)
Date: Wed, 03 Aug 2022 11:41:25 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea118d9ae79_93b4f25898514@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email kasip09@gmail.com
expense invoice number is: 129
expense status drafted
expense amount 99
approved amount 


have a great day!


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 129], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 4], ["updated_at", "2022-08-03 06:11:29.406830"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.3ms | Allocations: 265)
Completed 200 OK in 5478ms (Views: 2.7ms | ActiveRecord: 3.6ms | Allocations: 30684)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:48:17 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.3ms | Allocations: 176)
Completed 200 OK in 263ms (Views: 2.1ms | ActiveRecord: 0.6ms | Allocations: 2509)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:48:27 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.5ms | Allocations: 2302)
Completed 200 OK in 6ms (Views: 2.6ms | ActiveRecord: 0.4ms | Allocations: 5094)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:48:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010af94f10 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-3ctapn.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"130", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2358)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:49:53 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 200 OK in 252ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1085)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:50:01 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010bb747e0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-caviez.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"130", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 130], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (2.0ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 130], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:20:01.468033"], ["updated_at", "2022-08-03 06:20:01.468033"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 15]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "2cy95kz46h5fpqwssou0989bpil4"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:20:01.480112"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 9], ["blob_id", 34], ["created_at", "2022-08-03 06:20:01.481179"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:20:01.481782"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 2cy95kz46h5fpqwssou0989bpil4 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 8d9a36c2-2a68-4506-953e-ec698aff30ba) to Async(default) with arguments: #<GlobalID:0x000000010a8532b0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/15>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 34]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 185)
Completed 200 OK in 85ms (Views: 0.5ms | ActiveRecord: 4.5ms | Allocations: 36316)


[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 15], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba] Performing ActiveStorage::PurgeJob (Job ID: 8d9a36c2-2a68-4506-953e-ec698aff30ba) from Async(default) enqueued at 2022-08-03T06:20:01Z with arguments: #<GlobalID:0x000000010a9bab58 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/15>>
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 15], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 15]]
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 15]]
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: 3sqhpip5uqojbnotmx2i2883mmtn[0m
[ActiveJob] [ActiveStorage::PurgeJob] [8d9a36c2-2a68-4506-953e-ec698aff30ba] Performed ActiveStorage::PurgeJob (Job ID: 8d9a36c2-2a68-4506-953e-ec698aff30ba) from Async(default) in 25.35ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:50:07 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010abc75b8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-44go2j.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"132", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 132], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 132], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:20:07.614209"], ["updated_at", "2022-08-03 06:20:07.614209"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 16]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "qf2a9pmbfmjb3d7c4t7ulhp75smc"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:20:07.618069"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 10], ["blob_id", 35], ["created_at", "2022-08-03 06:20:07.618807"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:20:07.619443"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: qf2a9pmbfmjb3d7c4t7ulhp75smc (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 6412b28a-a65d-417f-8e49-6505ab011049) to Async(default) with arguments: #<GlobalID:0x000000010afc5c28 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/16>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 35]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 148)
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 15659)


[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 16], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049] Performing ActiveStorage::PurgeJob (Job ID: 6412b28a-a65d-417f-8e49-6505ab011049) from Async(default) enqueued at 2022-08-03T06:20:07Z with arguments: #<GlobalID:0x000000010b966840 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/16>>
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 16], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 16]]
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 16], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mActiveStorage::Blob Destroy (17.1ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 16]]
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: onqy4hzffxoeqhjvra64tzbs7uam[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6412b28a-a65d-417f-8e49-6505ab011049] Performed ActiveStorage::PurgeJob (Job ID: 6412b28a-a65d-417f-8e49-6505ab011049) from Async(default) in 22.74ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:50:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010bb57708 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-j99r3o.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"134", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 134], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 134], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:20:11.293862"], ["updated_at", "2022-08-03 06:20:11.293862"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 17]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6b8dmqemk11jbcs5t7isiq7vjqcv"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:20:11.297378"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 11], ["blob_id", 36], ["created_at", "2022-08-03 06:20:11.298205"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:20:11.298949"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 6b8dmqemk11jbcs5t7isiq7vjqcv (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 17], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: b9e1ee17-98a6-4380-8408-e5885be92817) to Async(default) with arguments: #<GlobalID:0x000000010be76c68 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/17>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 36]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 132)
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 15287)


[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 17], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817] Performing ActiveStorage::PurgeJob (Job ID: b9e1ee17-98a6-4380-8408-e5885be92817) from Async(default) enqueued at 2022-08-03T06:20:11Z with arguments: #<GlobalID:0x000000010bef4a00 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/17>>
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 17], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 17]]
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 17], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 17]]
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: oqu0f6b2i7eu1krv2r6dheedt8h4[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b9e1ee17-98a6-4380-8408-e5885be92817] Performed ActiveStorage::PurgeJob (Job ID: b9e1ee17-98a6-4380-8408-e5885be92817) from Async(default) in 22.93ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:50:15 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010ce7eae8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-datgqk.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"136", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 136], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 136], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:20:15.452285"], ["updated_at", "2022-08-03 06:20:15.452285"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 18]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "iacwpcrjeo7v3gg52hjqt95nh8n3"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:20:15.455674"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 12], ["blob_id", 37], ["created_at", "2022-08-03 06:20:15.456850"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:20:15.457609"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: iacwpcrjeo7v3gg52hjqt95nh8n3 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0) to Async(default) with arguments: #<GlobalID:0x000000010cf76f90 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/18>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 37]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 132)
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 15306)


[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 18], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0] Performing ActiveStorage::PurgeJob (Job ID: 5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0) from Async(default) enqueued at 2022-08-03T06:20:15Z with arguments: #<GlobalID:0x000000010cfccd28 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/18>>
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 18], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 18]]
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 18], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 18]]
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0] [36m  Disk Storage (1.0ms) [0m[31mDeleted file from key: 2gp3nal0yftyztc08ker4qjqsx0o[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0] Performed ActiveStorage::PurgeJob (Job ID: 5660cb40-e3fb-4b75-be2a-0e9e5c5f63d0) from Async(default) in 6.41ms
Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:50:35 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 46)
Completed 200 OK in 255ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1082)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:50:47 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.1ms | Allocations: 1895)
Completed 200 OK in 4ms (Views: 1.2ms | ActiveRecord: 0.3ms | Allocations: 4342)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/12" for 127.0.0.1 at 2022-08-03 11:51:26 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"12"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010d0fed40>, params: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"45", "id"=>"12"} }[0m
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 20)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 126)
UserMailer#expense_update: processed outbound mail in 0.6ms
Delivered mail 62ea13e79b1_93b4f244986c7@CALTM00564.local.mail (2773.8ms)
Date: Wed, 03 Aug 2022 11:51:27 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea13e79b1_93b4f244986c7@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email kasip09@gmail.com
expense invoice number is: 136
expense status drafted
expense amount 99
approved amount 


have a great day!


Completed 500 Internal Server Error in 2780ms (ActiveRecord: 0.3ms | Allocations: 9007)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Mail::Message passed.):
  
app/controllers/expenses_controller.rb:32:in `update'
Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:53:15 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1627)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:53:27 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
password mismatch for user kasip09@gmail.com
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 913)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:53:34 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.1ms | Allocations: 177)
Completed 200 OK in 254ms (Views: 1.7ms | ActiveRecord: 0.1ms | Allocations: 1638)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:53:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010d9c4ee8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-kdxoa8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"136", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 136], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 136], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:23:46.768464"], ["updated_at", "2022-08-03 06:23:46.768464"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 26]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "mjtq216gfskyv4zr197x2ayh1j83"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:23:46.778993"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 38], ["created_at", "2022-08-03 06:23:46.781147"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:23:46.782122"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: mjtq216gfskyv4zr197x2ayh1j83 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 29a6a354-5241-4320-b798-03ccadf61f9b) to Async(default) with arguments: #<GlobalID:0x000000010dba52f8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/26>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 38]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.7ms | Allocations: 312)
Completed 200 OK in 27ms (Views: 1.6ms | ActiveRecord: 2.6ms | Allocations: 16280)


[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 26], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b] Performing ActiveStorage::PurgeJob (Job ID: 29a6a354-5241-4320-b798-03ccadf61f9b) from Async(default) enqueued at 2022-08-03T06:23:46Z with arguments: #<GlobalID:0x000000010de56a10 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/26>>
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mActiveStorage::Attachment Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 26], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 26]]
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 26], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 26]]
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: vc7nj3jjnez5w8hcygbo8rfgps0g[0m
[ActiveJob] [ActiveStorage::PurgeJob] [29a6a354-5241-4320-b798-03ccadf61f9b] Performed ActiveStorage::PurgeJob (Job ID: 29a6a354-5241-4320-b798-03ccadf61f9b) from Async(default) in 31.55ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:53:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010dee7da8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-205yhh.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"140", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 140], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 140], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:23:56.151076"], ["updated_at", "2022-08-03 06:23:56.151076"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 27]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "7by2ckcvwechx6x4w429gyllbqr8"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:23:56.157599"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 39], ["created_at", "2022-08-03 06:23:56.158433"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:23:56.159366"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 7by2ckcvwechx6x4w429gyllbqr8 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 056813d2-f28e-48f0-bba4-db3e74aee8c8) to Async(default) with arguments: #<GlobalID:0x0000000109d30ec8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/27>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 39]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 132)
Completed 200 OK in 18ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 15545)


[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 27], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8] Performing ActiveStorage::PurgeJob (Job ID: 056813d2-f28e-48f0-bba4-db3e74aee8c8) from Async(default) enqueued at 2022-08-03T06:23:56Z with arguments: #<GlobalID:0x000000010a495dd0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/27>>
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 27], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 27]]
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 27], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 27]]
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8] [36m  Disk Storage (0.1ms) [0m[31mDeleted file from key: whs6jqhhxqdkbd7rvd58ed99w455[0m
[ActiveJob] [ActiveStorage::PurgeJob] [056813d2-f28e-48f0-bba4-db3e74aee8c8] Performed ActiveStorage::PurgeJob (Job ID: 056813d2-f28e-48f0-bba4-db3e74aee8c8) from Async(default) in 22.92ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:54:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a822fe8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-b3ak59.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"141", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 141], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 141], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:24:00.749267"], ["updated_at", "2022-08-03 06:24:00.749267"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 28]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "9fe29fqdl65td6u3py0xxuwyw9dq"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:24:00.752767"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 40], ["created_at", "2022-08-03 06:24:00.753709"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:24:00.754230"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 9fe29fqdl65td6u3py0xxuwyw9dq (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 1cc096df-b60d-4d4b-8cac-6a5f9fa09c31) to Async(default) with arguments: #<GlobalID:0x000000010ab37a58 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/28>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 40]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.4ms | Allocations: 132)
Completed 200 OK in 15ms (Views: 0.8ms | ActiveRecord: 1.9ms | Allocations: 15288)


[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 28], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31] Performing ActiveStorage::PurgeJob (Job ID: 1cc096df-b60d-4d4b-8cac-6a5f9fa09c31) from Async(default) enqueued at 2022-08-03T06:24:00Z with arguments: #<GlobalID:0x000000010abe5220 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/28>>
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 28], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 28]]
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 28], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 28]]
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: 6wq4bdm7mtzvbyyb13lqm8rnb615[0m
[ActiveJob] [ActiveStorage::PurgeJob] [1cc096df-b60d-4d4b-8cac-6a5f9fa09c31] Performed ActiveStorage::PurgeJob (Job ID: 1cc096df-b60d-4d4b-8cac-6a5f9fa09c31) from Async(default) in 25.04ms
Started PATCH "/api/v1/expense_tracker/users/45/expenses/13" for 127.0.0.1 at 2022-08-03 11:54:16 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"13"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
Completed 404 Not Found in 4ms (ActiveRecord: 0.3ms | Allocations: 4576)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=13 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:41:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/1" for 127.0.0.1 at 2022-08-03 11:54:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 136], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 3], ["updated_at", "2022-08-03 06:24:38.723311"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.7ms | Allocations: 208)
Completed 200 OK in 7ms (Views: 0.9ms | ActiveRecord: 1.0ms | Allocations: 7794)


Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:55:27 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010de37cc8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-tctdm5.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"900", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 900], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 900], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:25:27.424570"], ["updated_at", "2022-08-03 06:25:27.424570"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 29]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "j1015mbin26pz1f3g2ln0rzkcfq9"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:25:27.428708"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 41], ["created_at", "2022-08-03 06:25:27.429816"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:25:27.430756"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: j1015mbin26pz1f3g2ln0rzkcfq9 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 29], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd) to Async(default) with arguments: #<GlobalID:0x000000010e01dc40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/29>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 41]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 321)
Completed 200 OK in 19ms (Views: 1.3ms | ActiveRecord: 2.3ms | Allocations: 15947)


[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 29], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd] Performing ActiveStorage::PurgeJob (Job ID: a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd) from Async(default) enqueued at 2022-08-03T06:25:27Z with arguments: #<GlobalID:0x0000000109c19b20 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/29>>
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 29], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 29]]
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 29], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 29]]
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: h1oqbgvea3gdgai48yyx1v1j2d9f[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd] Performed ActiveStorage::PurgeJob (Job ID: a4ae7ff9-277b-4fdc-bf00-86d44e12e7cd) from Async(default) in 24.72ms
Started POST "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:55:33 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a49d6e8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-37812-cckegv.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"921", "description"=>"others"}, "user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 921], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 921], ["status", 0], ["user_id", 45], ["created_at", "2022-08-03 06:25:33.644010"], ["updated_at", "2022-08-03 06:25:33.644010"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 30]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "06gerb29gf31nc0rrui7avijhkyw"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 06:25:33.648236"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 42], ["created_at", "2022-08-03 06:25:33.649075"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 06:25:33.649554"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 06gerb29gf31nc0rrui7avijhkyw (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 30], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 6039097a-b8d8-4186-93dd-d59586ba710a) to Async(default) with arguments: #<GlobalID:0x000000010a989210 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/30>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 42]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 132)
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 15548)


[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 30], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a] Performing ActiveStorage::PurgeJob (Job ID: 6039097a-b8d8-4186-93dd-d59586ba710a) from Async(default) enqueued at 2022-08-03T06:25:33Z with arguments: #<GlobalID:0x000000010ab77428 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/30>>
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 30], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 30]]
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 30], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 30]]
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: 2ihz1g1tnkk8vt07xp4ym891gu9y[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6039097a-b8d8-4186-93dd-d59586ba710a] Performed ActiveStorage::PurgeJob (Job ID: 6039097a-b8d8-4186-93dd-d59586ba710a) from Async(default) in 24.65ms
Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:55:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.3ms | Allocations: 176)
Completed 200 OK in 257ms (Views: 1.9ms | ActiveRecord: 0.1ms | Allocations: 1528)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:55:46 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 1570)
Completed 200 OK in 5ms (Views: 1.9ms | ActiveRecord: 0.3ms | Allocations: 4360)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/2" for 127.0.0.1 at 2022-08-03 11:56:01 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010affc188>, params: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"45", "id"=>"2"} }[0m
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 1.5ms | Allocations: 239)
  Rendered layout layouts/mailer.text.erb (Duration: 1.9ms | Allocations: 463)
UserMailer#expense_update: processed outbound mail in 3.4ms
Delivered mail 62ea14f9e4625_93b4f2449878d@CALTM00564.local.mail (3741.9ms)
Date: Wed, 03 Aug 2022 11:56:01 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea14f9e4625_93b4f2449878d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email kasip09@gmail.com
expense invoice number is: 140
expense status: drafted
expense amount: 99
approved amount: 


have a great day!


Completed 500 Internal Server Error in 3753ms (ActiveRecord: 0.3ms | Allocations: 9335)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Mail::Message passed.):
  
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/45/expenses/3" for 127.0.0.1 at 2022-08-03 11:57:03 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010e00c058>, params: {"expense"=>{"amount"=>"200", "status"=>"approved"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"45", "id"=>"3"} }[0m
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 239)
  Rendered layout layouts/mailer.text.erb (Duration: 1.0ms | Allocations: 463)
UserMailer#expense_update: processed outbound mail in 2.7ms
Delivered mail 62ea153789a9c_93b4f25898839@CALTM00564.local.mail (2626.2ms)
Date: Wed, 03 Aug 2022 11:57:03 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea153789a9c_93b4f25898839@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasip09@gmail.com
expense invoice number is: 141
expense status: drafted
expense amount: 99
approved amount: .



have a great day!


Completed 500 Internal Server Error in 2639ms (ActiveRecord: 0.3ms | Allocations: 9595)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Mail::Message passed.):
  
app/controllers/expenses_controller.rb:32:in `update'
Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 11:57:43 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.3ms | Allocations: 177)
Completed 200 OK in 257ms (Views: 2.0ms | ActiveRecord: 0.1ms | Allocations: 1711)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 11:57:47 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.9ms | Allocations: 1744)
Completed 200 OK in 7ms (Views: 3.6ms | ActiveRecord: 0.4ms | Allocations: 4656)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/3" for 127.0.0.1 at 2022-08-03 11:58:18 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 20)
  Rendered layout layouts/mailer.text.erb (Duration: 0.3ms | Allocations: 126)
UserMailer#expense_update: processed outbound mail in 2.9ms
Delivered mail 62ea1584c1318_93b4f24498911@CALTM00564.local.mail (2828.0ms)
Date: Wed, 03 Aug 2022 11:58:20 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea1584c1318_93b4f24498911@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasip09@gmail.com
expense invoice number is: 141
expense status: drafted
expense amount: 99
approved amount: .



have a great day!


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 141], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 4], ["updated_at", "2022-08-03 06:28:23.624638"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.3ms | Allocations: 201)
Completed 200 OK in 4909ms (Views: 1.8ms | ActiveRecord: 2.9ms | Allocations: 14147)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 12:03:06 +0530
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 6.7ms | Allocations: 398)
Completed 200 OK in 1170ms (Views: 18.4ms | ActiveRecord: 2.5ms | Allocations: 18191)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 12:03:17 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 152.3ms | Allocations: 10821)
Completed 200 OK in 8111ms (Views: 155.8ms | ActiveRecord: 6.1ms | Allocations: 88774)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/2" for 127.0.0.1 at 2022-08-03 12:05:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"2"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000105ca6a60>, params: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"45", "id"=>"2"} }[0m
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 2253.0ms | Allocations: 7775)
  Rendered layout layouts/mailer.text.erb (Duration: 2261.8ms | Allocations: 8055)
UserMailer#expense_update: processed outbound mail in 3193.9ms
Delivered mail 62ea1755aa626_ae2df4d8-437@CALTM00564.local.mail (2699.3ms)
Date: Wed, 03 Aug 2022 12:06:05 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea1755aa626_ae2df4d8-437@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasip09@gmail.com
expense invoice number is: 140
expense status: drafted
expense amount: 99
approved amount: .



have a great day!


Completed 500 Internal Server Error in 17312ms (ActiveRecord: 4.1ms | Allocations: 157833)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Mail::Message passed.):
  
app/controllers/expenses_controller.rb:32:in `update'
Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 12:06:34 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 33.7ms | Allocations: 1546)
Completed 200 OK in 13137ms (Views: 37.8ms | ActiveRecord: 2.8ms | Allocations: 31420)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 12:07:15 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 2.6ms | Allocations: 178)
Completed 200 OK in 275ms (Views: 7.2ms | ActiveRecord: 0.8ms | Allocations: 1646)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/2" for 127.0.0.1 at 2022-08-03 12:07:23 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"2"}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:41:in `user_update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mInvoice Create (1.5ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 140], ["biller", "Skimia"], ["created_at", "2022-08-03 06:38:00.088250"], ["updated_at", "2022-08-03 06:38:00.088250"]]
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 140], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 200], ["status", 2], ["updated_at", "2022-08-03 06:38:00.146273"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.8ms | Allocations: 246)
Completed 200 OK in 37122ms (Views: 7.3ms | ActiveRecord: 11.7ms | Allocations: 188406)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 12:09:26 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 45)
Completed 200 OK in 269ms (Views: 4.5ms | ActiveRecord: 0.6ms | Allocations: 1120)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/2" for 127.0.0.1 at 2022-08-03 12:09:52 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"2"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:48:in `admin_update'
Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 12:23:55 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 12.3ms | Allocations: 10945)
Completed 200 OK in 39ms (Views: 14.4ms | ActiveRecord: 1.3ms | Allocations: 32198)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 12:24:07 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 177)
Completed 200 OK in 258ms (Views: 1.7ms | ActiveRecord: 0.1ms | Allocations: 2044)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/2" for 127.0.0.1 at 2022-08-03 12:24:13 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>"200", "status"=>"approved"}, "user_id"=>"45", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:49:in `admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 140], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 06:54:13.944828"], ["approved_amount", 200], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 1.0ms | Allocations: 285)
  Rendered layout layouts/mailer.text.erb (Duration: 1.6ms | Allocations: 519)
UserMailer#expense_update: processed outbound mail in 5.5ms
Delivered mail 62ea1b95ee8f3_e6d0f244740fc@CALTM00564.local.mail (4009.2ms)
Date: Wed, 03 Aug 2022 12:24:13 +0530
From: from@example.com
To: kasip09@gmail.com
Message-ID: <62ea1b95ee8f3_e6d0f244740fc@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasip09@gmail.com
expense invoice number is: 140
expense status: approved
expense amount: 200
approved amount: 200.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.8ms | Allocations: 260)
Completed 200 OK in 4052ms (Views: 3.8ms | ActiveRecord: 1.3ms | Allocations: 28226)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:33:14 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 4.6ms | Allocations: 2585)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 12:33:25 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 57)
Completed 200 OK in 254ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1169)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:33:29 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (1.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:03:29.425680"], ["updated_at", "2022-08-03 07:03:29.425680"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 136], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:03:29.431131"], ["report_id", 1], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 140], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:03:29.433660"], ["report_id", 1], ["id", 2]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 141], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:03:29.436172"], ["report_id", 1], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 2.1ms | Allocations: 2744)
Completed 200 OK in 18ms (Views: 2.5ms | ActiveRecord: 4.3ms | Allocations: 18205)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:38:09 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:08:09.659459"], ["updated_at", "2022-08-03 07:08:09.659459"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
Completed 500 Internal Server Error in 26ms (ActiveRecord: 2.6ms | Allocations: 19650)


  
NoMethodError (undefined method `push' for nil:NilClass

    @already_mapped_expenses.push(expense.id)
                            ^^^^^):
  
app/controllers/reports_controller.rb:36:in `log_mapped_expenses'
app/controllers/reports_controller.rb:29:in `block in map_expense_with_report'
app/controllers/reports_controller.rb:25:in `each'
app/controllers/reports_controller.rb:25:in `map_expense_with_report'
app/controllers/reports_controller.rb:11:in `create'
Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:40:36 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:10:36.317420"], ["updated_at", "2022-08-03 07:10:36.317420"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
expense 1 is already mapped with report 1
expense 2 is already mapped with report 1
expense 2 is already mapped with report 1
expense 3 is already mapped with report 1
expense 3 is already mapped with report 1
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 3]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 2.8ms | Allocations: 2290)
Completed 200 OK in 28ms (Views: 3.4ms | ActiveRecord: 2.6ms | Allocations: 21472)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:41:34 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:11:34.752055"], ["updated_at", "2022-08-03 07:11:34.752055"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
Completed 500 Internal Server Error in 33ms (ActiveRecord: 1.9ms | Allocations: 23711)


  
NoMethodError (undefined method `staus' for #<Expense id: 1, description: "others", amount: 200, date: nil, invoice_number: 136, status: "approved", user_id: 45, created_at: "2022-08-03 06:23:46.768464000 +0000", updated_at: "2022-08-03 07:03:29.431131000 +0000", report_id: 1, approved_amount: nil>
Did you mean?  status
               status=
               status?):
  
app/controllers/reports_controller.rb:26:in `block in map_expense_with_report'
app/controllers/reports_controller.rb:25:in `each'
app/controllers/reports_controller.rb:25:in `map_expense_with_report'
app/controllers/reports_controller.rb:11:in `create'
Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:42:06 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:12:07.049970"], ["updated_at", "2022-08-03 07:12:07.049970"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
expense 2 is already mapped with report 1
expense 3 is already mapped with report 1
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 5]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 1.5ms | Allocations: 2191)
Completed 200 OK in 24ms (Views: 2.0ms | ActiveRecord: 2.4ms | Allocations: 21121)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:43:09 +0530
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:13:16.999093"], ["updated_at", "2022-08-03 07:13:16.999093"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
expense 2 is already mapped with report 1
expense 3 is already mapped with report 1
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 6]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 22.9ms | Allocations: 2529)
Completed 200 OK in 7856ms (Views: 29.8ms | ActiveRecord: 10.0ms | Allocations: 88647)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:43:45 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:13:50.075597"], ["updated_at", "2022-08-03 07:13:50.075597"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
expense 2 is already mapped with report 1
expense 3 is already mapped with report 1
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 7]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 16.3ms | Allocations: 1008)
Completed 200 OK in 97118ms (Views: 21.6ms | ActiveRecord: 5.4ms | Allocations: 83210)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:45:31 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:15:40.598477"], ["updated_at", "2022-08-03 07:15:40.598477"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 1 is already mapped with report 1
expense 2 is already mapped with report 1
expense 3 is already mapped with report 1
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 8]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 28.5ms | Allocations: 2295)
Completed 200 OK in 5465ms (Views: 35.1ms | ActiveRecord: 11.7ms | Allocations: 76432)


Started GET "/api/v1/expense_tracker/users/45/reports/1" for 127.0.0.1 at 2022-08-03 12:46:00 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"45", "id"=>"1", "report"=>{}}
Started GET "/api/v1/expense_tracker/users/45/reports/1" for 127.0.0.1 at 2022-08-03 12:46:15 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"45", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 6.5ms | Allocations: 10066)
Completed 200 OK in 34ms (Views: 7.8ms | ActiveRecord: 1.6ms | Allocations: 32661)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 12:48:41 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 6.2ms | Allocations: 8679)
Completed 200 OK in 18ms (Views: 6.5ms | ActiveRecord: 1.2ms | Allocations: 21962)


Started PATCH "/api/v1/expense_tracker/users/45/expenses/5" for 127.0.0.1 at 2022-08-03 12:49:39 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>"200", "status"=>"submitted"}, "user_id"=>"45", "id"=>"5"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
[31mUnpermitted parameter: :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106315270>, params: {"expense"=>{"approved_amount"=>"200", "status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"45", "id"=>"5"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 921], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-03 07:19:41.914914"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.2ms | Allocations: 250)
Completed 200 OK in 2635ms (Views: 1.6ms | ActiveRecord: 2.5ms | Allocations: 22002)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:49:52 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:19:52.691545"], ["updated_at", "2022-08-03 07:19:52.691545"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 900], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:19:52.695670"], ["report_id", 9], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 921], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:19:52.697615"], ["report_id", 9], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:27:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 9]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 2.0ms | Allocations: 2606)
Completed 200 OK in 14ms (Views: 2.5ms | ActiveRecord: 2.7ms | Allocations: 15443)


  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 921], ["id", 5], ["LIMIT", 1]]
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 07:22:05.817294"], ["report_id", nil], ["id", 5]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
Started GET "/api/v1/expense_tracker/users/45/reports/2" for 127.0.0.1 at 2022-08-03 12:52:18 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"45", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 3.8ms | Allocations: 5258)
Completed 200 OK in 15ms (Views: 4.3ms | ActiveRecord: 1.5ms | Allocations: 19956)


Started GET "/api/v1/expense_tracker/users/45/reports/1" for 127.0.0.1 at 2022-08-03 12:55:05 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"45", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 2.2ms | Allocations: 3302)
Completed 200 OK in 6ms (Views: 2.2ms | ActiveRecord: 0.4ms | Allocations: 6693)


Started GET "/api/v1/expense_tracker/users/45/reports/9" for 127.0.0.1 at 2022-08-03 12:55:14 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"45", "id"=>"9", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 45], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:17:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 9]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 0.6ms | Allocations: 873)
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 4153)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:55:32 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[4, 5], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:25:32.334864"], ["updated_at", "2022-08-03 07:25:32.334864"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
expense 4 is already mapped with report 9
expense 4 is already mapped with report 9
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 10]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 0.4ms | Allocations: 747)
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.3ms | Allocations: 7240)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 12:55:53 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 1650)
Completed 200 OK in 4ms (Views: 2.2ms | ActiveRecord: 0.2ms | Allocations: 4662)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 12:56:16 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mReport Create (0.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 07:26:16.910243"], ["updated_at", "2022-08-03 07:26:16.910243"], ["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:10:in `create'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/controllers/reports_controller.rb:24:in `map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 11]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 0.4ms | Allocations: 745)
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 5607)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 14:47:12 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"dummy@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000106367f20>, params: {"user"=>{"email"=>"dummy@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "dummy@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 09:17:12.596900"], ["updated_at", "2022-08-03 09:17:12.596900"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 46], ["created_at", "2022-08-03 09:17:12.603064"], ["updated_at", "2022-08-03 09:17:12.603064"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.9ms | Allocations: 2064)
Completed 201 Created in 265ms (Views: 2.6ms | ActiveRecord: 2.8ms | Allocations: 14117)


Started POST "/api/v1/expense_tracker/user/login?email=Dummy@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 14:47:24 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Dummy@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1988)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=dummy@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 14:47:30 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"dummy@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.3ms | Allocations: 176)
Completed 200 OK in 253ms (Views: 1.9ms | ActiveRecord: 0.1ms | Allocations: 1692)


Started POST "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 14:48:30 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106132408 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-33027-sks5w8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"888", "description"=>"others"}, "user_id"=>"46"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 888], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 888], ["status", 0], ["user_id", 46], ["created_at", "2022-08-03 09:18:30.583981"], ["updated_at", "2022-08-03 09:18:30.583981"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 31]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "gc0k7uj82tbousfgc15vs3gx7qqo"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 09:18:30.596813"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 43], ["created_at", "2022-08-03 09:18:30.597640"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:18:30.598329"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: gc0k7uj82tbousfgc15vs3gx7qqo (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 31], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 48a63c41-1dc7-45de-bcc9-985ba7cd9ed9) to Async(default) with arguments: #<GlobalID:0x00000001067e57f0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/31>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 43]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 349)
Completed 200 OK in 47ms (Views: 1.1ms | ActiveRecord: 3.0ms | Allocations: 44075)


[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 31], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9] Performing ActiveStorage::PurgeJob (Job ID: 48a63c41-1dc7-45de-bcc9-985ba7cd9ed9) from Async(default) enqueued at 2022-08-03T09:18:30Z with arguments: #<GlobalID:0x0000000106857d78 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/31>>
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 31], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 31]]
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 31], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 31]]
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: dks73x1x80wmewv7shtwmcqkr9jv[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48a63c41-1dc7-45de-bcc9-985ba7cd9ed9] Performed ActiveStorage::PurgeJob (Job ID: 48a63c41-1dc7-45de-bcc9-985ba7cd9ed9) from Async(default) in 31.14ms
Started GET "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 14:48:55 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"46"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.4ms | Allocations: 1824)
Completed 200 OK in 3ms (Views: 1.5ms | ActiveRecord: 0.3ms | Allocations: 4405)


Started GET "/api/v1/expense_tracker/users/46/expenses/1" for 127.0.0.1 at 2022-08-03 14:49:16 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"46", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:14:in `show'
Completed 404 Not Found in 2ms (ActiveRecord: 0.2ms | Allocations: 3528)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=1 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:14:in `show'
Started GET "/api/v1/expense_tracker/users/46/expenses/1" for 127.0.0.1 at 2022-08-03 14:49:34 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"46", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:14:in `show'
Completed 404 Not Found in 2ms (ActiveRecord: 0.2ms | Allocations: 3393)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=1 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:14:in `show'
Started PATCH "/api/v1/expense_tracker/users/46/expenses/1" for 127.0.0.1 at 2022-08-03 14:50:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "status"=>"submitted"}, "user_id"=>"46", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `user_update'
Completed 404 Not Found in 4ms (ActiveRecord: 0.2ms | Allocations: 4504)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=1 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:42:in `user_update'
app/controllers/expenses_controller.rb:31:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/expenses/6" for 127.0.0.1 at 2022-08-03 14:51:05 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>100, "status"=>"submitted"}, "user_id"=>"46", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:42:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mInvoice Create (0.2ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 888], ["biller", "Oyope"], ["created_at", "2022-08-03 09:21:07.849597"], ["updated_at", "2022-08-03 09:21:07.849597"]]
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:71:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 888], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 100], ["status", 2], ["updated_at", "2022-08-03 09:21:07.853402"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.1ms | Allocations: 150)
Completed 200 OK in 1936ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 21884)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 14:52:19 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 200 OK in 252ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1115)


Started GET "/api/v1/expense_tracker/users/45/expenses" for 127.0.0.1 at 2022-08-03 14:52:37 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"45"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 3.0ms | Allocations: 1456)
Completed 200 OK in 6ms (Views: 2.1ms | ActiveRecord: 1.3ms | Allocations: 3922)


Started GET "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 14:52:46 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"46"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 3.6ms | Allocations: 876)
Completed 200 OK in 6ms (Views: 3.7ms | ActiveRecord: 0.2ms | Allocations: 3328)


Started PATCH "/api/v1/expense_tracker/users/46/expenses/6" for 127.0.0.1 at 2022-08-03 14:53:29 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved"}, "user_id"=>"46", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:49:in `admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 888], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 09:23:29.510443"], ["approved_amount", 50], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:32:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 247)
  Rendered layout layouts/mailer.text.erb (Duration: 0.9ms | Allocations: 469)
UserMailer#expense_update: processed outbound mail in 5.0ms
Delivered mail 62ea3e9182a16_8103f244626db@CALTM00564.local.mail (3151.4ms)
Date: Wed, 03 Aug 2022 14:53:29 +0530
From: from@example.com
To: dummy@gmail.com
Message-ID: <62ea3e9182a16_8103f244626db@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: dummy@gmail.com
expense invoice number is: 888
expense status: approved
expense amount: 100
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 154)
Completed 200 OK in 3181ms (Views: 1.0ms | ActiveRecord: 1.3ms | Allocations: 32311)


Started POST "/api/v1/expense_tracker/user/login?email=Dummy@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 14:54:41 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Dummy@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1684)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=dummy@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 14:54:49 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"dummy@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 46)
Completed 200 OK in 252ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1078)


Started POST "/api/v1/expense_tracker/users/45/reports" for 127.0.0.1 at 2022-08-03 14:55:00 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[6], "user_id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 2ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 2575)


Started POST "/api/v1/expense_tracker/users/46/reports" for 127.0.0.1 at 2022-08-03 14:55:12 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[6], "user_id"=>"46", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (0.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 09:25:12.711918"], ["updated_at", "2022-08-03 09:25:12.711918"], ["user_id", 46]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/controllers/reports_controller.rb:30:in `map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 12]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 1.2ms | Allocations: 2192)
Completed 200 OK in 8ms (Views: 1.6ms | ActiveRecord: 1.3ms | Allocations: 8961)


Started POST "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 14:55:34 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010713e0e0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-33027-z6zd7q.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"890", "description"=>"others"}, "user_id"=>"46"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 890], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 890], ["status", 0], ["user_id", 46], ["created_at", "2022-08-03 09:25:34.887586"], ["updated_at", "2022-08-03 09:25:34.887586"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 32]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "96v02b1n8z0momhdmf3bbclpcfu0"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 09:25:34.891417"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 44], ["created_at", "2022-08-03 09:25:34.892395"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:25:34.893263"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 96v02b1n8z0momhdmf3bbclpcfu0 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 32], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 48b1e533-292a-4d40-9a13-d1d0fe54371b) to Async(default) with arguments: #<GlobalID:0x000000010727d960 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/32>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 44]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 138)
Completed 200 OK in 18ms (Views: 0.5ms | ActiveRecord: 2.0ms | Allocations: 15667)


[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 32], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b] Performing ActiveStorage::PurgeJob (Job ID: 48b1e533-292a-4d40-9a13-d1d0fe54371b) from Async(default) enqueued at 2022-08-03T09:25:34Z with arguments: #<GlobalID:0x00000001072de558 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/32>>
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 32], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 32]]
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 32], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 32]]
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: h6smy01p5f4p6f0bkx1tmudmn5mc[0m
[ActiveJob] [ActiveStorage::PurgeJob] [48b1e533-292a-4d40-9a13-d1d0fe54371b] Performed ActiveStorage::PurgeJob (Job ID: 48b1e533-292a-4d40-9a13-d1d0fe54371b) from Async(default) in 23.7ms
Started POST "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 14:55:42 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000104c9da60 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-33027-cvoeps.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"892", "description"=>"others"}, "user_id"=>"46"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 892], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 892], ["status", 0], ["user_id", 46], ["created_at", "2022-08-03 09:25:42.398929"], ["updated_at", "2022-08-03 09:25:42.398929"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 33]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "nu017pt1u180jgbu2gsjjzfy4xuk"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 09:25:42.402010"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 45], ["created_at", "2022-08-03 09:25:42.402689"]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:25:42.403388"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: nu017pt1u180jgbu2gsjjzfy4xuk (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 84b6b044-7e31-42da-aca0-102ea556b3b9) to Async(default) with arguments: #<GlobalID:0x0000000105ed7ca8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/33>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 45]]
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:20:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 132)
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 15298)


[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 33], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9] Performing ActiveStorage::PurgeJob (Job ID: 84b6b044-7e31-42da-aca0-102ea556b3b9) from Async(default) enqueued at 2022-08-03T09:25:42Z with arguments: #<GlobalID:0x000000010604a950 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/33>>
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 33], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 33]]
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 33], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 33]]
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9] [36m  Disk Storage (0.1ms) [0m[31mDeleted file from key: g3bvzl1stuglk57d0sit0pnwuk1l[0m
[ActiveJob] [ActiveStorage::PurgeJob] [84b6b044-7e31-42da-aca0-102ea556b3b9] Performed ActiveStorage::PurgeJob (Job ID: 84b6b044-7e31-42da-aca0-102ea556b3b9) from Async(default) in 23.54ms
Started POST "/api/v1/expense_tracker/users/46/reports" for 127.0.0.1 at 2022-08-03 14:55:55 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[7, 8], "user_id"=>"46", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (0.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 09:25:55.458570"], ["updated_at", "2022-08-03 09:25:55.458570"], ["user_id", 46]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/controllers/reports_controller.rb:30:in `map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:25:55.463915"], ["report_id", 13], ["id", 7]]
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:25:55.467258"], ["report_id", 13], ["id", 8]]
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 1.1ms | Allocations: 1030)
Completed 200 OK in 14ms (Views: 1.2ms | ActiveRecord: 3.3ms | Allocations: 11214)


Started GET "/api/v1/expense_tracker/users/46/reports/7" for 127.0.0.1 at 2022-08-03 14:56:31 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"7", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3618)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=7 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/1" for 127.0.0.1 at 2022-08-03 15:08:18 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"1", "report"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 5ms (ActiveRecord: 1.1ms | Allocations: 4139)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=1 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/2" for 127.0.0.1 at 2022-08-03 15:08:21 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=2 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/3" for 127.0.0.1 at 2022-08-03 15:08:24 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"3", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=3 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/4" for 127.0.0.1 at 2022-08-03 15:08:28 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"4", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=4 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/5" for 127.0.0.1 at 2022-08-03 15:08:31 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"5", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=5 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/6" for 127.0.0.1 at 2022-08-03 15:08:34 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"6", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.3ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=6 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/7" for 127.0.0.1 at 2022-08-03 15:08:37 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"7", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=7 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/8" for 127.0.0.1 at 2022-08-03 15:08:40 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"8", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.2ms | Allocations: 3501)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=8 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:15:in `show'
Started GET "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:08:52 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 1.0ms | Allocations: 1065)
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.6ms | Allocations: 4371)


Started POST "/api/v1/expense_tracker/users/46/expenses" for 127.0.0.1 at 2022-08-03 15:20:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"99", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010714ee68 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-33027-ydyso.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"891", "description"=>"others"}, "user_id"=>"46"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 891], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 99], ["date", nil], ["invoice_number", 891], ["status", 0], ["user_id", 46], ["created_at", "2022-08-03 09:50:14.632875"], ["updated_at", "2022-08-03 09:50:14.632875"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 34]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "agbt2mc61qqp8hadi8muf3obpzac"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 09:50:14.641145"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 9], ["blob_id", 46], ["created_at", "2022-08-03 09:50:14.642499"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 09:50:14.643054"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: agbt2mc61qqp8hadi8muf3obpzac (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 34], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: e7a572ee-48d9-442e-bd8e-585b03b190e8) to Async(default) with arguments: #<GlobalID:0x00000001061a9210 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/34>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 46]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 221)
Completed 200 OK in 53ms (Views: 0.8ms | ActiveRecord: 3.5ms | Allocations: 39903)


[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 34], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8] Performing ActiveStorage::PurgeJob (Job ID: e7a572ee-48d9-442e-bd8e-585b03b190e8) from Async(default) enqueued at 2022-08-03T09:50:14Z with arguments: #<GlobalID:0x0000000106415418 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/34>>
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 34], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 34]]
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 34], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 34]]
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: 2cy95kz46h5fpqwssou0989bpil4[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e7a572ee-48d9-442e-bd8e-585b03b190e8] Performed ActiveStorage::PurgeJob (Job ID: e7a572ee-48d9-442e-bd8e-585b03b190e8) from Async(default) in 27.23ms
Started PATCH "/api/v1/expense_tracker/users/46/expenses/6" for 127.0.0.1 at 2022-08-03 15:21:22 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submit"}, "user_id"=>"46", "id"=>"6"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 15ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 16760)


Started PATCH "/api/v1/expense_tracker/users/46/expenses/9" for 127.0.0.1 at 2022-08-03 15:21:41 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"46", "id"=>"9"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 891], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-03 09:51:43.853225"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 149)
Completed 200 OK in 2106ms (Views: 0.7ms | ActiveRecord: 2.5ms | Allocations: 12297)


Started PATCH "/api/v1/expense_tracker/users/46/expenses/10" for 127.0.0.1 at 2022-08-03 15:23:17 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"46", "id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
Completed 404 Not Found in 23ms (ActiveRecord: 1.4ms | Allocations: 22105)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=10 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/expenses/8" for 127.0.0.1 at 2022-08-03 15:23:24 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"46", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (1.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 892], ["biller", "Skaboo"], ["created_at", "2022-08-03 09:53:26.361249"], ["updated_at", "2022-08-03 09:53:26.361249"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-03 09:53:26.378327"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.1ms | Allocations: 353)
Completed 200 OK in 2087ms (Views: 1.9ms | ActiveRecord: 4.2ms | Allocations: 22931)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:32:53 +0530
  [1m[35m (1.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [PATCH] "/api/v1/expense_tracker/users/46/reports/13"):
  
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:33:31 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to update? this User>
Completed 403 Forbidden in 9408ms (Views: 2.4ms | ActiveRecord: 7.5ms | Allocations: 49760)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 15:33:51 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 2.8ms | Allocations: 204)
Completed 200 OK in 277ms (Views: 7.9ms | ActiveRecord: 0.8ms | Allocations: 2215)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:34:15 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to update? this User>
Completed 403 Forbidden in 7298ms (Views: 2.2ms | ActiveRecord: 3.3ms | Allocations: 34258)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 15:34:37 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 56)
Completed 200 OK in 271ms (Views: 4.4ms | ActiveRecord: 0.7ms | Allocations: 1234)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:35:31 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to update? this User>
Completed 403 Forbidden in 113535ms (Views: 2.0ms | ActiveRecord: 3.0ms | Allocations: 44360)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:43:58 +0530
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 45]]
  ↳ app/models/user.rb:25:in `admin?'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 10932ms (Views: 1.1ms | ActiveRecord: 6.4ms | Allocations: 75413)


Started POST "/api/v1/expense_tracker/user/login?email=kasip09@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 15:44:28 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasip09@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasip09@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 81)
Completed 200 OK in 272ms (Views: 6.4ms | ActiveRecord: 0.8ms | Allocations: 1776)


Started POST "/api/v1/expense_tracker/user/login?email=dummy@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 15:44:32 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"dummy@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "dummy@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 44)
Completed 200 OK in 266ms (Views: 4.7ms | ActiveRecord: 0.6ms | Allocations: 1189)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:44:42 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
Completed 500 Internal Server Error in 59663ms (ActiveRecord: 9.5ms | Allocations: 106556)


  
ActiveModel::UnknownAttributeError (unknown attribute 'satus' for Expense.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/models/report.rb:13:in `block in update'
app/models/report.rb:12:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:46:13 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
Completed 500 Internal Server Error in 7125ms (ActiveRecord: 16.4ms | Allocations: 95646)


  
ActiveModel::UnknownAttributeError (unknown attribute 'satuts' for Expense.

          raise UnknownAttributeError.new(self, k.to_s)
          ^^^^^):
  
app/models/report.rb:13:in `block in update'
app/models/report.rb:12:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:46:34 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-03 10:16:42.480750"], ["id", 7]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-03 10:16:43.299066"], ["id", 8]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE Expense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:48:20 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
Completed 500 Internal Server Error in 8018ms (ActiveRecord: 18.3ms | Allocations: 118351)


  
ArgumentError ('{:status=>"submitted"}' is not a valid status):
  
app/models/report.rb:13:in `block in update'
app/models/report.rb:12:in `update'
app/models/report.rb:15:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:49:59 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
Completed 500 Internal Server Error in 8493ms (ActiveRecord: 18.7ms | Allocations: 105695)


  
ArgumentError ('{:status=>"submitted"}' is not a valid status):
  
app/models/report.rb:13:in `block in update'
app/models/report.rb:12:in `update'
app/models/report.rb:15:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:50:30 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
Completed 500 Internal Server Error in 6280ms (ActiveRecord: 18.9ms | Allocations: 83543)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, String passed.):
  
app/models/report.rb:15:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:51:05 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update'
Completed 500 Internal Server Error in 5844ms (ActiveRecord: 18.7ms | Allocations: 80869)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, String passed.):
  
app/models/report.rb:15:in `update'
app/controllers/reports_controller.rb:22:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:52:02 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:21:in `update'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:12:in `update_report_expenses'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:13:in `block in update_report_expenses'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:15:in `update_report_expenses'
  [1m[36mReport Update (1.0ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-03 10:22:13.745280"], ["id", 13]]
  ↳ app/models/report.rb:15:in `update_report_expenses'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:15:in `update_report_expenses'
No template found for ReportsController#update, rendering head :no_content
Completed 204 No Content in 9961ms (ActiveRecord: 22.4ms | Allocations: 128119)


Started GET "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:52:30 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Started GET "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 15:52:47 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 8.0ms | Allocations: 9927)
Completed 200 OK in 33ms (Views: 9.0ms | ActiveRecord: 1.7ms | Allocations: 32540)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:48:22 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:15:in `update_report_status'
Completed 500 Internal Server Error in 38ms (ActiveRecord: 1.3ms | Allocations: 26419)


  
NameError (undefined local variable or method `invoice_validator_response' for #<Report id: 13, status: "verified", created_at: "2022-08-03 09:25:55.458570000 +0000", updated_at: "2022-08-03 10:22:13.745280000 +0000", user_id: 46>):
  
app/models/report.rb:16:in `block in update_report_status'
app/models/report.rb:15:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:51:31 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:15:in `update_report_status'
Completed 500 Internal Server Error in 18692ms (ActiveRecord: 14.4ms | Allocations: 130463)


  
NameError (undefined local variable or method `invoice_validator_response' for #<Report id: 13, status: "verified", created_at: "2022-08-03 09:25:55.458570000 +0000", updated_at: "2022-08-03 10:22:13.745280000 +0000", user_id: 46>):
  
app/models/report.rb:16:in `block in update_report_status'
app/models/report.rb:15:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:52:15 +0530
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:15:in `update_report_status'
Completed 500 Internal Server Error in 20502ms (ActiveRecord: 5.0ms | Allocations: 98981)


  
NameError (undefined local variable or method `invoice_validator_response' for #<Report id: 13, status: "verified", created_at: "2022-08-03 09:25:55.458570000 +0000", updated_at: "2022-08-03 10:22:13.745280000 +0000", user_id: 46>):
  
app/models/report.rb:16:in `block in update_report_status'
app/models/report.rb:15:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:53:09 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:17:in `update_report_status'
Completed 500 Internal Server Error in 46485ms (ActiveRecord: 16.1ms | Allocations: 114140)


  
NoMethodError (undefined method `invoice_number' for nil:NilClass

    requets_body = '{"invoice_id":'"#{@expense.invoice_number}"'}'
                                              ^^^^^^^^^^^^^^^):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:18:in `block in update_report_status'
app/models/report.rb:17:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:54:57 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-03 12:25:17.662187"], ["id", 7]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-03 12:25:24.488664"], ["id", 8]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mReport Update (0.7ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", nil], ["updated_at", "2022-08-03 12:25:25.046562"], ["id", 13]]
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
Completed 500 Internal Server Error in 27278ms (ActiveRecord: 22.3ms | Allocations: 155165)


  
NameError (undefined local variable or method `current_user' for #<Report id: 13, status: nil, created_at: "2022-08-03 09:25:55.458570000 +0000", updated_at: "2022-08-03 12:25:25.046562000 +0000", user_id: 46>):
  
app/models/report.rb:27:in `notify_report_update'
app/models/report.rb:23:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:56:14 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 46]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 13]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 890], ["id", 7], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 892], ["id", 8], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mReport Update (0.9ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", nil], ["updated_at", "2022-08-03 12:26:29.205388"], ["id", 13]]
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
Completed 500 Internal Server Error in 13163ms (ActiveRecord: 17.8ms | Allocations: 147373)


  
NoMethodError (undefined method `report_update' for #<ActionMailer::Parameterized::Mailer:0x0000000108f68a98 @mailer=UserMailer, @params={:user=>#<User id: 46, name: "kasi", department: "Engineering", status: "active", email: "dummy@gmail.com", password_digest: [FILTERED], created_at: "2022-08-03 09:17:12.596900000 +0000", updated_at: "2022-08-03 09:17:12.596900000 +0000">, :expense=>#<Report id: 13, status: nil, created_at: "2022-08-03 09:25:55.458570000 +0000", updated_at: "2022-08-03 12:26:29.205388000 +0000", user_id: 46>}>):
  
app/models/report.rb:27:in `notify_report_update'
app/models/report.rb:23:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started POST "/api/v1/expense_tracker/user/login?email=Mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 17:57:22 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 2.8ms | Allocations: 231)
Completed 200 OK in 274ms (Views: 9.0ms | ActiveRecord: 0.7ms | Allocations: 2272)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:57:30 +0530
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 19628ms (ActiveRecord: 4.3ms | Allocations: 70397)


  
NameError (uninitialized constant ReportsController::Json

   json_object = Json.parse(params[:expenses])
                 ^^^^
Did you mean?  JSON):
  
app/controllers/reports_controller.rb:31:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 17:58:17 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 6880ms (ActiveRecord: 11.7ms | Allocations: 71527)


  
TypeError (no implicit conversion of Array into String):
  
app/controllers/reports_controller.rb:31:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:01:13 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/controllers/reports_controller.rb:34: syntax error, unexpected ')'
... JSON.parse(params[:expenses].)
...                              ^
):
  
app/controllers/reports_controller.rb:34: syntax error, unexpected ')'
app/controllers/reports_controller.rb:34: syntax error, unexpected ')'
app/controllers/reports_controller.rb:34: syntax error, unexpected ')'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:01:36 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 22ms (ActiveRecord: 1.5ms | Allocations: 22012)


  
TypeError (no implicit conversion of Array into String):
  
app/controllers/reports_controller.rb:34:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:01:51 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 13ms (ActiveRecord: 1.3ms | Allocations: 15663)


  
TypeError (no implicit conversion of Array into String):
  
app/controllers/reports_controller.rb:34:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:03:52 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 14ms (ActiveRecord: 1.5ms | Allocations: 15575)


  
TypeError (no implicit conversion of Array into String):
  
app/controllers/reports_controller.rb:37:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:04:26 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>1, "status"=>"approved", "approved_amount"=>100}, {"id"=>2, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"46", "id"=>"13", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 46], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 43]]
  ↳ app/models/user.rb:25:in `admin?'
Completed 500 Internal Server Error in 14ms (ActiveRecord: 1.8ms | Allocations: 15558)


  
TypeError (no implicit conversion of Array into String):
  
app/controllers/reports_controller.rb:37:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 18:10:08 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010a5b7678>, params: {"user"=>{"email"=>"admin@gmail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "admin@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 12:40:08.520211"], ["updated_at", "2022-08-03 12:40:08.520211"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 47], ["created_at", "2022-08-03 12:40:08.527131"], ["updated_at", "2022-08-03 12:40:08.527131"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 47], ["created_at", "2022-08-03 12:40:08.529304"], ["updated_at", "2022-08-03 12:40:08.529304"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.7ms | Allocations: 2227)
Completed 201 Created in 263ms (Views: 2.4ms | ActiveRecord: 3.8ms | Allocations: 18337)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 18:11:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"david@gmail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010989ee78>, params: {"user"=>{"email"=>"david@gmail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "david"], ["department", "Engineering"], ["status", 1], ["email", "david@gmail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 12:41:52.158130"], ["updated_at", "2022-08-03 12:41:52.158130"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 48], ["created_at", "2022-08-03 12:41:52.161418"], ["updated_at", "2022-08-03 12:41:52.161418"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.6ms | Allocations: 853)
Completed 201 Created in 258ms (Views: 1.7ms | ActiveRecord: 2.8ms | Allocations: 6111)


Started POST "/api/v1/expense_tracker/user/login?email=david@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:12:30 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.6ms | Allocations: 178)
Completed 200 OK in 256ms (Views: 1.4ms | ActiveRecord: 0.1ms | Allocations: 1989)


Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:13:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a1257e0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-q5qj8m.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"others"}, "user_id"=>"48"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "others"], ["amount", 100], ["date", nil], ["invoice_number", 1], ["status", 0], ["user_id", 48], ["created_at", "2022-08-03 12:43:14.351855"], ["updated_at", "2022-08-03 12:43:14.351855"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 38]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "wdvggu1hsanhil0vhxq9tlw6jyrg"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 12:43:14.364530"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 47], ["created_at", "2022-08-03 12:43:14.365502"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:43:14.366310"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: wdvggu1hsanhil0vhxq9tlw6jyrg (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 38], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 39db2264-10d8-4396-a1af-2e5f3a2f6360) to Async(default) with arguments: #<GlobalID:0x000000010aea7558 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/38>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 47]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.7ms | Allocations: 345)
Completed 200 OK in 49ms (Views: 1.4ms | ActiveRecord: 3.6ms | Allocations: 46589)


[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 38], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360] Performing ActiveStorage::PurgeJob (Job ID: 39db2264-10d8-4396-a1af-2e5f3a2f6360) from Async(default) enqueued at 2022-08-03T12:43:14Z with arguments: #<GlobalID:0x000000010af27a50 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/38>>
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 38], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 38]]
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 38], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 38]]
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: mjtq216gfskyv4zr197x2ayh1j83[0m
[ActiveJob] [ActiveStorage::PurgeJob] [39db2264-10d8-4396-a1af-2e5f3a2f6360] Performed ActiveStorage::PurgeJob (Job ID: 39db2264-10d8-4396-a1af-2e5f3a2f6360) from Async(default) in 29.66ms
Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:14:06 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b024340 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-1ul0g8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Travel"}, "user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 101], ["date", nil], ["invoice_number", 2], ["status", 0], ["user_id", 48], ["created_at", "2022-08-03 12:44:06.281718"], ["updated_at", "2022-08-03 12:44:06.281718"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 39]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "4u076q1oprm8p10t6s76vmv3al5w"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 12:44:06.285982"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 48], ["created_at", "2022-08-03 12:44:06.286765"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:44:06.287284"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 4u076q1oprm8p10t6s76vmv3al5w (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: fea14fee-5e63-40ce-93e3-287022cf885d) to Async(default) with arguments: #<GlobalID:0x000000010b1255c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/39>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 48]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 148)
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 15647)


[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 39], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d] Performing ActiveStorage::PurgeJob (Job ID: fea14fee-5e63-40ce-93e3-287022cf885d) from Async(default) enqueued at 2022-08-03T12:44:06Z with arguments: #<GlobalID:0x000000010b185630 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/39>>
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 39], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 39]]
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mActiveStorage::Attachment Load (1.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 39], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 39]]
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 7by2ckcvwechx6x4w429gyllbqr8[0m
[ActiveJob] [ActiveStorage::PurgeJob] [fea14fee-5e63-40ce-93e3-287022cf885d] Performed ActiveStorage::PurgeJob (Job ID: fea14fee-5e63-40ce-93e3-287022cf885d) from Async(default) in 24.9ms
Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:14:53 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b20ca68 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-u7415b.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"Travel"}, "user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 101], ["date", nil], ["invoice_number", 3], ["status", 0], ["user_id", 48], ["created_at", "2022-08-03 12:44:53.142504"], ["updated_at", "2022-08-03 12:44:53.142504"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 40]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "hqu4yfhmr2dc2yveaoox7arh7ujo"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 12:44:53.145914"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 49], ["created_at", "2022-08-03 12:44:53.146630"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:44:53.147135"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: hqu4yfhmr2dc2yveaoox7arh7ujo (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 169daaac-8293-44bd-b04b-da539b80b059) to Async(default) with arguments: #<GlobalID:0x000000010b304ad8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/40>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 49]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 257)
Completed 200 OK in 15ms (Views: 1.0ms | ActiveRecord: 2.3ms | Allocations: 15932)


[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 40], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059] Performing ActiveStorage::PurgeJob (Job ID: 169daaac-8293-44bd-b04b-da539b80b059) from Async(default) enqueued at 2022-08-03T12:44:53Z with arguments: #<GlobalID:0x000000010b375cb0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/40>>
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 40], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 40]]
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 40], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 40]]
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: 9fe29fqdl65td6u3py0xxuwyw9dq[0m
[ActiveJob] [ActiveStorage::PurgeJob] [169daaac-8293-44bd-b04b-da539b80b059] Performed ActiveStorage::PurgeJob (Job ID: 169daaac-8293-44bd-b04b-da539b80b059) from Async(default) in 24.34ms
Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:15:07 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b407868 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-upblcb.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"Travel"}, "user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 101], ["date", nil], ["invoice_number", 4], ["status", 0], ["user_id", 48], ["created_at", "2022-08-03 12:45:07.010169"], ["updated_at", "2022-08-03 12:45:07.010169"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 41]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "82oj0adb4tmd7i3v7eskisf20dro"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 12:45:07.013309"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 50], ["created_at", "2022-08-03 12:45:07.014272"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:45:07.014844"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 82oj0adb4tmd7i3v7eskisf20dro (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5) to Async(default) with arguments: #<GlobalID:0x000000010b4fd790 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/41>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 50]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.3ms | Allocations: 230)
Completed 200 OK in 15ms (Views: 0.8ms | ActiveRecord: 1.8ms | Allocations: 16095)


[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5] Performing ActiveStorage::PurgeJob (Job ID: 71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5) from Async(default) enqueued at 2022-08-03T12:45:07Z with arguments: #<GlobalID:0x000000010b56eaf8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/41>>
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 41], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 41]]
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 41], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mActiveStorage::Blob Destroy (16.9ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 41]]
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5] [36m  Disk Storage (0.2ms) [0m[31mDeleted file from key: j1015mbin26pz1f3g2ln0rzkcfq9[0m
[ActiveJob] [ActiveStorage::PurgeJob] [71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5] Performed ActiveStorage::PurgeJob (Job ID: 71d68cb0-f5b5-4f4d-8ca5-b5170f2b32f5) from Async(default) in 22.97ms
Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:15:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b5f4ec8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-9ynqwd.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel"}, "user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 101], ["date", nil], ["invoice_number", 5], ["status", 0], ["user_id", 48], ["created_at", "2022-08-03 12:45:11.862236"], ["updated_at", "2022-08-03 12:45:11.862236"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 42]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "k6or2w9lgp98idb438hslwlz20jn"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 12:45:11.868061"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 51], ["created_at", "2022-08-03 12:45:11.877112"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:45:11.878004"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: k6or2w9lgp98idb438hslwlz20jn (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 9dfeb615-f8a9-4d5a-a0da-279187b8c94b) to Async(default) with arguments: #<GlobalID:0x0000000105bf92e8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/42>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 51]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 89)
Completed 200 OK in 29ms (Views: 0.6ms | ActiveRecord: 3.2ms | Allocations: 15513)


[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 42], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b] Performing ActiveStorage::PurgeJob (Job ID: 9dfeb615-f8a9-4d5a-a0da-279187b8c94b) from Async(default) enqueued at 2022-08-03T12:45:11Z with arguments: #<GlobalID:0x00000001061943d8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/42>>
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 42], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 42]]
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 42], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mActiveStorage::Blob Destroy (17.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 42]]
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b] [36m  Disk Storage (0.1ms) [0m[31mDeleted file from key: 06gerb29gf31nc0rrui7avijhkyw[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9dfeb615-f8a9-4d5a-a0da-279187b8c94b] Performed ActiveStorage::PurgeJob (Job ID: 9dfeb615-f8a9-4d5a-a0da-279187b8c94b) from Async(default) in 23.9ms
Started GET "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:15:28 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 2543)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.3ms | Allocations: 5366)


Started GET "/api/v1/expense_tracker/users/48/expenses/1" for 127.0.0.1 at 2022-08-03 18:15:45 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"48", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:15:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 1.8ms | Allocations: 251)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.2ms | Allocations: 3625)


Started GET "/api/v1/expense_tracker/users/48/expenses/2" for 127.0.0.1 at 2022-08-03 18:15:51 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"48", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:15:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.2ms | Allocations: 167)
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 3360)


Started GET "/api/v1/expense_tracker/users/48/expenses/3" for 127.0.0.1 at 2022-08-03 18:15:54 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"48", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:15:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.2ms | Allocations: 167)
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 3353)


Started PATCH "/api/v1/expense_tracker/users/48/expenses/1" for 127.0.0.1 at 2022-08-03 18:16:37 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>150, "status"=>"submitted"}, "user_id"=>"48", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 1919ms (ActiveRecord: 0.2ms | Allocations: 17902)


  
NameError (undefined local variable or method `notify_user' for #<ExpensesController:0x00000000041d48>

        notify_user
        ^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:66:in `expense_pre_processing'
app/controllers/expenses_controller.rb:45:in `user_update'
app/controllers/expenses_controller.rb:32:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/expenses/1" for 127.0.0.1 at 2022-08-03 18:18:28 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>150, "status"=>"submitted"}, "user_id"=>"48", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 150], ["status", 4], ["updated_at", "2022-08-03 12:48:30.871269"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.3ms | Allocations: 274)
Completed 200 OK in 2082ms (Views: 2.3ms | ActiveRecord: 4.3ms | Allocations: 27015)


Started POST "/api/v1/expense_tracker/user/login?email=admin@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:19:04 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 176)
Completed 200 OK in 253ms (Views: 1.9ms | ActiveRecord: 0.1ms | Allocations: 1936)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:19:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.1ms | Allocations: 1728)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=mike@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:19:49 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.1ms | Allocations: 1593)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=david@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:19:56 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 200 OK in 248ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1079)


Started PATCH "/api/v1/expense_tracker/users/48/expenses/2" for 127.0.0.1 at 2022-08-03 18:20:11 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"48", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.6ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 2], ["biller", "Twimm"], ["created_at", "2022-08-03 12:50:13.897525"], ["updated_at", "2022-08-03 12:50:13.897525"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-03 12:50:13.903585"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.6ms | Allocations: 149)
Completed 200 OK in 2898ms (Views: 0.9ms | ActiveRecord: 3.6ms | Allocations: 21350)


Started POST "/api/v1/expense_tracker/user/login?email=admin@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:22:48 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 200 OK in 251ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 1122)


Started GET "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:23:00 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.5ms | Allocations: 2315)
Completed 200 OK in 4ms (Views: 1.6ms | ActiveRecord: 0.3ms | Allocations: 4779)


Started PATCH "/api/v1/expense_tracker/users/48/expenses/2" for 127.0.0.1 at 2022-08-03 18:23:54 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>"50", "status"=>"approved"}, "user_id"=>"48", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:50:in `admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 12:53:54.687253"], ["approved_amount", 50], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 247)
  Rendered layout layouts/mailer.text.erb (Duration: 1.0ms | Allocations: 469)
UserMailer#expense_update: processed outbound mail in 5.7ms
Delivered mail 62ea6fe2ae759_ddd5f26c865d@CALTM00564.local.mail (4049.2ms)
Date: Wed, 03 Aug 2022 18:23:54 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea6fe2ae759_ddd5f26c865d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: david@gmail.com
expense invoice number is: 2
expense status: approved
expense amount: 101
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.7ms | Allocations: 154)
Completed 200 OK in 4086ms (Views: 2.0ms | ActiveRecord: 1.4ms | Allocations: 32300)


Started GET "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:24:08 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.1ms | Allocations: 1475)
Completed 200 OK in 3ms (Views: 1.3ms | ActiveRecord: 0.2ms | Allocations: 4092)


Started POST "/api/v1/expense_tracker/users/48/reports" for 127.0.0.1 at 2022-08-03 18:24:53 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"48", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 2535)


Started POST "/api/v1/expense_tracker/user/login?email=david@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:25:09 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 56)
Completed 200 OK in 256ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1122)


Started POST "/api/v1/expense_tracker/users/48/reports" for 127.0.0.1 at 2022-08-03 18:25:12 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"48", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-03 12:55:12.818759"], ["updated_at", "2022-08-03 12:55:12.818759"], ["user_id", 48]]
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:8:in `create'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/controllers/reports_controller.rb:42:in `map_expense_with_report'
expense 1 is already mapped with report 
expense 2 is already mapped with report 
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:45:in `block in map_expense_with_report'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:45:in `block in map_expense_with_report'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 12:55:12.824848"], ["report_id", 1], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:45:in `block in map_expense_with_report'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:45:in `block in map_expense_with_report'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 2.6ms | Allocations: 2465)
Completed 200 OK in 15ms (Views: 3.6ms | ActiveRecord: 3.2ms | Allocations: 12300)


Started GET "/api/v1/expense_tracker/users/46/reports/1" for 127.0.0.1 at 2022-08-03 18:25:25 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"46", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 2ms (ActiveRecord: 0.1ms | Allocations: 1745)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=46):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/reports_controller.rb:13:in `show'
Started GET "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:25:49 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 1.8ms | Allocations: 957)
Completed 200 OK in 5ms (Views: 1.9ms | ActiveRecord: 0.4ms | Allocations: 4464)


Started PATCH "/api/v1/expense_tracker/users/46/reports/13" for 127.0.0.1 at 2022-08-03 18:27:01 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"46", "id"=>"13", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 1ms (ActiveRecord: 0.1ms | Allocations: 1665)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=46):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:27:13 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Update (2.0ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-03 12:57:15.469252"], ["id", 3]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mReport Update (0.4ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-03 12:57:15.474804"], ["id", 1]]
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
Completed 500 Internal Server Error in 1745ms (ActiveRecord: 4.9ms | Allocations: 14542)


  
NoMethodError (undefined method `report_update' for #<ActionMailer::Parameterized::Mailer:0x000000010b2be100 @mailer=UserMailer, @params={:user=>#<User id: 48, name: "david", department: "Engineering", status: "active", email: "david@gmail.com", password_digest: [FILTERED], created_at: "2022-08-03 12:41:52.158130000 +0000", updated_at: "2022-08-03 12:41:52.158130000 +0000">, :expense=>#<Report id: 1, status: "submitted", created_at: "2022-08-03 12:55:12.818759000 +0000", updated_at: "2022-08-03 12:57:15.474804000 +0000", user_id: 48>}>):
  
app/models/report.rb:27:in `notify_report_update'
app/models/report.rb:23:in `update_report_status'
app/controllers/reports_controller.rb:27:in `user_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:29:44 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mReport Update (0.5ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-03 12:59:46.019692"], ["id", 1]]
  ↳ app/models/report.rb:23:in `update_report_status'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.4ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 1.2ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 4.5ms
Delivered mail 62ea714289cb_ddd5f26c875a@CALTM00564.local.mail (2811.7ms)
Date: Wed, 03 Aug 2022 18:29:46 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea714289cb_ddd5f26c875a@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (3.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:23:in `update_report_status'
No template found for ReportsController#update, rendering head :no_content
Completed 204 No Content in 4550ms (ActiveRecord: 6.0ms | Allocations: 38358)


Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:30:55 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1.3ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 2.1ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 5.0ms
Delivered mail 62ea718992d4a_ddd5f21c88b9@CALTM00564.local.mail (2684.2ms)
Date: Wed, 03 Aug 2022 18:30:57 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea718992d4a_ddd5f21c88b9@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 0.7ms | Allocations: 230)
Completed 200 OK in 4613ms (Views: 2.4ms | ActiveRecord: 1.1ms | Allocations: 16449)


Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:32:20 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.7ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 1.8ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 4.1ms
Delivered mail 62ea71de2a4e3_ddd5f2308951@CALTM00564.local.mail (2863.9ms)
Date: Wed, 03 Aug 2022 18:32:22 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea71de2a4e3_ddd5f2308951@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 1.1ms | Allocations: 978)
Completed 500 Internal Server Error in 4357ms (ActiveRecord: 1.1ms | Allocations: 17252)


  
ActionView::SyntaxErrorInTemplate (Encountered a syntax error while rendering template: check json.report do
    json.(@report, :id, :name, :email)
    json.expense(@report.expenses, :invoice_number, :description, :amount, :status, :date)
#end
):
1:    json.report do
2:        json.(@report, :id, :name, :email)
3:        json.expense(@report.expenses, :invoice_number, :description, :amount, :status, :date)
4:    #end
  
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
app/views/reports/update.jbuilder:6: syntax error, unexpected end-of-input, expecting `end'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:32:34 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1.4ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 3.0ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 6.1ms
Delivered mail 62ea71ec35048_ddd5f2449098@CALTM00564.local.mail (2498.8ms)
Date: Wed, 03 Aug 2022 18:32:36 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea71ec35048_ddd5f2449098@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 12.5ms | Allocations: 7563)
Completed 500 Internal Server Error in 4366ms (ActiveRecord: 0.7ms | Allocations: 23855)


  
ActionView::Template::Error (undefined method `name' for #<Report id: 1, status: "submitted", created_at: "2022-08-03 12:55:12.818759000 +0000", updated_at: "2022-08-03 12:59:46.019692000 +0000", user_id: 48>):
    1: json.report do
    2:     json.(@report, :id, :name, :email)
    3:     json.expense(@report.expenses, :invoice_number, :description, :amount, :status, :date)
    4: end
  
app/views/reports/update.jbuilder:2
app/views/reports/update.jbuilder:1
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:32:57 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1.3ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 2.3ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 5.3ms
Delivered mail 62ea72029d336_ddd5f2589135@CALTM00564.local.mail (2873.5ms)
Date: Wed, 03 Aug 2022 18:32:58 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea72029d336_ddd5f2589135@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 0.9ms | Allocations: 273)
Completed 200 OK in 4342ms (Views: 3.0ms | ActiveRecord: 0.8ms | Allocations: 16568)


Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:33:40 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"48", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:17:in `update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:21:in `block in update_report_status'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 1.3ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 4.8ms
Delivered mail 62ea722df3a35_ddd5f26c9248@CALTM00564.local.mail (2563.1ms)
Date: Wed, 03 Aug 2022 18:33:41 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea722df3a35_ddd5f26c9248@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 0.5ms | Allocations: 279)
Completed 200 OK in 4326ms (Views: 1.7ms | ActiveRecord: 1.0ms | Allocations: 16496)


Started POST "/api/v1/expense_tracker/user/login?email=admin@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:34:17 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 177)
Completed 200 OK in 257ms (Views: 2.0ms | ActiveRecord: 0.1ms | Allocations: 1936)


Started GET "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:34:34 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 48]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.5ms | Allocations: 3062)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.3ms | Allocations: 6133)


Started GET "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:35:32 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:2
  Rendered reports/show.jbuilder (Duration: 4.6ms | Allocations: 959)
Completed 200 OK in 8ms (Views: 4.8ms | ActiveRecord: 0.3ms | Allocations: 4420)


Started GET "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:35:56 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.0ms | Allocations: 1133)
Completed 200 OK in 4ms (Views: 1.5ms | ActiveRecord: 0.2ms | Allocations: 4848)


Started GET "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:39:35 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (2.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:15:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 8.5ms | Allocations: 7598)
Completed 200 OK in 34ms (Views: 9.2ms | ActiveRecord: 4.9ms | Allocations: 22437)


Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:40:07 +0530
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>3, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:32:in `block in admin_update'
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.7ms | Allocations: 8278)


  
NameError (undefined local variable or method `approved_amount' for #<ReportsController:0x00000000055460>

      expense.update(status: expense[status], approved_amount: expense[approved_amount])
                                                                       ^^^^^^^^^^^^^^^):
  
app/controllers/reports_controller.rb:33:in `block in admin_update'
app/controllers/reports_controller.rb:31:in `each'
app/controllers/reports_controller.rb:31:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:41:31 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>3, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:32:in `block in admin_update'
Completed 500 Internal Server Error in 21ms (ActiveRecord: 1.8ms | Allocations: 22753)


  
NoMethodError (undefined method `update' for #<ActionController::Parameters {"id"=>3, "status"=>"rejected", "approved_amount"=>0} permitted: false>

      expense.update(status: expense[:status], approved_amount: expense[:approved_amount])
             ^^^^^^^):
  
app/controllers/reports_controller.rb:33:in `block in admin_update'
app/controllers/reports_controller.rb:31:in `each'
app/controllers/reports_controller.rb:31:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:42:38 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>3, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:32:in `block in admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 13:12:38.452323"], ["approved_amount", 0], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:35:in `admin_update'
  [1m[36mReport Update (0.3ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 13:12:38.455009"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:35:in `admin_update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1.0ms | Allocations: 145)
  Rendered layout layouts/mailer.text.erb (Duration: 2.1ms | Allocations: 371)
UserMailer#report_update: processed outbound mail in 3.9ms
Delivered mail 62ea7446713ef_ddd5f26c93a3@CALTM00564.local.mail (2804.3ms)
Date: Wed, 03 Aug 2022 18:42:38 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea7446713ef_ddd5f26c93a3@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:35:in `admin_update'
Completed 500 Internal Server Error in 2859ms (ActiveRecord: 5.5ms | Allocations: 38744)


  
NameError (undefined local variable or method `notify_report_update' for #<ReportsController:0x000000000610d0>

    notify_report_update
    ^^^^^^^^^^^^^^^^^^^^):
  
app/controllers/reports_controller.rb:36:in `admin_update'
app/controllers/reports_controller.rb:23:in `update'
Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:43:50 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>3, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:32:in `block in admin_update'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 140)
UserMailer#report_update: processed outbound mail in 1.4ms
Delivered mail 62ea748e55131_ddd5f23094ae@CALTM00564.local.mail (2625.4ms)
Date: Wed, 03 Aug 2022 18:43:50 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea748e55131_ddd5f23094ae@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 14)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 113)
UserMailer#report_update: processed outbound mail in 1.2ms
Delivered mail 62ea7490ef681_ddd5f230956@CALTM00564.local.mail (2642.6ms)
Date: Wed, 03 Aug 2022 18:43:52 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea7490ef681_ddd5f230956@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 5.6ms | Allocations: 2581)
Completed 200 OK in 5320ms (Views: 6.7ms | ActiveRecord: 2.4ms | Allocations: 39997)


Started PATCH "/api/v1/expense_tracker/users/48/reports/1" for 127.0.0.1 at 2022-08-03 18:44:51 +0530
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>3, "status"=>"rejected", "approved_amount"=>0}], "user_id"=>"48", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 48], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:22:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 47]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:32:in `block in admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:33:in `block in admin_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 1.1ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 2.6ms
Delivered mail 62ea74cb6baa7_ddd5f258961@CALTM00564.local.mail (2947.1ms)
Date: Wed, 03 Aug 2022 18:44:51 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea74cb6baa7_ddd5f258961@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/models/report.rb:27:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 14)
  Rendered layout layouts/mailer.text.erb (Duration: 0.3ms | Allocations: 113)
UserMailer#report_update: processed outbound mail in 2.8ms
Delivered mail 62ea74ce603fe_ddd5f25897ce@CALTM00564.local.mail (2765.6ms)
Date: Wed, 03 Aug 2022 18:44:54 +0530
From: from@example.com
To: david@gmail.com
Message-ID: <62ea74ce603fe_ddd5f25897ce@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 3.7ms | Allocations: 1138)
Completed 200 OK in 5737ms (Views: 6.4ms | ActiveRecord: 0.6ms | Allocations: 19201)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 18:46:09 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010a517060>, params: {"user"=>{"email"=>"admin@mail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "david"], ["department", "Engineering"], ["status", 1], ["email", "admin@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 13:16:09.927956"], ["updated_at", "2022-08-03 13:16:09.927956"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 49], ["created_at", "2022-08-03 13:16:09.929964"], ["updated_at", "2022-08-03 13:16:09.929964"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 49], ["created_at", "2022-08-03 13:16:09.932072"], ["updated_at", "2022-08-03 13:16:09.932072"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 1273)
Completed 201 Created in 266ms (Views: 2.2ms | ActiveRecord: 1.9ms | Allocations: 9633)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 18:46:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"david@mail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010af07278>, params: {"user"=>{"email"=>"david@mail.com", "name"=>"david", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "david"], ["department", "Engineering"], ["status", 1], ["email", "david@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 13:16:30.280819"], ["updated_at", "2022-08-03 13:16:30.280819"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 50], ["created_at", "2022-08-03 13:16:30.283341"], ["updated_at", "2022-08-03 13:16:30.283341"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 853)
Completed 201 Created in 259ms (Views: 0.9ms | ActiveRecord: 1.9ms | Allocations: 6154)


Started POST "/api/v1/expense_tracker/user/login?email=david@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:47:00 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1877)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:47:12 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.1ms | Allocations: 177)
Completed 200 OK in 258ms (Views: 1.7ms | ActiveRecord: 0.1ms | Allocations: 1571)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:53:43 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 259ms (Views: 1.9ms | ActiveRecord: 0.4ms | Allocations: 6475)


Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-03 18:53:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000109927890 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-ky3ndx.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel"}, "user_id"=>"48"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 2ms (ActiveRecord: 0.1ms | Allocations: 2351)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=48):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:19:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:54:29 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"101", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001086be730 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-j59e2p.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 101], ["date", nil], ["invoice_number", 5], ["status", 0], ["user_id", 50], ["created_at", "2022-08-03 13:24:29.288269"], ["updated_at", "2022-08-03 13:24:29.288269"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 47]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6k5fqrr9cevxcjg08f8jow7p9s8t"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 13:24:29.296750"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 52], ["created_at", "2022-08-03 13:24:29.297671"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 13:24:29.298187"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 6k5fqrr9cevxcjg08f8jow7p9s8t (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb) to Async(default) with arguments: #<GlobalID:0x000000010ae6d8f8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/47>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 52]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.9ms | Allocations: 288)
Completed 200 OK in 44ms (Views: 1.5ms | ActiveRecord: 2.9ms | Allocations: 42153)


[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 47], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb] Performing ActiveStorage::PurgeJob (Job ID: dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb) from Async(default) enqueued at 2022-08-03T13:24:29Z with arguments: #<GlobalID:0x000000010af4c8c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/47>>
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 47], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 47]]
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 47], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 47]]
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: wdvggu1hsanhil0vhxq9tlw6jyrg[0m
[ActiveJob] [ActiveStorage::PurgeJob] [dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb] Performed ActiveStorage::PurgeJob (Job ID: dc1175d5-6bd4-44a6-a5d3-d8903dd1c0eb) from Async(default) in 26.85ms
Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:55:15 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.0ms | Allocations: 1851)
Completed 200 OK in 14ms (Views: 2.0ms | ActiveRecord: 0.4ms | Allocations: 15707)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:55:52 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b347568 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-7k0p4s.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 6], ["status", 0], ["user_id", 50], ["created_at", "2022-08-03 13:25:52.378027"], ["updated_at", "2022-08-03 13:25:52.378027"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 48]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "lyeupjll3dy2nh9ez0r2reowrmic"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 13:25:52.382091"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 53], ["created_at", "2022-08-03 13:25:52.383078"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 13:25:52.383719"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: lyeupjll3dy2nh9ez0r2reowrmic (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 0abcbfa6-51b6-4d5b-badb-37db6321b748) to Async(default) with arguments: #<GlobalID:0x000000010b54fd88 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/48>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 53]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 92)
Completed 200 OK in 16ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 15543)


[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748] Performing ActiveStorage::PurgeJob (Job ID: 0abcbfa6-51b6-4d5b-badb-37db6321b748) from Async(default) enqueued at 2022-08-03T13:25:52Z with arguments: #<GlobalID:0x000000010b69c880 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/48>>
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 48], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 48]]
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 48], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 48]]
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: 4u076q1oprm8p10t6s76vmv3al5w[0m
[ActiveJob] [ActiveStorage::PurgeJob] [0abcbfa6-51b6-4d5b-badb-37db6321b748] Performed ActiveStorage::PurgeJob (Job ID: 0abcbfa6-51b6-4d5b-badb-37db6321b748) from Async(default) in 24.44ms
Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:55:55 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 0.9ms | Allocations: 1020)
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 3455)


Started GET "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 18:56:08 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:15:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 1.7ms | Allocations: 254)
Completed 200 OK in 5ms (Views: 2.1ms | ActiveRecord: 0.2ms | Allocations: 3585)


Started PATCH "/api/v1/expense_tracker/users/48/expenses/2" for 127.0.0.1 at 2022-08-03 18:57:04 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99, "status"=>"submit"}, "user_id"=>"48", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
Completed 404 Not Found in 1ms (ActiveRecord: 0.1ms | Allocations: 1653)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=48):
  
app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
app/controllers/expenses_controller.rb:30:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 18:57:16 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99, "status"=>"submit"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.2ms | Allocations: 11928)


  
ArgumentError ('submit' is not a valid status):
  
app/controllers/expenses_controller.rb:33:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 18:57:37 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99, "status"=>"submitted"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 99], ["status", 4], ["updated_at", "2022-08-03 13:27:39.567744"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 232)
Completed 200 OK in 1853ms (Views: 1.4ms | ActiveRecord: 2.2ms | Allocations: 12406)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:58:38 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 0.7ms | Allocations: 1022)
Completed 200 OK in 3ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 3453)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/2" for 127.0.0.1 at 2022-08-03 18:58:46 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99, "status"=>"submitted"}, "user_id"=>"50", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 6], ["biller", "Mydeo"], ["created_at", "2022-08-03 13:28:48.406551"], ["updated_at", "2022-08-03 13:28:48.406551"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 6], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 99], ["status", 2], ["updated_at", "2022-08-03 13:28:48.411284"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 149)
Completed 200 OK in 1768ms (Views: 0.9ms | ActiveRecord: 3.1ms | Allocations: 20652)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/3" for 127.0.0.1 at 2022-08-03 18:58:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"amount"=>99, "status"=>"submitted"}, "user_id"=>"50", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:43:in `user_update'
Completed 404 Not Found in 4ms (ActiveRecord: 0.3ms | Allocations: 4573)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=3 [WHERE "expenses"."user_id" = ?]):
  
app/controllers/expenses_controller.rb:43:in `user_update'
app/controllers/expenses_controller.rb:32:in `update'
Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 18:59:13 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 45)
Completed 200 OK in 252ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 1081)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 18:59:24 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.1ms | Allocations: 1022)
Completed 200 OK in 3ms (Views: 1.3ms | ActiveRecord: 0.2ms | Allocations: 3476)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 18:59:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d18c5a0>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 13:29:51.455754"], ["updated_at", "2022-08-03 13:29:51.455754"]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 51], ["created_at", "2022-08-03 13:29:51.459126"], ["updated_at", "2022-08-03 13:29:51.459126"]]
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:47:in `block in add_user_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 51]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.0ms | Allocations: 1052)
Completed 201 Created in 262ms (Views: 1.9ms | ActiveRecord: 2.6ms | Allocations: 7351)


Started POST "/api/v1/expense_tracker/user/login?email=jhon@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 19:00:02 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"jhon@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 46)
Completed 200 OK in 252ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1143)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-03 19:00:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010d517030 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-92xaw4.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"10", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2363)


Started POST "/api/v1/expense_tracker/users/51/expenses" for 127.0.0.1 at 2022-08-03 19:00:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010d584c70 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220803-56789-tg5q8d.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"10", "description"=>"Other"}, "user_id"=>"51"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 10], ["status", 0], ["user_id", 51], ["created_at", "2022-08-03 13:30:26.097345"], ["updated_at", "2022-08-03 13:30:26.097345"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 49]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "mo9ku1feem25mlt0k4id3jwjtvgk"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-03 13:30:26.101166"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 54], ["created_at", "2022-08-03 13:30:26.102137"]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-03 13:30:26.102613"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: mo9ku1feem25mlt0k4id3jwjtvgk (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a298c293-218e-45f0-9d74-d3d1cc4e8f2c) to Async(default) with arguments: #<GlobalID:0x000000010d866678 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/49>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mActiveStorage::Blob Update (1.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 54]]
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `create'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 89)
Completed 200 OK in 21ms (Views: 0.5ms | ActiveRecord: 3.1ms | Allocations: 15712)


[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c] Performing ActiveStorage::PurgeJob (Job ID: a298c293-218e-45f0-9d74-d3d1cc4e8f2c) from Async(default) enqueued at 2022-08-03T13:30:26Z with arguments: #<GlobalID:0x000000010d8cc608 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/49>>
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 49], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 49]]
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 49], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 49]]
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c]   [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: hqu4yfhmr2dc2yveaoox7arh7ujo[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a298c293-218e-45f0-9d74-d3d1cc4e8f2c] Performed ActiveStorage::PurgeJob (Job ID: a298c293-218e-45f0-9d74-d3d1cc4e8f2c) from Async(default) in 6.86ms
Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 19:01:33 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:6:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 44)
Completed 200 OK in 256ms (Views: 1.4ms | ActiveRecord: 0.2ms | Allocations: 1074)


Started GET "/api/v1/expense_tracker/users/51/expenses" for 127.0.0.1 at 2022-08-03 19:01:42 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"51"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 51]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 0.9ms | Allocations: 877)
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 0.2ms | Allocations: 3325)


Started PATCH "/api/v1/expense_tracker/users/51/expenses/3" for 127.0.0.1 at 2022-08-03 19:02:53 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved"}, "user_id"=>"51", "id"=>"3"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:50:in `admin_update'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 10], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 13:32:53.240628"], ["approved_amount", 50], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 6.8ms | Allocations: 239)
  Rendered layout layouts/mailer.text.erb (Duration: 7.0ms | Allocations: 354)
UserMailer#expense_update: processed outbound mail in 24.3ms
Delivered mail 62ea790548d10_ddd5f21c983f@CALTM00564.local.mail (2585.6ms)
Date: Wed, 03 Aug 2022 19:02:53 +0530
From: from@example.com
To: jhon@mail.com
Message-ID: <62ea790548d10_ddd5f21c983f@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: jhon@mail.com
expense invoice number is: 10
expense status: approved
expense amount: 100
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.5ms | Allocations: 149)
Completed 200 OK in 2652ms (Views: 2.1ms | ActiveRecord: 2.4ms | Allocations: 22335)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 19:03:26 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:50:in `admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-03 13:33:26.145165"], ["approved_amount", 50], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 21)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 125)
UserMailer#expense_update: processed outbound mail in 0.9ms
Delivered mail 62ea79262490d_ddd5f2309996@CALTM00564.local.mail (2715.6ms)
Date: Wed, 03 Aug 2022 19:03:26 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ea79262490d_ddd5f2309996@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: david@mail.com
expense invoice number is: 5
expense status: approved
expense amount: 99
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.5ms | Allocations: 114)
Completed 200 OK in 2729ms (Views: 1.3ms | ActiveRecord: 1.6ms | Allocations: 13054)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 19:03:42 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:50:in `admin_update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 21)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 125)
UserMailer#expense_update: processed outbound mail in 0.6ms
Delivered mail 62ea79366a644_ddd5f244100bb@CALTM00564.local.mail (3110.5ms)
Date: Wed, 03 Aug 2022 19:03:42 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ea79366a644_ddd5f244100bb@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: david@mail.com
expense invoice number is: 5
expense status: approved
expense amount: 99
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.1ms | Allocations: 114)
Completed 200 OK in 3120ms (Views: 1.8ms | ActiveRecord: 0.4ms | Allocations: 11991)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-03 19:04:25 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/concerns/user_authorization.rb:18:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:50:in `admin_update'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010a54eba0>, params: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:33:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 49]]
  ↳ app/models/user.rb:25:in `admin?'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 21)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 125)
UserMailer#expense_update: processed outbound mail in 0.8ms
Delivered mail 62ea7961166cd_ddd5f26c101db@CALTM00564.local.mail (3081.3ms)
Date: Wed, 03 Aug 2022 19:04:25 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ea7961166cd_ddd5f26c101db@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: david@mail.com
expense invoice number is: 5
expense status: approved
expense amount: 99
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 114)
Completed 200 OK in 3093ms (Views: 0.9ms | ActiveRecord: 0.5ms | Allocations: 12096)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:23:16 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001098d6f30>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `create'
Completed 500 Internal Server Error in 3324ms (ActiveRecord: 4.7ms | Allocations: 17844)


  
NoMethodError (undefined method `user_roles' for nil:NilClass

      @user.user_roles.create(role:)
           ^^^^^^^^^^^):
  
app/models/user.rb:40:in `block in add_roles'
app/models/user.rb:39:in `each'
app/models/user.rb:39:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:23:45 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c544ab8>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:24:47 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010a6fee78>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 29556ms (ActiveRecord: 4.8ms | Allocations: 46105)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("unable to onboard  user #{@user.email}, exception #{errors.full_messages}")
                                                   ^^^^^^):
  
app/models/user.rb:33:in `validate'
app/controllers/users_controller.rb:15:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:25:46 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d925e38>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 500 Internal Server Error in 6385ms (ActiveRecord: 7.1ms | Allocations: 35823)


  
NameError (uninitialized constant User::VALIDATION_ERROR

      raise CustomError::ValidationError.new("unable to onboard user, #{errors.full_messages}", VALIDATION_ERROR)
                                                                                                ^^^^^^^^^^^^^^^^):
  
app/models/user.rb:34:in `validate'
app/controllers/users_controller.rb:15:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:26:34 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010e895a08>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 6619ms (Views: 1.6ms | ActiveRecord: 5.9ms | Allocations: 38746)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:27:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d786f00>, params: {"user"=>{"email"=>"jhon@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 2942ms (Views: 1.2ms | ActiveRecord: 4.8ms | Allocations: 38312)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:28:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d0a5060>, params: {"user"=>{"email"=>"jhon1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon1@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 16:58:11.885392"], ["updated_at", "2022-08-03 16:58:11.885392"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 44786ms (ActiveRecord: 9.0ms | Allocations: 48256)


  
NoMethodError (undefined method `user_roles' for nil:NilClass

      @user.user_roles.create(role:)
           ^^^^^^^^^^^):
  
app/models/user.rb:42:in `block in add_roles'
app/models/user.rb:41:in `each'
app/models/user.rb:41:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:28:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c72c0d8>, params: {"user"=>{"email"=>"jhon1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 12403ms (Views: 1.3ms | ActiveRecord: 6.6ms | Allocations: 38500)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:30:00 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon2@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010dad4068>, params: {"user"=>{"email"=>"jhon2@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon2@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon2@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 17:00:02.354183"], ["updated_at", "2022-08-03 17:00:02.354183"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 16186ms (ActiveRecord: 3.2ms | Allocations: 49447)


  
NoMethodError (undefined method `user_roles' for nil:NilClass

      @user.user_roles.create(role:)
           ^^^^^^^^^^^):
  
app/models/user.rb:42:in `block in add_roles'
app/models/user.rb:41:in `each'
app/models/user.rb:41:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:31:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon2@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010da3e040>, params: {"user"=>{"email"=>"jhon2@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon2@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 4530ms (Views: 1.2ms | ActiveRecord: 6.0ms | Allocations: 38555)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:32:16 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon3@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010dc04230>, params: {"user"=>{"email"=>"jhon3@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon3@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon3@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 17:02:19.525980"], ["updated_at", "2022-08-03 17:02:19.525980"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 6650ms (ActiveRecord: 7.0ms | Allocations: 52192)


  
NoMethodError (undefined method `user_roles' for nil:NilClass

      @user.user_roles.create(role:)
           ^^^^^^^^^^^):
  
app/models/user.rb:42:in `block in add_roles'
app/models/user.rb:41:in `each'
app/models/user.rb:41:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:32:43 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon5@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d7ad8d0>, params: {"user"=>{"email"=>"jhon5@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon5@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon5@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 17:02:46.701462"], ["updated_at", "2022-08-03 17:02:46.701462"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 6555ms (ActiveRecord: 8.6ms | Allocations: 47831)


  
NoMethodError (undefined method `user_role' for nil:NilClass

      @user.user_role.create(role:)
           ^^^^^^^^^^):
  
app/models/user.rb:42:in `block in add_roles'
app/models/user.rb:41:in `each'
app/models/user.rb:41:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:33:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon5@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d75ee38>, params: {"user"=>{"email"=>"jhon5@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon5@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 10827ms (Views: 1.7ms | ActiveRecord: 6.1ms | Allocations: 39611)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:33:35 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon9@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c7b7110>, params: {"user"=>{"email"=>"jhon9@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon9@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "jhon9@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 17:03:37.473250"], ["updated_at", "2022-08-03 17:03:37.473250"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
Completed 500 Internal Server Error in 83730ms (ActiveRecord: 3.1ms | Allocations: 59088)


  
NoMethodError (undefined method `user_roles' for nil:NilClass):
  
app/models/user.rb:42:in `block in add_roles'
app/models/user.rb:41:in `each'
app/models/user.rb:41:in `add_roles'
app/controllers/users_controller.rb:16:in `create'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:35:07 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"jhon9@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010d72f8e0>, params: {"user"=>{"email"=>"jhon9@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "jhon9@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 4087ms (Views: 1.6ms | ActiveRecord: 6.6ms | Allocations: 38554)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 22:35:19 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010c786678>, params: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhon"], ["department", "Engineering"], ["status", 1], ["email", "a1@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 17:05:21.025185"], ["updated_at", "2022-08-03 17:05:21.025185"]]
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:14:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:42:in `block in add_roles'
  [1m[36mUserRole Create (1.0ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 57], ["created_at", "2022-08-03 17:05:26.629287"], ["updated_at", "2022-08-03 17:05:26.629287"]]
  ↳ app/models/user.rb:42:in `block in add_roles'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:42:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 57]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 30.3ms | Allocations: 2219)
Completed 201 Created in 7191ms (Views: 38.5ms | ActiveRecord: 9.0ms | Allocations: 59177)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:34:51 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `signup'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
Completed 500 Internal Server Error in 59321ms (ActiveRecord: 2.7ms | Allocations: 22250)


  
NoMethodError (undefined method `email' for nil:NilClass):
  
app/controllers/users_controller.rb:24:in `raise_user_not_found'
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:36:08 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:14:in `signup'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
User not found kasi@gmail.com
Completed 400 Bad Request in 5247ms (Views: 2.0ms | ActiveRecord: 3.1ms | Allocations: 28730)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:41:43 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.6ms | Allocations: 398)
Completed 200 OK in 257ms (Views: 2.0ms | ActiveRecord: 0.4ms | Allocations: 12867)


Started POST "/api/v1/expense_tracker/user/login?email=admi3n@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:42:12 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admi3n@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi3n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.1ms | Allocations: 1797)


  
NoMethodError (undefined method `email' for nil:NilClass

      logger.error("Invalid email, email does not exist #{@user.email}")
                                                               ^^^^^^):
  
app/controllers/sessions_controller.rb:7:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=admi3n@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:42:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admi3n@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:5:in `create'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi3n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Invalid email, email does not exist admi3n@mail.com
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 4733)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-03 23:43:51 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001067d19d0>, params: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:7:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 253ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 8293)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:44:05 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:14:in `signup'
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.1ms | Allocations: 3593)


  
NameError (undefined local variable or method `raise_user_not_found' for #<UsersController:0x0000000002ed88>

    raise_user_not_found if @user.nil?
    ^^^^^^^^^^^^^^^^^^^^
Did you mean?  rails_info_routes_url):
  
app/controllers/users_controller.rb:15:in `signup'
Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:44:26 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
User not found kasi@gmail.com
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 2445)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:45:14 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
User not found kasi@gmail.com
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 2449)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:49:43 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"kasi@gmail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
User not found kasi@gmail.com
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 2455)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:49:53 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admin@gmail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
User not found admin@gmail.com
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 872)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-03 23:50:03 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:15:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:17:in `signup'
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-03 18:20:03.762198"], ["id", 49]]
  ↳ app/controllers/users_controller.rb:17:in `signup'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:17:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 0.8ms | Allocations: 177)
Completed 201 Created in 262ms (Views: 1.9ms | ActiveRecord: 1.7ms | Allocations: 6562)


Started POST "/api/v1/expense_tracker/user/login?email=admin@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:50:50 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.1ms | Allocations: 1825)


  
NoMethodError (undefined method `[]' for nil:NilClass

    logger.error("User not found #{params[:user][:email]}")
                                                ^^^^^^^^):
  
app/controllers/concerns/user_authorization.rb:27:in `raise_user_not_found'
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/api/v1/expense_tracker/user/login?email=admin@gmail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:54:07 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@gmail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:7:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
User not found admin@gmail.com
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 4699)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:54:23 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
password mismatch for user admin@mail.com
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 2608)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:54:30 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
password mismatch for user admin@mail.com
Completed 400 Bad Request in 248ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 903)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:54:37 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
password mismatch for user admin@mail.com
Completed 400 Bad Request in 255ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 900)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-03 23:54:42 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.3ms | Allocations: 176)
Completed 200 OK in 255ms (Views: 1.9ms | ActiveRecord: 0.1ms | Allocations: 1585)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:05:46 +0530
  
ArgumentError (wrong number of arguments (given 3, expected 1..2)):
  
app/models/user.rb:6:in `<class:User>'
app/models/user.rb:1:in `<main>'
Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:08:30 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000111d57db8>, params: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhon", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 251ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 6637)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:08:36 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000110d25b70>, params: {"user"=>{"email"=>"a1@mail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 256ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3657)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:08:43 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a2s@mail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000110dcd7f8>, params: {"user"=>{"email"=>"a2s@mail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a2s@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhosn"], ["department", "Engineering"], ["status", 1], ["email", "a2s@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 18:38:43.840470"], ["updated_at", "2022-08-03 18:38:43.840470"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 58], ["created_at", "2022-08-03 18:38:43.855205"], ["updated_at", "2022-08-03 18:38:43.855205"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 58]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.8ms | Allocations: 2117)
Completed 201 Created in 274ms (Views: 2.3ms | ActiveRecord: 2.5ms | Allocations: 14153)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:08:53 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a2smail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001112970e0>, params: {"user"=>{"email"=>"a2smail.com", "name"=>"jhosn", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a2smail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email Invalid email"]
Completed 400 Bad Request in 254ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3586)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:09:13 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a12smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011141dab8>, params: {"user"=>{"email"=>"a12smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a12smail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email Invalid email"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3422)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 00:09:19 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a12@smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001114bd3d8>, params: {"user"=>{"email"=>"a12@smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a12@smail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhsn"], ["department", "Engineering"], ["status", 1], ["email", "a12@smail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-03 18:39:20.039930"], ["updated_at", "2022-08-03 18:39:20.039930"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 59], ["created_at", "2022-08-03 18:39:20.043357"], ["updated_at", "2022-08-03 18:39:20.043357"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 59], ["created_at", "2022-08-03 18:39:20.046315"], ["updated_at", "2022-08-03 18:39:20.046315"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 59]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.0ms | Allocations: 969)
Completed 201 Created in 263ms (Views: 1.2ms | ActiveRecord: 3.9ms | Allocations: 8140)


Started POST "/api/v1/expense_tracker/user/login?email=admi3n@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 00:09:30 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admi3n@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi3n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
User not found admi3n@mail.com
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 1222)


Started POST "/api/v1/expense_tracker/user/login?email=admi3n@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 00:10:31 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admi3n@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:7:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi3n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
User not found admi3n@mail.com
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 4699)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 00:10:37 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
password mismatch for user admin@mail.com
Completed 400 Bad Request in 256ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 2608)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 00:10:50 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 252ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 1432)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 10:41:54 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a12@smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011186c268>, params: {"user"=>{"email"=>"a12@smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a12@smail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 256ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 6598)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 10:41:59 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000105c23f70>, params: {"user"=>{"email"=>"a1smail.com", "name"=>"jhsn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1smail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email Invalid email"]
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3434)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 10:42:10 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1s@mail.com", "name"=>"jhn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001065dcb48>, params: {"user"=>{"email"=>"a1s@mail.com", "name"=>"jhn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1s@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "jhn"], ["department", "Engineering"], ["status", 1], ["email", "a1s@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-04 05:12:10.798727"], ["updated_at", "2022-08-04 05:12:10.798727"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 60], ["created_at", "2022-08-04 05:12:10.804806"], ["updated_at", "2022-08-04 05:12:10.804806"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 60], ["created_at", "2022-08-04 05:12:10.807360"], ["updated_at", "2022-08-04 05:12:10.807360"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 60]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.7ms | Allocations: 2052)
Completed 201 Created in 265ms (Views: 2.3ms | ActiveRecord: 3.2ms | Allocations: 13448)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 10:42:17 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"a1s@mail.com", "name"=>"jhn", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011111c788>, params: {"user"=>{"email"=>"a1s@mail.com", "name"=>"jhn", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "a1s@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 256ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3796)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:42:21 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 80)
Completed 200 OK in 249ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 1790)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.co&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:42:26 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.co", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.co"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
User not found david@mail.co
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 964)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:42:32 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:7:in `create'
password mismatch for user david@mail.com
Completed 400 Bad Request in 252ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 911)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:50:38 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
password mismatch for user david@mail.com
Completed 400 Bad Request in 253ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 10578)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com1&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:50:41 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com1", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com1"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found david@mail.com1
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1001)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:52:21 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
password mismatch for user: david@mail.com
Completed 400 Bad Request in 269ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 6402)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com1&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:52:25 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com1", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com1"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found david@mail.com1
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 887)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-04 10:55:47 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "password"=>"[FILTERED]"}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:18:in `signup'
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2022-08-04 05:25:47.672637"], ["id", 49]]
  ↳ app/controllers/users_controller.rb:18:in `signup'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:18:in `signup'
  Rendering users/signup.jbuilder
  Rendered users/signup.jbuilder (Duration: 1.0ms | Allocations: 358)
Completed 201 Created in 261ms (Views: 8.8ms | ActiveRecord: 2.2ms | Allocations: 9635)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-04 10:55:51 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admi2n@mail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi2n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
User not found admi2n@mail.com
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 977)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-04 10:56:34 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admi2n@mail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi2n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
User not found admi2n@mail.com
Completed 400 Bad Request in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 3346)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com1&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:56:41 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com1", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com1"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found david@mail.com1
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1013)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com1&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:56:49 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com1", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com1"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not founds: david@mail.com1
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 4694)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com1&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 10:56:54 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com1", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com1"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found: david@mail.com1
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 4691)


Started POST "/api/v1/expense_tracker/user/signup" for 127.0.0.1 at 2022-08-04 10:57:00 +0530
Processing by UsersController#signup as JSON
  Parameters: {"user"=>{"email"=>"admi2n@mail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admi2n@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:16:in `signup'
User not found: admi2n@mail.com
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1025)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 11:49:15 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
password mismatch for user: david@mail.com
Completed 400 Bad Request in 258ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 8461)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 11:49:18 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.8ms | Allocations: 369)
Completed 200 OK in 259ms (Views: 2.3ms | ActiveRecord: 0.1ms | Allocations: 3278)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 11:50:32 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.7ms | Allocations: 466)
Completed 200 OK in 254ms (Views: 1.3ms | ActiveRecord: 0.1ms | Allocations: 2079)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 11:51:09 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.4ms | Allocations: 292)
Completed 200 OK in 251ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 1890)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:51:42 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000117b6dba0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-41855-s6d3yr.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 101], ["status", 0], ["user_id", 50], ["created_at", "2022-08-04 06:21:42.833019"], ["updated_at", "2022-08-04 06:21:42.833019"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 50]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "focued40vj4afdmgcrk8oxc5urna"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-04 06:21:42.846270"]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 55], ["created_at", "2022-08-04 06:21:42.847897"]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-04 06:21:42.848612"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: focued40vj4afdmgcrk8oxc5urna (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 40a6bd30-f5af-43e1-992c-da115ab4e9b6) to Async(default) with arguments: #<GlobalID:0x0000000116aa5f70 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/50>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 55]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.7ms | Allocations: 434)
Completed 200 OK in 62ms (Views: 2.6ms | ActiveRecord: 4.4ms | Allocations: 49792)


[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6] Performing ActiveStorage::PurgeJob (Job ID: 40a6bd30-f5af-43e1-992c-da115ab4e9b6) from Async(default) enqueued at 2022-08-04T06:21:42Z with arguments: #<GlobalID:0x0000000116c7f6c0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/50>>
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 50], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 50]]
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 50], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 50]]
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: 82oj0adb4tmd7i3v7eskisf20dro[0m
[ActiveJob] [ActiveStorage::PurgeJob] [40a6bd30-f5af-43e1-992c-da115ab4e9b6] Performed ActiveStorage::PurgeJob (Job ID: 40a6bd30-f5af-43e1-992c-da115ab4e9b6) from Async(default) in 28.75ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:52:16 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b1ec1f0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-43763-1u19h7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `create'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 500 Internal Server Error in 52141ms (ActiveRecord: 11.4ms | Allocations: 104139)


  
NameError (uninitialized constant BAD_REQUEST

    raise CustomError::ValidationError.new("unable to add expense, #{@expense.errors.full_messages}", BAD_REQUEST)
                                                                                                      ^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:107:in `add_user_expense'
app/controllers/expenses_controller.rb:31:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:55:18 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001082a6fa8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-43763-ur4nl7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:28:in `create'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:104:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 500 Internal Server Error in 4976ms (ActiveRecord: 13.5ms | Allocations: 62332)


  
NameError (uninitialized constant VALIDATION_ERROR

    raise CustomError::ValidationError.new("unable to add expense, #{@expense.errors.full_messages}", VALIDATION_ERROR)
                                                                                                      ^^^^^^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:107:in `add_user_expense'
app/controllers/expenses_controller.rb:31:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:55:40 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b9cf9f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-43763-f6aby5.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `create'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 500 Internal Server Error in 5257ms (ActiveRecord: 11.7ms | Allocations: 66823)


  
NameError (uninitialized constant VALIDATION_ERROR

    raise CustomError::ValidationError.new("unable to add expense, #{@expense.errors.full_messages}", VALIDATION_ERROR)
                                                                                                      ^^^^^^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:108:in `add_user_expense'
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:59:10 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010cedca30 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-twxb6f.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:105:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 59ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 37684)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 11:59:36 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010c9c6ac8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-wum8o9.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 500 Internal Server Error in 25ms (ActiveRecord: 1.7ms | Allocations: 27019)


  
NameError (uninitialized constant VALIDATION_ERROR

                                           VALIDATION_ERROR)
                                           ^^^^^^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:107:in `add_user_expense'
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:00:15 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001093de488 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-s8lxco.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:29:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:103:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 500 Internal Server Error in 33ms (ActiveRecord: 1.6ms | Allocations: 26645)


  
NameError (uninitialized constant BAD_REQUEST

    raise CustomError::AuthenticationError.new('passwoard does not match', BAD_REQUEST)
                                                                           ^^^^^^^^^^^):
  
app/controllers/expenses_controller.rb:106:in `add_user_expense'
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:12:35 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010e37e178 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-95tzx8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"101", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 101], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
unable to add expense for user 50, exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 36ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 22987)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:12:40 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010e87d278 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-37utsx.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Create (0.8ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 99], ["status", 0], ["user_id", 50], ["created_at", "2022-08-04 06:42:40.757179"], ["updated_at", "2022-08-04 06:42:40.757179"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 51]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ec1n7vje3kb2b7mkw31kyfbxwys0"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-04 06:42:40.772299"]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 56], ["created_at", "2022-08-04 06:42:40.773209"]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-04 06:42:40.773786"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: ec1n7vje3kb2b7mkw31kyfbxwys0 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9) to Async(default) with arguments: #<GlobalID:0x000000010ea7f8f0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/51>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 56]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.4ms | Allocations: 334)
Completed 200 OK in 32ms (Views: 2.4ms | ActiveRecord: 3.1ms | Allocations: 28950)


[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9] Performing ActiveStorage::PurgeJob (Job ID: a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9) from Async(default) enqueued at 2022-08-04T06:42:40Z with arguments: #<GlobalID:0x000000010eafe8f8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/51>>
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mActiveStorage::Attachment Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 51], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 51]]
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 51], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 51]]
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: k6or2w9lgp98idb438hslwlz20jn[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9] Performed ActiveStorage::PurgeJob (Job ID: a71dadaf-2056-4e7b-9dd4-b2f0bf9592a9) from Async(default) in 28.1ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:16:25 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f02d9f0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-jc71lz.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Completed 500 Internal Server Error in 45ms (ActiveRecord: 3.7ms | Allocations: 24412)


  
NoMethodError (undefined method `id' for nil:NilClass

      logger.error("unable to add expense for user #{@user.id}, exception #{@expense.errors.full_messages}")
                                                          ^^^):
  
app/models/expense.rb:28:in `validate'
app/controllers/expenses_controller.rb:96:in `add_user_expense'
app/controllers/expenses_controller.rb:35:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:17:30 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010ed14930 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-t1pbsz.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Completed 500 Internal Server Error in 22ms (ActiveRecord: 1.6ms | Allocations: 24346)


  
NoMethodError (undefined method `errors' for nil:NilClass

      logger.error("Errors found with expense: #{id}, exception #{@expense.errors.full_messages}")
                                                                          ^^^^^^^):
  
app/models/expense.rb:28:in `validate'
app/controllers/expenses_controller.rb:96:in `add_user_expense'
app/controllers/expenses_controller.rb:35:in `create'
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:17:49 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010eaa7b98 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-87atyf.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 27ms (Views: 0.1ms | ActiveRecord: 1.7ms | Allocations: 24492)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:18:03 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010c8fd010 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-3c857q.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Errors found with expensee: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 39ms (Views: 0.1ms | ActiveRecord: 1.9ms | Allocations: 24416)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:18:36 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010e317cc0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-hu8y.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 24ms (Views: 0.1ms | ActiveRecord: 1.8ms | Allocations: 24367)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:18:47 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010eccc900 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-zmcbjm.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 28ms (Views: 0.1ms | ActiveRecord: 1.9ms | Allocations: 24397)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:19:35 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010d045020 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-3f5k34.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:95:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 31ms (Views: 0.2ms | ActiveRecord: 3.2ms | Allocations: 24435)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 12:21:23 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010e8de960 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-dp2mia.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 8ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 8411)


Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:21:28 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010ea8e530 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-61492-rn8gga.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
Completed 404 Not Found in 2ms (ActiveRecord: 0.2ms | Allocations: 1754)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:23:09 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000113cdeba0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-ce8s19.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
Completed 404 Not Found in 105ms (ActiveRecord: 3.5ms | Allocations: 11773)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:26:40 +0530
  
Zeitwerk::NameError (wrong constant name ExpensesController copy

    parent.const_defined?(cname, false)
          ^^^^^^^^^^^^^^^ inferred by Module from file

  /Users/kasinathan.veerappan/expense_tracker/app/controllers/expenses_controller copy.rb

Possible ways to address this:

  * Tell Zeitwerk to ignore this particular file.
  * Tell Zeitwerk to ignore one of its parent directories.
  * Rename the file to comply with the naming conventions.
  * Modify the inflector to handle this case.


          raise NameError.new(<<~MESSAGE, error.name)
          ^^^^^):
  
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:359:in `rescue in block in set_autoloads_in_dir'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:335:in `block in set_autoloads_in_dir'
zeitwerk (2.6.0) lib/zeitwerk/loader/helpers.rb:41:in `block in ls'
zeitwerk (2.6.0) lib/zeitwerk/loader/helpers.rb:27:in `each'
zeitwerk (2.6.0) lib/zeitwerk/loader/helpers.rb:27:in `ls'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:334:in `set_autoloads_in_dir'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:106:in `block (2 levels) in setup'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:105:in `each'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:105:in `block in setup'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:102:in `synchronize'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:102:in `setup'
zeitwerk (2.6.0) lib/zeitwerk/loader.rb:208:in `reload'
activesupport (7.0.3.1) lib/active_support/dependencies.rb:79:in `block in clear'
activesupport (7.0.3.1) lib/active_support/concurrency/share_lock.rb:151:in `exclusive'
activesupport (7.0.3.1) lib/active_support/dependencies/interlock.rb:17:in `unloading'
activesupport (7.0.3.1) lib/active_support/dependencies.rb:32:in `unload_interlock'
activesupport (7.0.3.1) lib/active_support/dependencies.rb:77:in `clear'
railties (7.0.3.1) lib/rails/application/finisher.rb:181:in `block (2 levels) in <module:Finisher>'
activesupport (7.0.3.1) lib/active_support/file_update_checker.rb:83:in `execute'
railties (7.0.3.1) lib/rails/application/finisher.rb:210:in `block (3 levels) in <module:Finisher>'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:107:in `run_callbacks'
activesupport (7.0.3.1) lib/active_support/reloader.rb:120:in `class_unload!'
railties (7.0.3.1) lib/rails/application/finisher.rb:209:in `block (2 levels) in <module:Finisher>'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:445:in `instance_exec'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:445:in `block in make_lambda'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:199:in `block (2 levels) in halting'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:687:in `block (2 levels) in default_terminator'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:686:in `catch'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:686:in `block in default_terminator'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:200:in `block in halting'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `block in invoke_before'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `each'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:595:in `invoke_before'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:106:in `run_callbacks'
activesupport (7.0.3.1) lib/active_support/execution_wrapper.rb:129:in `run'
activesupport (7.0.3.1) lib/active_support/execution_wrapper.rb:125:in `run!'
activesupport (7.0.3.1) lib/active_support/reloader.rb:114:in `run!'
activesupport (7.0.3.1) lib/active_support/execution_wrapper.rb:78:in `block in run!'
<internal:kernel>:90:in `tap'
activesupport (7.0.3.1) lib/active_support/execution_wrapper.rb:75:in `run!'
activesupport (7.0.3.1) lib/active_support/reloader.rb:63:in `run!'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
web-console (4.2.0) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/show_exceptions.rb:26:in `call'
railties (7.0.3.1) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `block in tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:38:in `tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `tagged'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.4) lib/rack/method_override.rb:24:in `call'
rack (2.2.4) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.3.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/server_timing.rb:20:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.4) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
railties (7.0.3.1) lib/rails/engine.rb:530:in `call'
puma (5.6.4) lib/puma/configuration.rb:252:in `call'
puma (5.6.4) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.4) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.4) lib/puma/request.rb:76:in `handle_request'
puma (5.6.4) lib/puma/server.rb:441:in `process_client'
puma (5.6.4) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:27:08 +0530
  
ActionController::RoutingError (uninitialized constant ExpensesController

      Object.const_get(camel_cased_word)
            ^^^^^^^^^^
Did you mean?  ExpenseTracker

            raise MissingController.new(error.message, error.name)
            ^^^^^):
  
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:27:34 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011540c9d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-vajo1e.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
Completed 404 Not Found in 150ms (ActiveRecord: 4.5ms | Allocations: 13919)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:29:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000115186710 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-5nn89i.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
Completed 404 Not Found in 4975ms (ActiveRecord: 1.6ms | Allocations: 8168)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/expenses_controller.rb:32:in `create'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 12:52:19 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011102ec90 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-dv6h5k.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
Completed 404 Not Found in 2530ms (Views: 1.5ms | ActiveRecord: 3.1ms | Allocations: 13535)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 12:52:45 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001138ff1d8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-zk94qa.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 4290ms (Views: 1.3ms | ActiveRecord: 1.9ms | Allocations: 28290)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:52:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011405dce0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-gmqj9a.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"99", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 99], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 3767ms (Views: 0.6ms | ActiveRecord: 6.9ms | Allocations: 52511)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 12:53:09 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000105cc6978 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-2830-om2x23.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"11", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:32:in `create'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mExpense Create (1.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 11], ["status", 0], ["user_id", 50], ["created_at", "2022-08-04 07:23:12.665501"], ["updated_at", "2022-08-04 07:23:12.665501"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.6ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 43]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (1.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "cx0vz2c0l8nnxum0hj5lopunzh6x"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-04 07:23:12.804448"]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 57], ["created_at", "2022-08-04 07:23:12.822582"]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-04 07:23:12.838885"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: cx0vz2c0l8nnxum0hj5lopunzh6x (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 64e8cadb-5d64-4b62-8790-c8cd2733efc0) to Async(default) with arguments: #<GlobalID:0x0000000113fcff30 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/43>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 57]]
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:94:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.3ms | Allocations: 343)
Completed 200 OK in 3221ms (Views: 8.1ms | ActiveRecord: 12.7ms | Allocations: 48282)


[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 43], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0] Performing ActiveStorage::PurgeJob (Job ID: 64e8cadb-5d64-4b62-8790-c8cd2733efc0) from Async(default) enqueued at 2022-08-04T07:23:12Z with arguments: #<GlobalID:0x000000011407dae0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/43>>
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mActiveStorage::Attachment Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 43], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mActiveStorage::VariantRecord Load (0.5ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 43]]
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 43], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mActiveStorage::Blob Destroy (0.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 43]]
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0]   [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: gc0k7uj82tbousfgc15vs3gx7qqo[0m
[ActiveJob] [ActiveStorage::PurgeJob] [64e8cadb-5d64-4b62-8790-c8cd2733efc0] Performed ActiveStorage::PurgeJob (Job ID: 64e8cadb-5d64-4b62-8790-c8cd2733efc0) from Async(default) in 150.1ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 13:02:05 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010aa7c078 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-36162-yxkqc3.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:98:in `fetch_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mExpense Create (1.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 13], ["status", 0], ["user_id", 50], ["created_at", "2022-08-04 07:32:16.950322"], ["updated_at", "2022-08-04 07:32:16.950322"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.6ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 44]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (1.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6b57x01ftup36j2p10trcrlsp02y"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-04 07:32:17.086908"]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 58], ["created_at", "2022-08-04 07:32:17.103736"]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-04 07:32:17.117971"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 6b57x01ftup36j2p10trcrlsp02y (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e) to Async(default) with arguments: #<GlobalID:0x000000010b0bc528 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/44>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.6ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 58]]
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:93:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 3.6ms | Allocations: 543)
Completed 200 OK in 11781ms (Views: 10.3ms | ActiveRecord: 22.3ms | Allocations: 86942)


[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 44], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e] Performing ActiveStorage::PurgeJob (Job ID: 4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e) from Async(default) enqueued at 2022-08-04T07:32:17Z with arguments: #<GlobalID:0x000000010b16d800 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/44>>
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mActiveStorage::Attachment Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 44], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mActiveStorage::VariantRecord Load (0.4ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 44]]
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 44], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mActiveStorage::Blob Destroy (0.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 44]]
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e]   [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: 96v02b1n8z0momhdmf3bbclpcfu0[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e] Performed ActiveStorage::PurgeJob (Job ID: 4ad3ace5-50ea-4c90-81a5-06ec2ba65a7e) from Async(default) in 110.25ms
Started GET "/api/v1/expense_tracker/users/51/expenses" for 127.0.0.1 at 2022-08-04 13:37:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"51"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:98:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
Forbidden request #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 15816ms (Views: 0.6ms | ActiveRecord: 5.7ms | Allocations: 38738)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 13:38:23 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:98:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 136.4ms | Allocations: 17384)
Completed 200 OK in 8416ms (Views: 140.8ms | ActiveRecord: 3.5ms | Allocations: 39705)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 13:40:42 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 98.4ms | Allocations: 8729)
Completed 200 OK in 2660ms (Views: 101.3ms | ActiveRecord: 6.9ms | Allocations: 34588)


Started GET "/api/v1/expense_tracker/users/51/expenses" for 127.0.0.1 at 2022-08-04 13:40:50 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"51"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to index? this User>
Completed 403 Forbidden in 1711ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 9469)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 13:44:03 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 99.0ms | Allocations: 8728)
Completed 200 OK in 2427ms (Views: 101.6ms | ActiveRecord: 5.7ms | Allocations: 34668)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 14:16:59 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:40:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 92.0ms | Allocations: 8212)
Completed 200 OK in 2630ms (Views: 96.0ms | ActiveRecord: 2.8ms | Allocations: 33166)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 14:17:07 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010b44e790 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-36162-4da498.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:98:in `add_user_expense'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:98:in `add_user_expense'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:98:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 7462ms (Views: 0.5ms | ActiveRecord: 2.9ms | Allocations: 31956)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 14:18:15 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001150749a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-exkbls.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:11:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 218756ms (Views: 1.8ms | ActiveRecord: 9.1ms | Allocations: 78978)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 14:23:22 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001121f4a60 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-ooeky8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"50"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:100:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 6593ms (Views: 1.5ms | ActiveRecord: 7.9ms | Allocations: 56225)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:23:44 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001154f7340 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-rm16ju.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 7060ms (Views: 1.5ms | ActiveRecord: 1.6ms | Allocations: 28090)


Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 14:24:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116d1fdc8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-y324sp.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
Completed 500 Internal Server Error in 3468ms (ActiveRecord: 1.2ms | Allocations: 15770)


  
NoMethodError (undefined method `status_code' for #<ActiveRecord::RecordNotFound: Couldn't find User with 'id'=1>

    render json: { error_message: exception.message }, status: exception.status_code
                                                                        ^^^^^^^^^^^^):
  
app/controllers/application_controller.rb:23:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/1/expenses" for 127.0.0.1 at 2022-08-04 14:24:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001154c72d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-9euya1.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
Completed 500 Internal Server Error in 253208ms (ActiveRecord: 1.3ms | Allocations: 17497)


  
NoMethodError (undefined method `status_code' for #<ActiveRecord::RecordNotFound: Couldn't find User with 'id'=1>

    render json: { error_message: exception.message }, status: exception.status_code
                                           ^^^^^^^^):
  
app/controllers/application_controller.rb:23:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:29:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001157d53f0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-zq4zc8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 52353ms (Views: 1.7ms | ActiveRecord: 4.4ms | Allocations: 40848)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:31:04 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000114cf63a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-6cz7ds.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 27443ms (Views: 1.8ms | ActiveRecord: 4.7ms | Allocations: 47010)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:31:48 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116fbe660 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-q8nh11.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (3.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 38684ms (Views: 1.9ms | ActiveRecord: 7.5ms | Allocations: 53245)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:32:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000114c050c0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-id5sux.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 268953ms (Views: 4.0ms | ActiveRecord: 4.3ms | Allocations: 54766)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:37:06 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001127ca610 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-66388-2jw1n8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 14:51:45 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f2ac488 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-23363-sy0qqw.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 400 Bad Request in 41549ms (Views: 2.1ms | ActiveRecord: 3.7ms | Allocations: 70999)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 15:00:24 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001092f55a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-23363-cclhu4.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 400 Bad Request in 37297ms (Views: 2.3ms | ActiveRecord: 3.6ms | Allocations: 59379)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 15:01:04 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f5eeee8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-23363-hjov6j.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 400 Bad Request in 65451ms (Views: 2.2ms | ActiveRecord: 1.7ms | Allocations: 43055)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 15:03:06 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010bbe5f30 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-23363-jk2wrt.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 15:05:43 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000108a39298 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-2civ4c.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 400 Bad Request in 27383ms (Views: 2.0ms | ActiveRecord: 3.7ms | Allocations: 72793)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 16:44:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000108b83158 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-qhj7cr.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:105:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 10845ms (Views: 1.4ms | ActiveRecord: 2.8ms | Allocations: 65111)


Started POST "/api/v1/expense_tracker/users/41/expenses" for 127.0.0.1 at 2022-08-04 16:55:58 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010862c6c8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-tcwlnm.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"41"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 41], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `fetch_user'
Completed 404 Not Found in 11683ms (Views: 1.6ms | ActiveRecord: 3.0ms | Allocations: 51382)


Started POST "/api/v1/expense_tracker/users/48/expenses" for 127.0.0.1 at 2022-08-04 16:56:18 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000108d10ef8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-tc3rhe.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"48"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `fetch_user'
Completed 404 Not Found in 5028ms (Views: 1.6ms | ActiveRecord: 1.5ms | Allocations: 46181)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 16:56:34 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f506d78 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-ijgzhb.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 401 Unauthorized in 5553ms (Views: 1.5ms | ActiveRecord: 1.8ms | Allocations: 52349)


Started POST "/api/v1/expense_tracker/users/49/expenses" for 127.0.0.1 at 2022-08-04 17:39:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f25ec38 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220804-49053-5knwa8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Other"}, "user_id"=>"49"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 4278ms (Views: 1.3ms | ActiveRecord: 2.7ms | Allocations: 45070)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:40:10 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
Completed 400 Bad Request in 3933ms (Views: 0.9ms | ActiveRecord: 0.8ms | Allocations: 44549)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:41:57 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 50], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:41:in `admin?'
Completed 500 Internal Server Error in 191322ms (Views: 1.9ms | ActiveRecord: 6.5ms | Allocations: 68356)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:45:18 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 50], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:49:in `admin?'
Completed 500 Internal Server Error in 3749ms (Views: 1.2ms | ActiveRecord: 6.8ms | Allocations: 58423)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:45:26 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 50], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:49:in `admin?'
Completed 500 Internal Server Error in 25792ms (Views: 1.2ms | ActiveRecord: 1.9ms | Allocations: 25383)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:45:54 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 50], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:49:in `admin?'
Completed 500 Internal Server Error in 51624ms (Views: 1.1ms | ActiveRecord: 2.5ms | Allocations: 38294)


Started POST "/api/v1/expense_tracker/user/login?email=Mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:46:58 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"Mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "Mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found: Mike@mail.com
Completed 400 Bad Request in 3318ms (Views: 0.9ms | ActiveRecord: 0.6ms | Allocations: 17289)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:47:08 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
User not found: mike@mail.com
Completed 400 Bad Request in 2846ms (Views: 1.3ms | ActiveRecord: 0.5ms | Allocations: 30911)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-04 17:48:28 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"mike@mail.com", "name"=>"mike", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010f545758>, params: {"user"=>{"email"=>"mike@mail.com", "name"=>"mike", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (2.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "mike"], ["department", "Engineering"], ["status", 1], ["email", "mike@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-04 12:18:29.177994"], ["updated_at", "2022-08-04 12:18:29.177994"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.8ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 61], ["created_at", "2022-08-04 12:18:30.978531"], ["updated_at", "2022-08-04 12:18:30.978531"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.7ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 61], ["created_at", "2022-08-04 12:18:31.009379"], ["updated_at", "2022-08-04 12:18:31.009379"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 20.7ms | Allocations: 1506)
Completed 201 Created in 2158ms (Views: 33.9ms | ActiveRecord: 8.6ms | Allocations: 19198)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:48:44 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 3.1ms | Allocations: 266)
Completed 200 OK in 268ms (Views: 7.6ms | ActiveRecord: 0.5ms | Allocations: 1744)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:48:57 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
password mismatch for user: mike@mail.com
Completed 400 Bad Request in 3138ms (Views: 1.3ms | ActiveRecord: 0.5ms | Allocations: 21784)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:49:05 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.6ms | Allocations: 106)
Completed 200 OK in 266ms (Views: 4.8ms | ActiveRecord: 0.7ms | Allocations: 1245)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:49:11 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 61], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:49:in `admin?'
Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:50:38 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 61], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:49:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:61:in `admin_update'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010fc76978>, params: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 61], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:49:in `admin?'
UserMailer#expense_update: processed outbound mail in 4.3ms
Completed 500 Internal Server Error in 46ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 43253)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:51:23 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (13.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.7ms | Allocations: 482)
Completed 200 OK in 268ms (Views: 2.2ms | ActiveRecord: 13.3ms | Allocations: 3575)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:51:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 50], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:49:in `admin?'
Completed 500 Internal Server Error in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 4730)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 17:52:25 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 92)
Completed 200 OK in 255ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1173)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:52:30 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 61], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:49:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:61:in `admin_update'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010d5bf1e0>, params: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ? /* loading for inspect */ LIMIT ?[0m  [["user_id", 61], ["LIMIT", 11]]
  ↳ app/models/user.rb:39:in `p'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:49:in `admin?'
UserMailer#expense_update: processed outbound mail in 1.5ms
Completed 500 Internal Server Error in 9ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 10334)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 17:59:01 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:109:in `fetch_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:61:in `admin_update'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001076747a8>, params: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:12:in `update'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
UserMailer#expense_update: processed outbound mail in 1373.5ms
Completed 500 Internal Server Error in 80689ms (Views: 1.7ms | ActiveRecord: 11.1ms | Allocations: 129333)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 18:01:23 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:101:in `fetch_user'
Completed 500 Internal Server Error in 3651ms (Views: 2.1ms | ActiveRecord: 6.5ms | Allocations: 35140)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-04 18:01:42 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"approved", "description"=>"Other"}, "user_id"=>"50", "id"=>"1"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:101:in `fetch_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 23:17:59 +0530
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 162.5ms | Allocations: 11181)
Completed 200 OK in 3629ms (Views: 168.3ms | ActiveRecord: 8.5ms | Allocations: 58017)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:18:43 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 401 Unauthorized in 32423ms (Views: 2.1ms | ActiveRecord: 1.9ms | Allocations: 53337)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:20:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 401 Unauthorized in 244682ms (Views: 2.1ms | ActiveRecord: 2.2ms | Allocations: 54214)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:24:15 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:107:in `process_expense'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010f90c2d8>, params: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"4"} }[0m
Completed 500 Internal Server Error in 62493ms (Views: 2.4ms | ActiveRecord: 13.6ms | Allocations: 132115)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:29:30 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:96:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:106:in `process_expense'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010e5cded8>, params: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"4"} }[0m
Completed 500 Internal Server Error in 23227ms (Views: 2.1ms | ActiveRecord: 16.6ms | Allocations: 123388)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:30:04 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:96:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:106:in `process_expense'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010ecdd840>, params: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"4"} }[0m
Completed 500 Internal Server Error in 39031ms (Views: 1.8ms | ActiveRecord: 4.4ms | Allocations: 80184)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:30:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:107:in `process_expense'
[31mUnpermitted parameter: :description. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010ecb40a8>, params: {"expense"=>{"approved_amount"=>50, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"4"} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 101], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:21:in `update'
  [1m[36mExpense Update (2.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 1], ["updated_at", "2022-08-04 18:01:09.552690"], ["approved_amount", 50], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:21:in `update'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:21:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 9.6ms | Allocations: 283)
Completed 200 OK in 22745ms (Views: 18.0ms | ActiveRecord: 21.0ms | Allocations: 104197)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-04 23:35:05 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 3.9ms | Allocations: 279)
Completed 200 OK in 2090ms (Views: 8.4ms | ActiveRecord: 5.5ms | Allocations: 13648)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/4" for 127.0.0.1 at 2022-08-04 23:35:32 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"4"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `process_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 52870ms (Views: 1.9ms | ActiveRecord: 10.3ms | Allocations: 135990)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-04 23:36:39 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 69.6ms | Allocations: 2624)
Completed 200 OK in 2604ms (Views: 75.7ms | ActiveRecord: 3.3ms | Allocations: 17280)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/5" for 127.0.0.1 at 2022-08-04 23:36:59 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"5"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `process_expense'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 43747ms (Views: 2.0ms | ActiveRecord: 5.9ms | Allocations: 152277)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/5" for 127.0.0.1 at 2022-08-04 23:38:14 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"5"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `process_expense'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 39063ms (Views: 1.9ms | ActiveRecord: 13.8ms | Allocations: 170986)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/5" for 127.0.0.1 at 2022-08-04 23:39:41 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"5"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:103:in `process_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 82302ms (Views: 2.8ms | ActiveRecord: 5.2ms | Allocations: 130561)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/5" for 127.0.0.1 at 2022-08-04 23:41:53 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"5"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:90:in `find_user'
Started PATCH "/api/v1/expense_tracker/users/50/expenses/5" for 127.0.0.1 at 2022-08-04 23:42:32 +0530
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"5"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010f454100>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"5"} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-04 18:13:20.550939"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 6.3ms | Allocations: 524)
Completed 200 OK in 47761ms (Views: 13.9ms | ActiveRecord: 16.4ms | Allocations: 179222)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/6" for 127.0.0.1 at 2022-08-04 23:44:32 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"6"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `process_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001116c6e90>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"6"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-04 18:14:57.751338"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 8.8ms | Allocations: 261)
Completed 200 OK in 57242ms (Views: 16.8ms | ActiveRecord: 9.5ms | Allocations: 151479)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/7" for 127.0.0.1 at 2022-08-04 23:45:42 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"7"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `process_expense'
Started PATCH "/api/v1/expense_tracker/users/50/expenses/7" for 127.0.0.1 at 2022-08-04 23:46:41 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "user_id"=>"50", "id"=>"7"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:102:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000110f758f8>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Other"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"7"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 13], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-04 18:16:43.268382"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 1.0ms | Allocations: 450)
  Rendered layout layouts/mailer.text.erb (Duration: 1.5ms | Allocations: 699)
UserMailer#expense_update: processed outbound mail in 9.1ms
Delivered mail 62ec0d0b49891_cc4f21c4183@CALTM00564.local.mail (11014.3ms)
Date: Thu, 04 Aug 2022 23:46:43 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ec0d0b49891_cc4f21c4183@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: david@mail.com
expense invoice number is: 13
expense status: rejected
expense amount: 100
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.0ms | Allocations: 346)
Completed 200 OK in 12776ms (Views: 2.8ms | ActiveRecord: 4.2ms | Allocations: 52711)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 10:51:26 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 9.5ms | Allocations: 8475)
Completed 200 OK in 24ms (Views: 9.9ms | ActiveRecord: 1.3ms | Allocations: 20971)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 10:51:52 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000111aad298 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-3268-q0szim.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"198", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 198], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.7ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 198], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 05:21:52.384961"], ["updated_at", "2022-08-05 05:21:52.384961"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 45]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ggd7lvpjmryacipblcm1ll8lytlg"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 05:21:52.436190"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 59], ["created_at", "2022-08-05 05:21:52.437758"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 05:21:52.438469"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: ggd7lvpjmryacipblcm1ll8lytlg (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 071c4d1d-462b-4aba-88a1-f00469bf373d) to Async(default) with arguments: #<GlobalID:0x000000010dd05aa8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/45>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 59]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.9ms | Allocations: 397)
Completed 200 OK in 100ms (Views: 1.3ms | ActiveRecord: 5.3ms | Allocations: 38039)


[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 45], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d] Performing ActiveStorage::PurgeJob (Job ID: 071c4d1d-462b-4aba-88a1-f00469bf373d) from Async(default) enqueued at 2022-08-05T05:21:52Z with arguments: #<GlobalID:0x0000000110895da8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/45>>
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 45], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 45]]
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 45], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 45]]
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: nu017pt1u180jgbu2gsjjzfy4xuk[0m
[ActiveJob] [ActiveStorage::PurgeJob] [071c4d1d-462b-4aba-88a1-f00469bf373d] Performed ActiveStorage::PurgeJob (Job ID: 071c4d1d-462b-4aba-88a1-f00469bf373d) from Async(default) in 35.64ms
Started PATCH "/api/v1/expense_tracker/users/50/expenses/8" for 127.0.0.1 at 2022-08-05 10:52:13 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"8"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (1.1ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 198], ["biller", "Lazz"], ["created_at", "2022-08-05 05:22:15.113494"], ["updated_at", "2022-08-05 05:22:15.113494"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000110f2c9f0>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"8"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 198], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["status", 2], ["updated_at", "2022-08-05 05:22:15.121285"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 245)
Completed 200 OK in 1819ms (Views: 1.3ms | ActiveRecord: 4.5ms | Allocations: 21159)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/8" for 127.0.0.1 at 2022-08-05 10:53:08 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"8"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 8017ms (Views: 1.0ms | ActiveRecord: 8.2ms | Allocations: 100455)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 10:53:28 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000109eab7f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-85605-plswss.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"200", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 200], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (1.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 200], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 05:23:31.233834"], ["updated_at", "2022-08-05 05:23:31.233834"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (1.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 46]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (1.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "nn4r50w8r83uzfzpykit3erm2sx4"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 05:23:31.366501"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.7ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 9], ["blob_id", 60], ["created_at", "2022-08-05 05:23:31.387066"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 05:23:31.402435"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: nn4r50w8r83uzfzpykit3erm2sx4 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 639c7906-2667-4e78-901f-28320bc51423) to Async(default) with arguments: #<GlobalID:0x000000010edc58c0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/46>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.9ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 60]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 4.6ms | Allocations: 486)
Completed 200 OK in 3568ms (Views: 15.9ms | ActiveRecord: 14.8ms | Allocations: 66795)


[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 46], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423] Performing ActiveStorage::PurgeJob (Job ID: 639c7906-2667-4e78-901f-28320bc51423) from Async(default) enqueued at 2022-08-05T05:23:31Z with arguments: #<GlobalID:0x000000010f926278 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/46>>
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mActiveStorage::Attachment Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 46], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mActiveStorage::VariantRecord Load (0.6ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 46]]
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mActiveStorage::Attachment Load (2.3ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 46], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mActiveStorage::Blob Destroy (0.8ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 46]]
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423]   [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: agbt2mc61qqp8hadi8muf3obpzac[0m
[ActiveJob] [ActiveStorage::PurgeJob] [639c7906-2667-4e78-901f-28320bc51423] Performed ActiveStorage::PurgeJob (Job ID: 639c7906-2667-4e78-901f-28320bc51423) from Async(default) in 183.1ms
Started PATCH "/api/v1/expense_tracker/users/50/expenses/9" for 127.0.0.1 at 2022-08-05 10:53:41 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"9"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (1.0ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 200], ["biller", "Lazzy"], ["created_at", "2022-08-05 05:24:39.060403"], ["updated_at", "2022-08-05 05:24:39.060403"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010fa35b50>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"9"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 200], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["status", 2], ["updated_at", "2022-08-05 05:24:41.024025"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 6.9ms | Allocations: 294)
Completed 200 OK in 60030ms (Views: 10.5ms | ActiveRecord: 11.2ms | Allocations: 149371)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/9" for 127.0.0.1 at 2022-08-05 10:55:05 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"approved", "description"=>"Travel"}, "user_id"=>"50", "id"=>"9"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 16283ms (Views: 1.0ms | ActiveRecord: 4.2ms | Allocations: 75374)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 10:55:33 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f92df50 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-85605-90vanc.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"202", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 202], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (1.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 202], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 05:25:36.923026"], ["updated_at", "2022-08-05 05:25:36.923026"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.5ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 35]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (1.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "xa8ou054wag2krapyvk9kewqn9e7"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 05:25:36.999112"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.7ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 10], ["blob_id", 61], ["created_at", "2022-08-05 05:25:37.017638"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 05:25:37.032574"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: xa8ou054wag2krapyvk9kewqn9e7 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 35], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a755928f-2b67-4e05-9f7b-bf5fff59e13c) to Async(default) with arguments: #<GlobalID:0x000000010fc147c8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/35>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.7ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 61]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.7ms | Allocations: 104)
Completed 200 OK in 3633ms (Views: 4.1ms | ActiveRecord: 11.5ms | Allocations: 38427)


[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 35], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c] Performing ActiveStorage::PurgeJob (Job ID: a755928f-2b67-4e05-9f7b-bf5fff59e13c) from Async(default) enqueued at 2022-08-05T05:25:37Z with arguments: #<GlobalID:0x000000010fce7538 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/35>>
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mActiveStorage::Attachment Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 35], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mActiveStorage::VariantRecord Load (0.4ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 35]]
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 35], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mActiveStorage::Blob Destroy (1.5ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 35]]
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c]   [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c] [36m  Disk Storage (14.6ms) [0m[31mDeleted file from key: qf2a9pmbfmjb3d7c4t7ulhp75smc[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a755928f-2b67-4e05-9f7b-bf5fff59e13c] Performed ActiveStorage::PurgeJob (Job ID: a755928f-2b67-4e05-9f7b-bf5fff59e13c) from Async(default) in 130.22ms
Started PATCH "/api/v1/expense_tracker/users/50/expenses/10" for 127.0.0.1 at 2022-08-05 10:55:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"approved", "description"=>"Travel"}, "user_id"=>"50", "id"=>"10"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010fe1f3d8>, params: {"expense"=>{"approved_amount"=>100, "status"=>"approved", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 202], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["updated_at", "2022-08-05 05:26:11.720836"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 6.1ms | Allocations: 162)
Completed 200 OK in 22591ms (Views: 11.8ms | ActiveRecord: 7.3ms | Allocations: 109864)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/10" for 127.0.0.1 at 2022-08-05 11:13:29 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"approved", "description"=>"Travel"}, "user_id"=>"50", "id"=>"10"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010febe488>, params: {"expense"=>{"approved_amount"=>100, "status"=>"approved", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 202], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 6.2ms | Allocations: 161)
Completed 200 OK in 60242ms (Views: 11.6ms | ActiveRecord: 7.2ms | Allocations: 108607)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/10" for 127.0.0.1 at 2022-08-05 11:14:47 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"rejected", "description"=>"Travel"}, "user_id"=>"50", "id"=>"10"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010fe5d188>, params: {"expense"=>{"approved_amount"=>100, "status"=>"rejected", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 202], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 4.4ms | Allocations: 161)
Completed 200 OK in 10179ms (Views: 8.1ms | ActiveRecord: 5.3ms | Allocations: 109163)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/10" for 127.0.0.1 at 2022-08-05 11:15:06 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"10"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (1.2ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 202], ["biller", "Skyba"], ["created_at", "2022-08-05 05:45:18.547933"], ["updated_at", "2022-08-05 05:45:18.547933"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010fea7da0>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 202], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-05 05:45:20.854096"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 5.2ms | Allocations: 162)
Completed 200 OK in 15419ms (Views: 9.0ms | ActiveRecord: 8.9ms | Allocations: 143857)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:05 +0530
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001173e7cc8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-j1lu20.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"204", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 204], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 204], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:05.662029"], ["updated_at", "2022-08-05 06:00:05.662029"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 36]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "01cpvj8kmes0ic4wbes0ge15m37l"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:05.679629"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 11], ["blob_id", 62], ["created_at", "2022-08-05 06:00:05.680675"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:05.681293"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 01cpvj8kmes0ic4wbes0ge15m37l (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 36], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: f9bcfc3c-3427-48ae-abeb-031571597c40) to Async(default) with arguments: #<GlobalID:0x000000011612d2b8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/36>>
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 62]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 1.4ms | Allocations: 603)
Completed 200 OK in 85ms (Views: 3.8ms | ActiveRecord: 4.0ms | Allocations: 60994)


[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 36], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40] Performing ActiveStorage::PurgeJob (Job ID: f9bcfc3c-3427-48ae-abeb-031571597c40) from Async(default) enqueued at 2022-08-05T06:00:05Z with arguments: #<GlobalID:0x00000001162542e0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/36>>
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 36], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 36]]
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 36], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 36]]
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40]   [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: 6b8dmqemk11jbcs5t7isiq7vjqcv[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f9bcfc3c-3427-48ae-abeb-031571597c40] Performed ActiveStorage::PurgeJob (Job ID: f9bcfc3c-3427-48ae-abeb-031571597c40) from Async(default) in 29.84ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000117314a08 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-61fqsd.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"206", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 206], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 206], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:11.433536"], ["updated_at", "2022-08-05 06:00:11.433536"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 37]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "snutgrdfimptc0kbw307t0ec6ox7"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:11.437794"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 12], ["blob_id", 63], ["created_at", "2022-08-05 06:00:11.438608"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:11.439215"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: snutgrdfimptc0kbw307t0ec6ox7 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 37], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: aedbee82-3ab5-4188-8895-e805b1b6f198) to Async(default) with arguments: #<GlobalID:0x00000001175a5830 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/37>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 63]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.4ms | Allocations: 240)
Completed 200 OK in 16ms (Views: 1.1ms | ActiveRecord: 1.8ms | Allocations: 16229)


[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 37], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198] Performing ActiveStorage::PurgeJob (Job ID: aedbee82-3ab5-4188-8895-e805b1b6f198) from Async(default) enqueued at 2022-08-05T06:00:11Z with arguments: #<GlobalID:0x00000001176251e8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/37>>
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 37], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 37]]
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 37], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 37]]
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198]   [1m[36mTRANSACTION (18.0ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: iacwpcrjeo7v3gg52hjqt95nh8n3[0m
[ActiveJob] [ActiveStorage::PurgeJob] [aedbee82-3ab5-4188-8895-e805b1b6f198] Performed ActiveStorage::PurgeJob (Job ID: aedbee82-3ab5-4188-8895-e805b1b6f198) from Async(default) in 24.45ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000012012e528 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-vsn2x7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"208", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 208], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 208], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:14.694219"], ["updated_at", "2022-08-05 06:00:14.694219"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (2.8ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 19]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "4yvwci6rer8g12tomrlnlr36bgu3"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:14.724492"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 13], ["blob_id", 64], ["created_at", "2022-08-05 06:00:14.727249"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:14.729024"], ["id", 13]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 4yvwci6rer8g12tomrlnlr36bgu3 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ca959ba1-9e24-4013-a386-408c2f639d4c) to Async(default) with arguments: #<GlobalID:0x00000001201ae020 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/19>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 64]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.7ms | Allocations: 104)
Completed 200 OK in 70ms (Views: 2.9ms | ActiveRecord: 5.9ms | Allocations: 15790)


[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 19], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c] Performing ActiveStorage::PurgeJob (Job ID: ca959ba1-9e24-4013-a386-408c2f639d4c) from Async(default) enqueued at 2022-08-05T06:00:14Z with arguments: #<GlobalID:0x000000012042ed40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/19>>
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 19], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 19]]
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 19], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 19]]
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: t88uy6zk64x86m6w97328oymscn6[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ca959ba1-9e24-4013-a386-408c2f639d4c] Performed ActiveStorage::PurgeJob (Job ID: ca959ba1-9e24-4013-a386-408c2f639d4c) from Async(default) in 12.45ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:18 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001122edf70 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-98co0u.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"300", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 300], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 300], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:18.477379"], ["updated_at", "2022-08-05 06:00:18.477379"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 20]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "7eqm51zbqysciz4ybjmksv9abxi3"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:18.481746"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 14], ["blob_id", 65], ["created_at", "2022-08-05 06:00:18.482612"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:18.483171"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 7eqm51zbqysciz4ybjmksv9abxi3 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 4e63740e-0eb8-4211-a863-24792024d558) to Async(default) with arguments: #<GlobalID:0x0000000114d870d8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/20>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 65]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 89)
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 15380)


[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 20], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558] Performing ActiveStorage::PurgeJob (Job ID: 4e63740e-0eb8-4211-a863-24792024d558) from Async(default) enqueued at 2022-08-05T06:00:18Z with arguments: #<GlobalID:0x000000011614f9a8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/20>>
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 20], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 20]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 20], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 20]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: hm1orftnqpjt8scr7g0h3uhqm5yg[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e63740e-0eb8-4211-a863-24792024d558] Performed ActiveStorage::PurgeJob (Job ID: 4e63740e-0eb8-4211-a863-24792024d558) from Async(default) in 24.22ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:23 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116235160 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-o1aoez.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"301", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 301], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 301], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:23.314012"], ["updated_at", "2022-08-05 06:00:23.314012"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 15], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 21]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "u78qac7ydmqb9vb8sbe96ny7yajt"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:23.318126"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 15], ["blob_id", 66], ["created_at", "2022-08-05 06:00:23.318967"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:23.319626"], ["id", 15]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: u78qac7ydmqb9vb8sbe96ny7yajt (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 75282e75-a131-451c-9522-5c5d30c88e1d) to Async(default) with arguments: #<GlobalID:0x0000000117304720 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/21>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 66]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 89)
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 15292)


[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 21], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d] Performing ActiveStorage::PurgeJob (Job ID: 75282e75-a131-451c-9522-5c5d30c88e1d) from Async(default) enqueued at 2022-08-05T06:00:23Z with arguments: #<GlobalID:0x0000000117374fe8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/21>>
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 21], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 21]]
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 21], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 21]]
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: 5jz21phd1gzetb87e54u1ky3yzuy[0m
[ActiveJob] [ActiveStorage::PurgeJob] [75282e75-a131-451c-9522-5c5d30c88e1d] Performed ActiveStorage::PurgeJob (Job ID: 75282e75-a131-451c-9522-5c5d30c88e1d) from Async(default) in 26.05ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011751f618 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-nrcfbo.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"302", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 302], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 302], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:26.643522"], ["updated_at", "2022-08-05 06:00:26.643522"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 16], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 16], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 3]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6b4ztgngh9i6f3bkcy93wdpyqnii"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:26.647647"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 16], ["blob_id", 67], ["created_at", "2022-08-05 06:00:26.648373"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:26.648834"], ["id", 16]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 6b4ztgngh9i6f3bkcy93wdpyqnii (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a3149e73-4d07-43a9-842b-9400c5342da7) to Async(default) with arguments: #<GlobalID:0x00000001176bdb28 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/3>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 67]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 15288)


[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7] Performing ActiveStorage::PurgeJob (Job ID: a3149e73-4d07-43a9-842b-9400c5342da7) from Async(default) enqueued at 2022-08-05T06:00:26Z with arguments: #<GlobalID:0x000000012013ef40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/3>>
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 3], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mActiveStorage::Blob Destroy (0.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 3]]
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7]   [1m[36mTRANSACTION (17.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7] [36m  Disk Storage (1.2ms) [0m[31mDeleted file from key: vs47er2b8ygo2bwjznhv30pkbu9y[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a3149e73-4d07-43a9-842b-9400c5342da7] Performed ActiveStorage::PurgeJob (Job ID: a3149e73-4d07-43a9-842b-9400c5342da7) from Async(default) in 25.04ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:29 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000012042fad8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-4bpu6z.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"303", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 303], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.7ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 303], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:29.717902"], ["updated_at", "2022-08-05 06:00:29.717902"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 17], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 17], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 4]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "18walwqufpirhj77vprvlfu44n0m"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:29.722391"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 17], ["blob_id", 68], ["created_at", "2022-08-05 06:00:29.723112"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:29.723584"], ["id", 17]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 18walwqufpirhj77vprvlfu44n0m (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: c227f59d-f227-4573-8c12-a14259512f64) to Async(default) with arguments: #<GlobalID:0x0000000110c4f638 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/4>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 68]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.4ms | Allocations: 88)
Completed 200 OK in 17ms (Views: 0.6ms | ActiveRecord: 2.4ms | Allocations: 15275)


[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64] Performing ActiveStorage::PurgeJob (Job ID: c227f59d-f227-4573-8c12-a14259512f64) from Async(default) enqueued at 2022-08-05T06:00:29Z with arguments: #<GlobalID:0x0000000113205968 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/4>>
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 4], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 4]]
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mActiveStorage::Blob Destroy (17.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 4]]
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: h9j85iuxzpsouzwg5yg808yn7scz[0m
[ActiveJob] [ActiveStorage::PurgeJob] [c227f59d-f227-4573-8c12-a14259512f64] Performed ActiveStorage::PurgeJob (Job ID: c227f59d-f227-4573-8c12-a14259512f64) from Async(default) in 23.72ms
Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000113cd5a00 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-styiym.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"302", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 302], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 8ms (Views: 0.1ms | ActiveRecord: 1.9ms | Allocations: 6355)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:36 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116165ac8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-90581-33m4zm.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"304", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 304], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 304], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 06:00:36.147611"], ["updated_at", "2022-08-05 06:00:36.147611"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 18], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 18], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 5]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "48799mly7e8jcichw1p4850f2w83"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 06:00:36.150720"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 18], ["blob_id", 69], ["created_at", "2022-08-05 06:00:36.151532"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 06:00:36.152049"], ["id", 18]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 48799mly7e8jcichw1p4850f2w83 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 3587b6aa-645f-4f56-8c0e-cc42c154f9cd) to Async(default) with arguments: #<GlobalID:0x00000001162a64f0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/5>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 69]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 15264)


[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 5], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd] Performing ActiveStorage::PurgeJob (Job ID: 3587b6aa-645f-4f56-8c0e-cc42c154f9cd) from Async(default) enqueued at 2022-08-05T06:00:36Z with arguments: #<GlobalID:0x00000001165b7608 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/5>>
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 5], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 5]]
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 5]]
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd]   [1m[36mTRANSACTION (18.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: rfl6fvffurjcuckg7gcmooxeb3fo[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3587b6aa-645f-4f56-8c0e-cc42c154f9cd] Performed ActiveStorage::PurgeJob (Job ID: 3587b6aa-645f-4f56-8c0e-cc42c154f9cd) from Async(default) in 24.9ms
Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 11:30:58 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.9ms | Allocations: 4183)
Completed 200 OK in 10ms (Views: 3.1ms | ActiveRecord: 1.1ms | Allocations: 11616)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:31:59 +0530
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:02:39.578296"], ["updated_at", "2022-08-05 06:02:39.578296"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 110956ms (Views: 0.9ms | ActiveRecord: 10.3ms | Allocations: 100155)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:34:34 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (0.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:04:39.084825"], ["updated_at", "2022-08-05 06:04:39.084825"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 6956ms (Views: 0.8ms | ActiveRecord: 14.0ms | Allocations: 70499)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:35:36 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:05:41.891256"], ["updated_at", "2022-08-05 06:05:41.891256"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 3]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 20.0ms | Allocations: 2526)
Completed 200 OK in 12494ms (Views: 26.5ms | ActiveRecord: 13.1ms | Allocations: 105491)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:37:07 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:07:13.436940"], ["updated_at", "2022-08-05 06:07:13.436940"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 8831ms (Views: 0.8ms | ActiveRecord: 13.7ms | Allocations: 79055)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:37:57 +0530
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:08:02.603196"], ["updated_at", "2022-08-05 06:08:02.603196"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 5657ms (Views: 1.0ms | ActiveRecord: 11.0ms | Allocations: 83523)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:39:07 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:09:11.015742"], ["updated_at", "2022-08-05 06:09:11.015742"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 4020ms (Views: 1.0ms | ActiveRecord: 14.2ms | Allocations: 54295)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:42:15 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:12:19.941879"], ["updated_at", "2022-08-05 06:12:19.941879"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 5106ms (ActiveRecord: 14.7ms | Allocations: 65112)


  
NameError (uninitialized constant ApplicationController::InternalServerError

    elsif exception.is_a?(InternalServerError)
                          ^^^^^^^^^^^^^^^^^^^
Did you mean?  ApplicationController::INTERNAL_SERVER_ERROR):
  
app/controllers/application_controller.rb:28:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:45:05 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:15:09.684202"], ["updated_at", "2022-08-05 06:15:09.684202"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 4546ms (ActiveRecord: 14.8ms | Allocations: 62756)


  
TypeError (class or module required):
  
app/controllers/application_controller.rb:28:in `is_a?'
app/controllers/application_controller.rb:28:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:47:02 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:17:07.606317"], ["updated_at", "2022-08-05 06:17:07.606317"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 5041ms (ActiveRecord: 14.2ms | Allocations: 68947)


  
NoMethodError (undefined method `message=' for #<NoMethodError: undefined method `push' for nil:NilClass

    @already_processed_expenses.push(expense.id)
                               ^^^^^>

      exception.message = 'Something went wrong'
               ^^^^^^^^^^
Did you mean?  message):
  
app/controllers/application_controller.rb:29:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:48:25 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:18:30.388353"], ["updated_at", "2022-08-05 06:18:30.388353"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 6090ms (ActiveRecord: 16.6ms | Allocations: 74969)


  
NameError (undefined local variable or method `excpetion' for #<ReportsController:0x000000000410f0>

    message = excpetion.message
              ^^^^^^^^^
Did you mean?  exception):
  
app/controllers/application_controller.rb:24:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:51:15 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:21:20.805257"], ["updated_at", "2022-08-05 06:21:20.805257"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 6502ms (ActiveRecord: 14.5ms | Allocations: 64517)


  
NoMethodError (undefined method `message=' for #<NoMethodError: undefined method `push' for nil:NilClass

    @already_processed_expenses.push(expense.id)
                               ^^^^^>

      exception.message = 'something'
               ^^^^^^^^^^
Did you mean?  message):
  
app/controllers/application_controller.rb:30:in `error_response_handler'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:52:48 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:22:53.975781"], ["updated_at", "2022-08-05 06:22:53.975781"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
Completed 500 Internal Server Error in 17024ms (Views: 1.0ms | ActiveRecord: 16.3ms | Allocations: 77346)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:58:54 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:28:59.283730"], ["updated_at", "2022-08-05 06:28:59.283730"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 2563.0ms | Allocations: 20126)
Completed 500 Internal Server Error in 7561ms (Views: 2.7ms | ActiveRecord: 13.1ms | Allocations: 89583)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 11:59:36 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:29:40.203205"], ["updated_at", "2022-08-05 06:29:40.203205"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1303.5ms | Allocations: 7364)
Completed 500 Internal Server Error in 15185ms (Views: 0.9ms | ActiveRecord: 7.2ms | Allocations: 64897)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:00:23 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:30:25.720309"], ["updated_at", "2022-08-05 06:30:25.720309"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 15]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 25.7ms | Allocations: 1807)
Completed 200 OK in 4248ms (Views: 31.0ms | ActiveRecord: 6.9ms | Allocations: 41037)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:00:58 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:31:01.292810"], ["updated_at", "2022-08-05 06:31:01.292810"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1306.4ms | Allocations: 7465)
Completed 500 Internal Server Error in 7681ms (Views: 1.0ms | ActiveRecord: 7.5ms | Allocations: 59516)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:02:17 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:32:23.441355"], ["updated_at", "2022-08-05 06:32:23.441355"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1378.9ms | Allocations: 7906)
Completed 500 Internal Server Error in 110364ms (Views: 2.3ms | ActiveRecord: 14.7ms | Allocations: 100597)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:06:25 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:36:30.997208"], ["updated_at", "2022-08-05 06:36:30.997208"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1381.8ms | Allocations: 8583)
Completed 500 Internal Server Error in 10289ms (Views: 2.5ms | ActiveRecord: 10.9ms | Allocations: 108286)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:09:34 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:39:37.812756"], ["updated_at", "2022-08-05 06:39:37.812756"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 39814.9ms | Allocations: 44669)
Completed 500 Internal Server Error in 53401ms (Views: 2.4ms | ActiveRecord: 6.9ms | Allocations: 99593)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:10:31 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:40:33.760185"], ["updated_at", "2022-08-05 06:40:33.760185"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 20]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 2577.9ms | Allocations: 19693)
Completed 200 OK in 7374ms (Views: 2583.7ms | ActiveRecord: 7.3ms | Allocations: 76354)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:10:55 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:40:58.448181"], ["updated_at", "2022-08-05 06:40:58.448181"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 21]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 140859.9ms | Allocations: 36830)
Completed 200 OK in 146938ms (Views: 140866.6ms | ActiveRecord: 5.9ms | Allocations: 85138)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:13:25 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:43:27.709629"], ["updated_at", "2022-08-05 06:43:27.709629"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 22]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 1144.8ms | Allocations: 19008)
Completed 200 OK in 4300ms (Views: 1149.1ms | ActiveRecord: 6.5ms | Allocations: 47709)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:15:40 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:45:41.842933"], ["updated_at", "2022-08-05 06:45:41.842933"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 23], ["LIMIT", 11]]
  ↳ app/views/reports/create.jbuilder:2
  Rendered reports/create.jbuilder (Duration: 683.3ms | Allocations: 9134)
Completed 500 Internal Server Error in 5011ms (Views: 1.5ms | ActiveRecord: 6.5ms | Allocations: 44352)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:16:03 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:46:05.529627"], ["updated_at", "2022-08-05 06:46:05.529627"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 24], ["LIMIT", 11]]
  ↳ app/views/reports/create.jbuilder:2
  Rendered reports/create.jbuilder (Duration: 5458.4ms | Allocations: 19668)
Completed 500 Internal Server Error in 86045ms (Views: 2.4ms | ActiveRecord: 6.4ms | Allocations: 70490)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:18:08 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:48:10.643434"], ["updated_at", "2022-08-05 06:48:10.643434"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:18:58 +0530
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:49:04.296189"], ["updated_at", "2022-08-05 06:49:04.296189"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 2220.6ms | Allocations: 31011)
Completed 500 Internal Server Error in 15239ms (Views: 2.4ms | ActiveRecord: 11.0ms | Allocations: 132203)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:20:09 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:50:12.632434"], ["updated_at", "2022-08-05 06:50:12.632434"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 4361.5ms | Allocations: 43875)
Completed 500 Internal Server Error in 55650ms (Views: 2.5ms | ActiveRecord: 6.1ms | Allocations: 113437)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:21:07 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:51:11.463850"], ["updated_at", "2022-08-05 06:51:11.463850"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 178253.3ms | Allocations: 54188)
Completed 500 Internal Server Error in 193062ms (Views: 2.1ms | ActiveRecord: 12.1ms | Allocations: 130582)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:24:25 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:54:27.103593"], ["updated_at", "2022-08-05 06:54:27.103593"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 29]]
  ↳ app/views/reports/create.jbuilder:4
  Rendered reports/create.jbuilder (Duration: 1502.2ms | Allocations: 15017)
Completed 200 OK in 4245ms (Views: 1506.4ms | ActiveRecord: 6.9ms | Allocations: 40034)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:24:53 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:54:55.197547"], ["updated_at", "2022-08-05 06:54:55.197547"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 771.5ms | Allocations: 15078)
Completed 500 Internal Server Error in 125978ms (Views: 1.8ms | ActiveRecord: 4.9ms | Allocations: 41221)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:29:21 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 06:59:23.540544"], ["updated_at", "2022-08-05 06:59:23.540544"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 3136.5ms | Allocations: 19744)
Completed 500 Internal Server Error in 22326ms (Views: 1.9ms | ActiveRecord: 6.1ms | Allocations: 55473)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:30:53 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:00:54.510405"], ["updated_at", "2022-08-05 07:00:54.510405"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (2.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 32], ["LIMIT", 11]]
  ↳ app/views/reports/create.jbuilder:4
  Rendered reports/create.jbuilder (Duration: 763.2ms | Allocations: 9193)
Completed 500 Internal Server Error in 4436ms (Views: 1.8ms | ActiveRecord: 7.3ms | Allocations: 45069)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:31:02 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:01:03.388160"], ["updated_at", "2022-08-05 07:01:03.388160"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 33], ["LIMIT", 11]]
  ↳ app/views/reports/create.jbuilder:4
  Rendered reports/create.jbuilder (Duration: 8194.2ms | Allocations: 19763)
Completed 500 Internal Server Error in 24140ms (Views: 2.0ms | ActiveRecord: 5.9ms | Allocations: 64045)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:32:25 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:02:26.568493"], ["updated_at", "2022-08-05 07:02:26.568493"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 60893.9ms | Allocations: 41459)
Completed 500 Internal Server Error in 72697ms (Views: 2.1ms | ActiveRecord: 5.1ms | Allocations: 76319)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:34:45 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (0.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:04:48.646824"], ["updated_at", "2022-08-05 07:04:48.646824"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 35]]
  ↳ app/views/reports/create.jbuilder:5
  Rendered reports/create.jbuilder (Duration: 1188.0ms | Allocations: 11639)
Completed 200 OK in 4664ms (Views: 1192.6ms | ActiveRecord: 12.6ms | Allocations: 66425)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:35:50 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:05:52.420976"], ["updated_at", "2022-08-05 07:05:52.420976"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 36]]
  ↳ app/views/reports/create.jbuilder:5
  Rendered reports/create.jbuilder (Duration: 1418.9ms | Allocations: 18785)
Completed 200 OK in 16262ms (Views: 1422.7ms | ActiveRecord: 7.1ms | Allocations: 62397)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:36:26 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:06:28.158512"], ["updated_at", "2022-08-05 07:06:28.158512"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 2 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 37]]
  ↳ app/views/reports/create.jbuilder:4
  Rendered reports/create.jbuilder (Duration: 1094.8ms | Allocations: 18957)
Completed 200 OK in 4976ms (Views: 1100.2ms | ActiveRecord: 6.3ms | Allocations: 57703)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:38:02 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 8, 9], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:08:03.800321"], ["updated_at", "2022-08-05 07:08:03.800321"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 8 is already processed 
expense 9 is already processed 
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 38]]
  ↳ app/views/reports/create.jbuilder:9
  Rendered reports/create.jbuilder (Duration: 1385.2ms | Allocations: 8212)
Completed 200 OK in 5804ms (Views: 1390.9ms | ActiveRecord: 6.4ms | Allocations: 53514)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:38:41 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 12, 11], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:08:42.957157"], ["updated_at", "2022-08-05 07:08:42.957157"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 204], ["id", 11], ["LIMIT", 1]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 07:08:45.328754"], ["report_id", 39], ["id", 11]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 206], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Update (1.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 07:08:45.968590"], ["report_id", 39], ["id", 12]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 39]]
  ↳ app/views/reports/create.jbuilder:9
  Rendered reports/create.jbuilder (Duration: 747.6ms | Allocations: 8325)
Completed 200 OK in 4769ms (Views: 750.1ms | ActiveRecord: 12.9ms | Allocations: 58955)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:40:24 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 12, 11], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:10:25.599772"], ["updated_at", "2022-08-05 07:10:25.599772"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 11 is already mapped with report 39
expense 12 is already mapped with report 39
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1000.0ms | Allocations: 14691)
Completed 500 Internal Server Error in 7455ms (Views: 1.6ms | ActiveRecord: 4.8ms | Allocations: 59226)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:40:54 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 12, 13], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.5ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:10:55.350225"], ["updated_at", "2022-08-05 07:10:55.350225"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 12 is already mapped with report 39
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 208], ["id", 13], ["LIMIT", 1]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 07:10:59.170272"], ["report_id", 41], ["id", 13]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1292.1ms | Allocations: 14657)
Completed 500 Internal Server Error in 14705ms (Views: 2.5ms | ActiveRecord: 9.0ms | Allocations: 77561)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 12:41:59 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 121.8ms | Allocations: 3475)
Completed 200 OK in 1784ms (Views: 126.6ms | ActiveRecord: 6.2ms | Allocations: 27437)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:42:39 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 14], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.8ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:12:40.335717"], ["updated_at", "2022-08-05 07:12:40.335717"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 300], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 07:12:42.769202"], ["report_id", 42], ["id", 14]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1042.5ms | Allocations: 14659)
Completed 500 Internal Server Error in 6056ms (Views: 1.6ms | ActiveRecord: 10.0ms | Allocations: 64560)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:44:09 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:14:10.604682"], ["updated_at", "2022-08-05 07:14:10.604682"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 07:14:12.933129"], ["report_id", 43], ["id", 15]]
  ↳ app/models/report.rb:36:in `block in map_expenses'
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:36:in `block in map_expenses'
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 43]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 758.3ms | Allocations: 8321)
Completed 200 OK in 4543ms (Views: 761.7ms | ActiveRecord: 11.1ms | Allocations: 50091)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 12:44:34 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:14:35.376330"], ["updated_at", "2022-08-05 07:14:35.376330"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
  Rendering reports/create.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 44]]
  ↳ app/views/reports/create.jbuilder:3
  Rendered reports/create.jbuilder (Duration: 771.1ms | Allocations: 8207)
Completed 200 OK in 3812ms (Views: 775.3ms | ActiveRecord: 6.3ms | Allocations: 38120)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:13:24 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:43:29.363263"], ["updated_at", "2022-08-05 07:43:29.363263"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
  [1m[36mExpense Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 45]]
  ↳ app/models/report.rb:54:in `valid_report?'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 3747.1ms | Allocations: 7278)
Completed 200 OK in 9184ms (Views: 3753.7ms | ActiveRecord: 9.5ms | Allocations: 77741)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:13:43 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:43:45.783575"], ["updated_at", "2022-08-05 07:43:45.783575"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:14:47 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:44:50.685991"], ["updated_at", "2022-08-05 07:44:50.685991"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
  [1m[36mExpense Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 47]]
  ↳ app/models/report.rb:54:in `valid_report?'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 3523.1ms | Allocations: 12469)
Completed 200 OK in 19032ms (Views: 3533.7ms | ActiveRecord: 12.6ms | Allocations: 110219)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:15:34 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:45:38.999894"], ["updated_at", "2022-08-05 07:45:38.999894"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
  [1m[36mExpense Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 48]]
  ↳ app/models/report.rb:54:in `valid_report?'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 6347.7ms | Allocations: 7456)
Completed 200 OK in 32915ms (Views: 6354.9ms | ActiveRecord: 16.9ms | Allocations: 91899)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:16:12 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 07:46:13.615394"], ["updated_at", "2022-08-05 07:46:13.615394"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
expense 1 is already processed 
expense 15 is already mapped with report 43
  [1m[36mExpense Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 49]]
  ↳ app/models/report.rb:54:in `valid_report?'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 808.5ms | Allocations: 11914)
Completed 200 OK in 972918ms (Views: 812.7ms | ActiveRecord: 8.6ms | Allocations: 79368)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 13:32:29 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (2.1ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 08:02:37.411566"], ["updated_at", "2022-08-05 08:02:37.411566"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 08:02:46.723609"], ["report_id", 50], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 08:02:46.758007"], ["report_id", 50], ["id", 15]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped with report 50
expense 1 is already processed 50
expense 15 is already mapped with report 50
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 960.6ms | Allocations: 7394)
Completed 200 OK in 68232ms (Views: 970.1ms | ActiveRecord: 16.7ms | Allocations: 112972)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:39:19 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:40:17 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 59560ms (Views: 3.1ms | ActiveRecord: 11.3ms | Allocations: 86050)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:41:51 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 26ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 30201)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:42:27 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 106463ms (Views: 2.7ms | ActiveRecord: 11.5ms | Allocations: 77375)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:44:21 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 62666ms (Views: 2.0ms | ActiveRecord: 14.1ms | Allocations: 75836)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:48:34 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 70498ms (Views: 2.3ms | ActiveRecord: 13.1ms | Allocations: 77919)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:49:52 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 50
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 54121ms (Views: 2.8ms | ActiveRecord: 14.5ms | Allocations: 70407)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:50:50 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 50
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 10893ms (Views: 3.0ms | ActiveRecord: 13.4ms | Allocations: 70138)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:51:12 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 50
  [1m[36mReport Create (2.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 09:21:17.194428"], ["updated_at", "2022-08-05 09:21:17.194428"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:21:19.110295"], ["report_id", 51], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:21:19.145472"], ["report_id", 51], ["id", 15]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:52:51 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 33ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 33218)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:53:17 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 20ms (Views: 0.1ms | ActiveRecord: 1.8ms | Allocations: 24374)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:53:51 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 86490ms (Views: 1.9ms | ActiveRecord: 11.9ms | Allocations: 118216)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:55:22 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 82403ms (Views: 1.6ms | ActiveRecord: 13.5ms | Allocations: 94314)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:56:56 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 26258ms (Views: 2.1ms | ActiveRecord: 5.6ms | Allocations: 62276)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:57:24 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 5951ms (Views: 1.7ms | ActiveRecord: 11.8ms | Allocations: 82850)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:57:38 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 41193ms (Views: 1.4ms | ActiveRecord: 5.3ms | Allocations: 56212)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 14:58:22 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 15], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 1 is already mapped or processed report 51
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 400 Bad Request in 8422ms (Views: 2.2ms | ActiveRecord: 11.8ms | Allocations: 89399)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 15:09:04 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 133.3ms | Allocations: 3769)
Completed 200 OK in 1793ms (Views: 141.6ms | ActiveRecord: 8.2ms | Allocations: 25974)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:10:02 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 16], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 302], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mReport Create (1.7ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 09:40:04.961166"], ["updated_at", "2022-08-05 09:40:04.961166"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:40:18.397252"], ["report_id", 52], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 302], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:40:18.434674"], ["report_id", 52], ["id", 16]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:15:19 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 16], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 302], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 52
expense 16 is already mapped or processed report 52
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 400 Bad Request in 36ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 30214)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:15:26 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 17], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 303], ["id", 17], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 52
  [1m[36mReport Create (0.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 09:45:26.277634"], ["updated_at", "2022-08-05 09:45:26.277634"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:45:26.279487"], ["report_id", 53], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 303], ["id", 17], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 09:45:26.280723"], ["report_id", 53], ["id", 17]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1.0ms | Allocations: 605)
Completed 200 OK in 14ms (Views: 2.9ms | ActiveRecord: 1.6ms | Allocations: 15098)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:19:10 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 18], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 53
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 20ms (Views: 0.1ms | ActiveRecord: 2.0ms | Allocations: 22528)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:19:47 +0530
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 18], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 53
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 59788ms (Views: 2.6ms | ActiveRecord: 11.5ms | Allocations: 88485)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:20:52 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 18], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 53
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 38174ms (Views: 2.7ms | ActiveRecord: 14.9ms | Allocations: 82466)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:21:33 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 18], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 53
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 802601ms (Views: 3.7ms | ActiveRecord: 15.6ms | Allocations: 97953)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:35:02 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 18], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 53
  [1m[36mReport Create (3.0ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 10:05:06.712409"], ["updated_at", "2022-08-05 10:05:06.712409"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 10:05:38.144150"], ["report_id", 54], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 10:05:38.182549"], ["report_id", 54], ["id", 18]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 2044.9ms | Allocations: 12585)
Completed 200 OK in 36415ms (Views: 2054.2ms | ActiveRecord: 21.2ms | Allocations: 139276)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:36:14 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mReport Create (1.9ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 10:06:24.202081"], ["updated_at", "2022-08-05 10:06:24.202081"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 664.6ms | Allocations: 7269)
Completed 200 OK in 13323ms (Views: 670.4ms | ActiveRecord: 16.0ms | Allocations: 96676)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 15:37:03 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010647caa0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-18963-a463xw.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"306", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 306], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 306], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 10:07:13.631166"], ["updated_at", "2022-08-05 10:07:13.631166"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 19], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 19], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 6]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6vtdiizs9wo9xyuiui6i4hpbt98v"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 10:07:13.645802"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 19], ["blob_id", 70], ["created_at", "2022-08-05 10:07:13.647179"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 10:07:13.647908"], ["id", 19]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: 6vtdiizs9wo9xyuiui6i4hpbt98v (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: f43cf61a-134d-4259-a2a2-46d4b88182e1) to Async(default) with arguments: #<GlobalID:0x0000000106d119e0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/6>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 70]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.7ms | Allocations: 304)
Completed 200 OK in 8383ms (Views: 1.4ms | ActiveRecord: 6.5ms | Allocations: 59848)


[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1] Performing ActiveStorage::PurgeJob (Job ID: f43cf61a-134d-4259-a2a2-46d4b88182e1) from Async(default) enqueued at 2022-08-05T10:07:13Z with arguments: #<GlobalID:0x0000000106dd1ee8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/6>>
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 6], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 6]]
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 6]]
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1] [36m  Disk Storage (1.0ms) [0m[31mDeleted file from key: ijbu8huexo2kovxmc4g0nqgmnxl7[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f43cf61a-134d-4259-a2a2-46d4b88182e1] Performed ActiveStorage::PurgeJob (Job ID: f43cf61a-134d-4259-a2a2-46d4b88182e1) from Async(default) in 30.27ms
Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:37:24 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 400 Bad Request in 12569ms (Views: 1.9ms | ActiveRecord: 5.6ms | Allocations: 83853)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 15:37:51 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 4.3ms | Allocations: 3517)
Completed 200 OK in 4539ms (Views: 4.6ms | ActiveRecord: 2.4ms | Allocations: 20433)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:38:14 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 400 Bad Request in 118094ms (Views: 1.4ms | ActiveRecord: 5.3ms | Allocations: 70395)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:40:15 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 56837ms (Views: 2.0ms | ActiveRecord: 12.8ms | Allocations: 99686)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:41:16 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 34229ms (Views: 2.1ms | ActiveRecord: 14.3ms | Allocations: 104078)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:41:55 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 58313ms (Views: 2.0ms | ActiveRecord: 14.4ms | Allocations: 79522)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:42:58 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
Completed 500 Internal Server Error in 64402ms (Views: 2.4ms | ActiveRecord: 14.5ms | Allocations: 111485)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 15:44:07 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 19], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:77:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:82:in `expenses'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mReport Create (2.2ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 10:14:12.057985"], ["updated_at", "2022-08-05 10:14:12.057985"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 10:14:16.189948"], ["report_id", 56], ["id", 19]]
  ↳ app/controllers/reports_controller.rb:30:in `create'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:30:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1163.4ms | Allocations: 7338)
Completed 200 OK in 7749ms (Views: 1168.3ms | ActiveRecord: 17.5ms | Allocations: 102880)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 18:29:00 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010a7856f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-35055-oq26em.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"308", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 308], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 308], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 12:59:00.272684"], ["updated_at", "2022-08-05 12:59:00.272684"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 20], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 20], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "4iz3jd8ngodcby7yt9avnlpc2cmy"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 12:59:00.289154"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 20], ["blob_id", 71], ["created_at", "2022-08-05 12:59:00.290093"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 12:59:00.290885"], ["id", 20]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 4iz3jd8ngodcby7yt9avnlpc2cmy (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 71]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.8ms | Allocations: 474)
Completed 200 OK in 78ms (Views: 2.4ms | ActiveRecord: 3.8ms | Allocations: 57204)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/10" for 127.0.0.1 at 2022-08-05 18:29:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 11ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 10271)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/11" for 127.0.0.1 at 2022-08-05 18:29:38 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"11"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.5ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 204], ["biller", "Roodel"], ["created_at", "2022-08-05 12:59:39.897434"], ["updated_at", "2022-08-05 12:59:39.897434"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000010a505c70>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"11"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 204], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["status", 2], ["updated_at", "2022-08-05 12:59:39.905893"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.4ms | Allocations: 290)
Completed 200 OK in 1832ms (Views: 2.5ms | ActiveRecord: 4.1ms | Allocations: 22588)


Started POST "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 18:29:51 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010aa6e338 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220805-35055-bv1cer.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"400", "description"=>"Other"}, "user_id"=>"50"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 400], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 100], ["date", nil], ["invoice_number", 400], ["status", 0], ["user_id", 50], ["created_at", "2022-08-05 12:59:51.449661"], ["updated_at", "2022-08-05 12:59:51.449661"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 21], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 21], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "kwzn8rto6tn8pmj6q1ic60bh1dr3"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-05 12:59:51.461679"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 21], ["blob_id", 72], ["created_at", "2022-08-05 12:59:51.467121"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 12:59:51.472591"], ["id", 21]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: kwzn8rto6tn8pmj6q1ic60bh1dr3 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (3.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 72]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.8ms | Allocations: 185)
Completed 200 OK in 54ms (Views: 1.1ms | ActiveRecord: 6.3ms | Allocations: 13914)


Started GET "/api/v1/expense_tracker/users/50/expenses/12" for 127.0.0.1 at 2022-08-05 18:29:57 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"50", "id"=>"12"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 1.0ms | Allocations: 326)
Completed 200 OK in 4ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 3944)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/12" for 127.0.0.1 at 2022-08-05 18:30:09 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"12"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.6ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 206], ["biller", "Centimia"], ["created_at", "2022-08-05 13:00:11.059505"], ["updated_at", "2022-08-05 13:00:11.059505"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000109b25430>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"12"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 206], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["status", 2], ["updated_at", "2022-08-05 13:00:11.069805"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 121)
Completed 200 OK in 1903ms (Views: 0.7ms | ActiveRecord: 3.5ms | Allocations: 11719)


Started GET "/api/v1/expense_tracker/users/50/reports/19" for 127.0.0.1 at 2022-08-05 18:40:24 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"19", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:52:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 19]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 8.1ms | Allocations: 5093)
Completed 200 OK in 29ms (Views: 9.2ms | ActiveRecord: 3.6ms | Allocations: 19033)


Started GET "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 18:40:46 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"56", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:52:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.9ms | Allocations: 2806)
Completed 200 OK in 5ms (Views: 2.1ms | ActiveRecord: 0.5ms | Allocations: 6197)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 18:41:50 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 9.8ms | Allocations: 5787)
Completed 200 OK in 18ms (Views: 9.0ms | ActiveRecord: 1.6ms | Allocations: 8856)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 18:51:22 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/Users/kasinathan.veerappan/expense_tracker/app/models/report.rb:81: syntax error, unexpected end-of-input, expecting `end'):
  
app/models/report.rb:81: syntax error, unexpected end-of-input, expecting `end'
app/models/report.rb:81: syntax error, unexpected end-of-input, expecting `end'
app/models/report.rb:81: syntax error, unexpected end-of-input, expecting `end'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 18:52:59 +0530
  [1m[35m (1.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"56", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:102:in `process_report'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000115e8bbe0>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"56", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 3.1ms | Allocations: 342)
  Rendered layout layouts/mailer.text.erb (Duration: 6.7ms | Allocations: 601)
UserMailer#report_update: processed outbound mail in 35.1ms
Delivered mail 62ed1a02f246c_783af4b0-428@CALTM00564.local.mail (3013.4ms)
Date: Fri, 05 Aug 2022 18:54:18 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed1a02f246c_783af4b0-428@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 125.6ms | Allocations: 9627)
Completed 200 OK in 80096ms (Views: 131.6ms | ActiveRecord: 16.5ms | Allocations: 142312)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 18:55:53 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"56", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:102:in `process_report'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000114a9ea60>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"56", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.0ms | Allocations: 147)
  Rendered layout layouts/mailer.text.erb (Duration: 5.6ms | Allocations: 374)
UserMailer#report_update: processed outbound mail in 18.3ms
Delivered mail 62ed1a9fe6725_783af4c4-32a@CALTM00564.local.mail (2859.9ms)
Date: Fri, 05 Aug 2022 18:56:55 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed1a9fe6725_783af4c4-32a@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 119.5ms | Allocations: 7600)
Completed 200 OK in 63280ms (Views: 124.1ms | ActiveRecord: 17.4ms | Allocations: 101760)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-05 18:58:01 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (5.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 274.7ms | Allocations: 10945)
Completed 200 OK in 4064ms (Views: 278.0ms | ActiveRecord: 16.7ms | Allocations: 62058)


Started POST "/api/v1/expense_tracker/users/50/reports" for 127.0.0.1 at 2022-08-05 18:58:24 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[5, 20, 21], "user_id"=>"50", "report"=>{}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:94:in `expenses'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 99], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 308], ["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 400], ["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
expense 5 is already mapped or processed report 54
  [1m[36mReport Create (2.3ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-05 13:28:54.017525"], ["updated_at", "2022-08-05 13:28:54.017525"], ["user_id", 50]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 308], ["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 13:29:22.422265"], ["report_id", 57], ["id", 20]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 400], ["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-05 13:29:22.459996"], ["report_id", 57], ["id", 21]]
  ↳ app/controllers/reports_controller.rb:43:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:43:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 1043.5ms | Allocations: 7510)
Completed 200 OK in 53255ms (Views: 1049.0ms | ActiveRecord: 15.8ms | Allocations: 104490)


Started GET "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 18:59:40 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"56", "report"=>{}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:52:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 23.7ms | Allocations: 1893)
Completed 200 OK in 2891ms (Views: 26.3ms | ActiveRecord: 5.6ms | Allocations: 20211)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:01:32 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:89:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:102:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000114ad5a88>, params: {"report"=>{"status"=>"submitted"}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"56"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:05:51 +0530
  [1m[35m (1.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000108af3968>, params: {"report"=>{"status"=>"submitted"}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"56"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 3.9ms | Allocations: 342)
  Rendered layout layouts/mailer.text.erb (Duration: 8.4ms | Allocations: 601)
UserMailer#report_update: processed outbound mail in 41.0ms
Delivered mail 62ed1d1d852f0_cbe8f4b0-44@CALTM00564.local.mail (2765.9ms)
Date: Fri, 05 Aug 2022 19:07:33 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed1d1d852f0_cbe8f4b0-44@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 133.2ms | Allocations: 9682)
Completed 200 OK in 102396ms (Views: 136.0ms | ActiveRecord: 18.3ms | Allocations: 133260)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:07:41 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000108ca1f58>, params: {"report"=>{"status"=>"submitted"}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"56"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 3.0ms | Allocations: 147)
  Rendered layout layouts/mailer.text.erb (Duration: 8.0ms | Allocations: 374)
UserMailer#report_update: processed outbound mail in 23.3ms
Delivered mail 62ed1e2abf761_cbe8f4c4-327@CALTM00564.local.mail (2896.0ms)
Date: Fri, 05 Aug 2022 19:12:02 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed1e2abf761_cbe8f4c4-327@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 134.3ms | Allocations: 7602)
Completed 200 OK in 261139ms (Views: 136.2ms | ActiveRecord: 26.7ms | Allocations: 154960)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:12:08 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 55309ms (Views: 2.1ms | ActiveRecord: 22.8ms | Allocations: 140455)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:15:50 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 44072ms (Views: 2.6ms | ActiveRecord: 21.2ms | Allocations: 139019)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:17:43 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:75:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:18:54 +0530
  [1m[35m (1.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 23085ms (Views: 1.8ms | ActiveRecord: 19.0ms | Allocations: 115329)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:19:22 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 15588ms (ActiveRecord: 19.8ms | Allocations: 95938)


  
NameError (undefined local variable or method `invoice_number' for #<Report id: 56, status: "submitted", created_at: "2022-08-05 10:14:12.057985000 +0000", updated_at: "2022-08-05 13:49:32.753717000 +0000", user_id: 50>):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:56:in `block in update_dependent_expense'
app/models/report.rb:54:in `update_dependent_expense'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:20:41 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 7263ms (ActiveRecord: 20.0ms | Allocations: 77492)


  
NameError (undefined local variable or method `invoice_number' for #<Report id: 56, status: "submitted", created_at: "2022-08-05 10:14:12.057985000 +0000", updated_at: "2022-08-05 13:50:46.796448000 +0000", user_id: 50>
Did you mean?  @invoice_number):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:56:in `block in update_dependent_expense'
app/models/report.rb:54:in `update_dependent_expense'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:21:18 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 62442ms (ActiveRecord: 7.3ms | Allocations: 70375)


  
NameError (undefined local variable or method `invoice_number' for #<Report id: 56, status: "submitted", created_at: "2022-08-05 10:14:12.057985000 +0000", updated_at: "2022-08-05 13:51:22.993104000 +0000", user_id: 50>
Did you mean?  @invoice_number):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:56:in `block in update_dependent_expense'
app/models/report.rb:54:in `update_dependent_expense'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:25:02 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (3.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 49887ms (ActiveRecord: 21.1ms | Allocations: 98723)


  
NameError (undefined local variable or method `invoice_number' for #<Report id: 56, status: "submitted", created_at: "2022-08-05 10:14:12.057985000 +0000", updated_at: "2022-08-05 13:55:15.934808000 +0000", user_id: 50>
Did you mean?  @invoice_number):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:57:in `block in update_dependent_expense'
app/models/report.rb:54:in `update_dependent_expense'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:26:27 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:54:in `update_dependent_expense'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
Completed 500 Internal Server Error in 92613ms (ActiveRecord: 9.7ms | Allocations: 77129)


  
NameError (undefined local variable or method `invoice_number' for #<Report id: 56, status: "submitted", created_at: "2022-08-05 10:14:12.057985000 +0000", updated_at: "2022-08-05 13:56:35.708350000 +0000", user_id: 50>
Did you mean?  @invoice_number):
  
app/controllers/concerns/invoice_validator.rb:9:in `invoice_validator_response'
app/models/report.rb:57:in `block in update_dependent_expense'
app/models/report.rb:54:in `update_dependent_expense'
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:37:02 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 56]]
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 306], ["id", 19], ["LIMIT", 1]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-05 14:07:14.727193"], ["id", 19]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mReport Update (0.8ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-05 14:07:11.626072"], ["id", 56]]
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.7ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 7.7ms | Allocations: 373)
UserMailer#report_update: processed outbound mail in 32.2ms
Delivered mail 62ed2412d3558_140d6f4c4-449@CALTM00564.local.mail (3052.2ms)
Date: Fri, 05 Aug 2022 19:37:14 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed2412d3558_140d6f4c4-449@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 7.9ms | Allocations: 350)
Completed 200 OK in 13125ms (Views: 17.4ms | ActiveRecord: 14.2ms | Allocations: 122388)


Started PATCH "/api/v1/expense_tracker/users/50/reports/56" for 127.0.0.1 at 2022-08-05 19:49:01 +0530
  [1m[35m (1.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"56"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Report>
Completed 500 Internal Server Error in 6001ms (ActiveRecord: 14.5ms | Allocations: 61707)


  
CustomError::ValidationError (Forbidden, cannot edit expense once it is submitted for approval):
  
app/controllers/reports_controller.rb:115:in `rescue in authorize_report_status'
app/controllers/reports_controller.rb:111:in `authorize_report_status'
app/controllers/reports_controller.rb:104:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started GET "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:49:30 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"57", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (1.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 57]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 121.7ms | Allocations: 9741)
Completed 200 OK in 2881ms (Views: 124.5ms | ActiveRecord: 7.7ms | Allocations: 20368)


Started GET "/api/v1/expense_tracker/users/50/reports/58" for 127.0.0.1 at 2022-08-05 19:49:44 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"58", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 58], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
Completed 404 Not Found in 1254ms (ActiveRecord: 3.9ms | Allocations: 10082)


  
ActiveRecord::RecordNotFound (Couldn't find Report with 'id'=58 [WHERE "reports"."user_id" = ?]):
  
app/controllers/reports_controller.rb:53:in `show'
Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:49:55 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000110f3c5a8>, params: {"report"=>{"status"=>"submitted"}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"57"} }[0m
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.7ms | Allocations: 145)
  Rendered layout layouts/mailer.text.erb (Duration: 7.8ms | Allocations: 373)
UserMailer#report_update: processed outbound mail in 31.2ms
Delivered mail 62ed2736684fd_15998f500715f5@CALTM00564.local.mail (2906.6ms)
Date: Fri, 05 Aug 2022 19:50:38 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ed2736684fd_15998f500715f5@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  Rendering reports/update.jbuilder
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 57]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 127.3ms | Allocations: 7681)
Completed 200 OK in 42111ms (Views: 133.3ms | ActiveRecord: 20.2ms | Allocations: 115583)


Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:51:40 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:90:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001117bcf98>, params: {"report"=>{"status"=>"submitted"}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"57"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:55:23 +0530
  [1m[35m (2.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 47274ms (ActiveRecord: 14.5ms | Allocations: 77437)


  
NameError (undefined local variable or method `raise_restricted_action' for #<ReportsController:0x000000000247c0>

    raise_restricted_action if status != 'submitted'
    ^^^^^^^^^^^^^^^^^^^^^^^):
  
app/controllers/reports_controller.rb:82:in `user_update_args'
app/controllers/reports_controller.rb:112:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:56:35 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 4784ms (ActiveRecord: 15.7ms | Allocations: 72791)


  
NameError (undefined local variable or method `e' for #<ReportsController:0x0000000002a738>

    logger.error("User is not allowed to perform actions other than submit #{e.inspect}")
                                                                             ^):
  
app/controllers/reports_controller.rb:90:in `raise_restricted_action'
app/controllers/reports_controller.rb:82:in `user_update_args'
app/controllers/reports_controller.rb:112:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:57:49 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not allowed to perform actions other than submit on report 57
Completed 500 Internal Server Error in 4820ms (ActiveRecord: 16.5ms | Allocations: 51185)


  
CustomError::AuthenticationError (User is not allowed to perform actions other than submit):
  
app/controllers/reports_controller.rb:91:in `raise_restricted_action'
app/controllers/reports_controller.rb:82:in `user_update_args'
app/controllers/reports_controller.rb:112:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 19:58:41 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"submitted"}, "user_id"=>"50", "id"=>"57"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
User is not allowed to perform actions other than submit on repor: 57
Completed 403 Forbidden in 7644ms (Views: 2.7ms | ActiveRecord: 16.0ms | Allocations: 71570)


Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 20:00:00 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"57", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 57797ms (Views: 1.7ms | ActiveRecord: 6.5ms | Allocations: 62833)


Started PATCH "/api/v1/expense_tracker/users/50/reports/57" for 127.0.0.1 at 2022-08-05 20:01:00 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"57", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (3.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 146358ms (Views: 2.9ms | ActiveRecord: 18.8ms | Allocations: 74206)


Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-06 22:19:45 +0530
  [1m[35m (1.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 10.0ms | Allocations: 13192)
Completed 200 OK in 36ms (Views: 11.4ms | ActiveRecord: 1.4ms | Allocations: 34439)


Started GET "/api/v1/expense_tracker/users/50/reports/58" for 127.0.0.1 at 2022-08-06 22:19:59 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"58", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 58], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
Completed 404 Not Found in 3ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 4566)


Started GET "/api/v1/expense_tracker/users/50/reports/59" for 127.0.0.1 at 2022-08-06 22:20:07 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"59", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 59], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
Completed 404 Not Found in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3499)


Started GET "/api/v1/expense_tracker/users/50/reports/7" for 127.0.0.1 at 2022-08-06 22:20:13 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"7", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 7]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 3.3ms | Allocations: 2532)
Completed 200 OK in 7ms (Views: 3.5ms | ActiveRecord: 0.5ms | Allocations: 7102)


Started GET "/api/v1/expense_tracker/users/50/reports/45" for 127.0.0.1 at 2022-08-06 22:20:20 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"45", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 45], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 45]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.5ms | Allocations: 793)
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 4193)


Started GET "/api/v1/expense_tracker/users/50/reports/48" for 127.0.0.1 at 2022-08-06 22:20:24 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"48", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 48], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 48]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.5ms | Allocations: 792)
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 4081)


Started GET "/api/v1/expense_tracker/users/50/reports/49" for 127.0.0.1 at 2022-08-06 22:20:28 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"49", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 49], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 49]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.7ms | Allocations: 793)
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 4088)


Started GET "/api/v1/expense_tracker/users/50/reports/50" for 127.0.0.1 at 2022-08-06 22:20:32 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"50", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 50]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 2.5ms | Allocations: 793)
Completed 200 OK in 14ms (Views: 2.7ms | ActiveRecord: 0.3ms | Allocations: 4071)


Started GET "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:20:37 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"51", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 51]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 2.8ms | Allocations: 931)
Completed 200 OK in 16ms (Views: 2.9ms | ActiveRecord: 1.6ms | Allocations: 4223)


Started PATCH "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:22:04 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"51", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (3.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 64685ms (Views: 2.2ms | ActiveRecord: 22.9ms | Allocations: 87047)


Started GET "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:23:33 +0530
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"51", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 51]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 7.2ms | Allocations: 7556)
Completed 200 OK in 29ms (Views: 7.6ms | ActiveRecord: 3.8ms | Allocations: 22197)


Started PATCH "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:23:53 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"51", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:97:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:110:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 68615ms (ActiveRecord: 5.7ms | Allocations: 57522)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, String passed.):
  
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:25:18 +0530
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"51", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (3.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:107:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Completed 500 Internal Server Error in 16415ms (ActiveRecord: 19.9ms | Allocations: 73338)


  
ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):
  
app/controllers/reports_controller.rb:20:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:27:16 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"51", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:107:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000109fe63e8>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"51", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 51]]
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 301], ["id", 15], ["LIMIT", 1]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mExpense Update (1.5ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-06 16:58:14.794383"], ["id", 15]]
  ↳ app/models/report.rb:56:in `block in update_dependent_expense'
  [1m[36mReport Update (0.9ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-06 16:57:26.599069"], ["id", 51]]
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.8ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 8.3ms | Allocations: 373)
UserMailer#report_update: processed outbound mail in 33.4ms
Delivered mail 62ee9da6e72a3_10ffbf4ec-423@CALTM00564.local.mail (3563.0ms)
Date: Sat, 06 Aug 2022 22:28:14 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ee9da6e72a3_10ffbf4ec-423@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 9.2ms | Allocations: 360)
Completed 200 OK in 59931ms (Views: 18.2ms | ActiveRecord: 30.0ms | Allocations: 178301)


Started GET "/api/v1/expense_tracker/users/50/reports/51" for 127.0.0.1 at 2022-08-06 22:30:16 +0530
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"51", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 51], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 51]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 7.0ms | Allocations: 7552)
Completed 200 OK in 25ms (Views: 7.3ms | ActiveRecord: 2.2ms | Allocations: 22195)


Started GET "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:30:40 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"52", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 52]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.7ms | Allocations: 863)
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 0.7ms | Allocations: 4264)


Started PATCH "/api/v1/expense_tracker/users/50/expenses/16" for 127.0.0.1 at 2022-08-06 22:31:24 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "user_id"=>"50", "id"=>"16"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 302], ["biller", "Kimia"], ["created_at", "2022-08-06 17:01:25.899669"], ["updated_at", "2022-08-06 17:01:25.899669"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :approved_amount, :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000109a27cb8>, params: {"expense"=>{"approved_amount"=>100, "status"=>"submitted", "description"=>"Travel"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"50", "id"=>"16"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 302], ["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "Travel"], ["status", 2], ["updated_at", "2022-08-06 17:01:25.905369"], ["id", 16]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.8ms | Allocations: 275)
Completed 200 OK in 1771ms (Views: 1.5ms | ActiveRecord: 3.0ms | Allocations: 16225)


Started GET "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:31:36 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"52", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 52]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.6ms | Allocations: 866)
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 0.8ms | Allocations: 4368)


Started PATCH "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:31:48 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"52", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:94:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:107:in `process_report'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010a98edc8>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"52", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 52]]
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mReport Update (3.0ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-06 17:01:55.241785"], ["id", 52]]
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.7ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 3.5ms | Allocations: 140)
UserMailer#report_update: processed outbound mail in 15.9ms
Delivered mail 62ee9ea9efcc7_10ffbf500-380@CALTM00564.local.mail (2986.7ms)
Date: Sat, 06 Aug 2022 22:32:33 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62ee9ea9efcc7_10ffbf500-380@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 6.5ms | Allocations: 179)
Completed 200 OK in 48176ms (Views: 13.6ms | ActiveRecord: 13.6ms | Allocations: 91946)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-06 22:38:46 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 4.1ms | Allocations: 270)
Completed 200 OK in 349ms (Views: 9.5ms | ActiveRecord: 2.4ms | Allocations: 6756)


Started GET "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:38:54 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"52", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 52]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 7.6ms | Allocations: 6977)
Completed 200 OK in 26ms (Views: 8.6ms | ActiveRecord: 2.1ms | Allocations: 16861)


Started PATCH "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:39:07 +0530
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}], "user_id"=>"50", "id"=>"52", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
Completed 500 Internal Server Error in 21788ms (ActiveRecord: 5.5ms | Allocations: 45480)


  
NoMethodError (undefined method `permit' for [#<ActionController::Parameters {"id"=>16, "status"=>"approved", "approved_amount"=>100} permitted: false>]:Array

    params.require(:expenses).permit(:id, :approved_amount, { status: ['submitted'] })
                             ^^^^^^^):
  
app/controllers/reports_controller.rb:129:in `admin_update_args'
app/controllers/reports_controller.rb:104:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:46:23 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}], "user_id"=>"50", "id"=>"52", "report"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameters: :expenses, :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001087b0350>, params: {"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}], "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"52", "report"=>{}} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:48:05 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"52"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameters: :report, :user_id, :id. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010eecf900>, params: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"52"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/52" for 127.0.0.1 at 2022-08-06 22:49:31 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"52"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010face080>, params: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"52"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 52]]
  ↳ app/models/report.rb:53:in `update_dependent_expense'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 342)
  Rendered layout layouts/mailer.text.erb (Duration: 0.8ms | Allocations: 601)
UserMailer#report_update: processed outbound mail in 5.3ms
Delivered mail 62eea2a3e6443_10d3af21c404c1@CALTM00564.local.mail (3152.2ms)
Date: Sat, 06 Aug 2022 22:49:31 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eea2a3e6443_10d3af21c404c1@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 2.1ms | Allocations: 393)
Completed 200 OK in 3201ms (Views: 3.9ms | ActiveRecord: 3.6ms | Allocations: 52540)


Started GET "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 22:49:53 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"53", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 53]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.3ms | Allocations: 1139)
Completed 200 OK in 6ms (Views: 1.9ms | ActiveRecord: 0.8ms | Allocations: 5773)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 22:50:21 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010cc9bc30>, params: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"53"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:31:in `notify_report_update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.5ms | Allocations: 145)
  Rendered layout layouts/mailer.text.erb (Duration: 0.8ms | Allocations: 372)
UserMailer#report_update: processed outbound mail in 2.0ms
Delivered mail 62eea2d51f647_10d3af24440519@CALTM00564.local.mail (2948.8ms)
Date: Sat, 06 Aug 2022 22:50:21 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eea2d51f647_10d3af24440519@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 53]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 3.2ms | Allocations: 1086)
Completed 200 OK in 2964ms (Views: 3.6ms | ActiveRecord: 1.0ms | Allocations: 12130)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 22:51:27 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010f5a7480>, params: {"report"=>{"expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"53"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 22:58:59 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e71f570>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"53"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:01:00 +0530
  [1m[35m (1.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:64:in `p'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000107fdb328>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"53"} }[0m
Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:09:33 +0530
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>16, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (2.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:62:in `p'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 16], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
Completed 404 Not Found in 6455ms (ActiveRecord: 21.6ms | Allocations: 88944)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=16 [WHERE "expenses"."report_id" = ?]):
  
app/models/report.rb:64:in `block in update_dependent_expense'
app/models/report.rb:63:in `each'
app/models/report.rb:63:in `update_dependent_expense'
app/controllers/reports_controller.rb:104:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started GET "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:10:00 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"53", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 53]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 4.9ms | Allocations: 2097)
Completed 200 OK in 4057ms (Views: 6.4ms | ActiveRecord: 2.5ms | Allocations: 16910)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:10:22 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>17, "status"=>"approved", "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:62:in `p'
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 17], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 303], ["id", 17], ["LIMIT", 1]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mExpense Update (0.9ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-06 17:41:13.394104"], ["approved_amount", 100], ["id", 17]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000128ccf820>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>17, "status"=>"approved", "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"53"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mReport Update (1.5ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-06 17:41:32.857452"], ["id", 53]]
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:31:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.8ms | Allocations: 145)
  Rendered layout layouts/mailer.text.erb (Duration: 7.2ms | Allocations: 373)
UserMailer#report_update: processed outbound mail in 31.7ms
Delivered mail 62eea80eb528c_15d10f4d8493c5@CALTM00564.local.mail (3441.5ms)
Date: Sat, 06 Aug 2022 23:12:38 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eea80eb528c_15d10f4d8493c5@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 53]]
  ↳ app/views/reports/update.jbuilder:3
  Rendered reports/update.jbuilder (Duration: 24.3ms | Allocations: 1080)
Completed 200 OK in 139381ms (Views: 30.1ms | ActiveRecord: 19.2ms | Allocations: 133117)


Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:14:48 +0530
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 7.4ms | Allocations: 7558)
Completed 200 OK in 27ms (Views: 7.8ms | ActiveRecord: 2.3ms | Allocations: 22201)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:24:15 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"rejected", "date"=>nil}, {"id"=>18, "invoice_number"=>304, "description"=>"Other", "amount"=>100, "status"=>"drafted", "date"=>nil}]}, "user_id"=>"50", "id"=>"53"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:63:in `block in update_dependent_expense'
Completed 404 Not Found in 6139ms (ActiveRecord: 5.3ms | Allocations: 60165)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=5 [WHERE "expenses"."report_id" = ?]):
  
app/models/report.rb:63:in `block in update_dependent_expense'
app/models/report.rb:62:in `each'
app/models/report.rb:62:in `update_dependent_expense'
app/controllers/reports_controller.rb:105:in `process_report'
app/controllers/reports_controller.rb:18:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:24:51 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"rejected", "date"=>nil}, {"id"=>18, "invoice_number"=>304, "description"=>"Other", "amount"=>100, "status"=>"drafted", "date"=>nil}]}, "user_id"=>"50", "id"=>"53"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:63:in `block in update_dependent_expense'
Completed 404 Not Found in 2703ms (Views: 0.5ms | ActiveRecord: 10.9ms | Allocations: 53800)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:26:20 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"rejected", "date"=>nil}, {"id"=>18, "invoice_number"=>304, "description"=>"Other", "amount"=>100, "status"=>"drafted", "date"=>nil}]}, "user_id"=>"50", "id"=>"53"}
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:63:in `block in update_dependent_expense'
Completed 404 Not Found in 97000ms (Views: 0.5ms | ActiveRecord: 14.5ms | Allocations: 81581)


Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:28:07 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 9.4ms | Allocations: 1973)
Completed 200 OK in 36ms (Views: 11.4ms | ActiveRecord: 2.5ms | Allocations: 6212)


Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:28:08 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 5.7ms | Allocations: 918)
Completed 200 OK in 29ms (Views: 7.1ms | ActiveRecord: 1.6ms | Allocations: 4300)


Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:28:09 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 5.9ms | Allocations: 918)
Completed 200 OK in 29ms (Views: 7.3ms | ActiveRecord: 1.7ms | Allocations: 4220)


Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:28:09 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 5.9ms | Allocations: 918)
Completed 200 OK in 28ms (Views: 7.2ms | ActiveRecord: 1.7ms | Allocations: 4217)


Started PATCH "/api/v1/expense_tracker/users/50/reports/53" for 127.0.0.1 at 2022-08-06 23:28:16 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"rejected", "date"=>nil}, {"id"=>18, "invoice_number"=>304, "description"=>"Other", "amount"=>100, "status"=>"drafted", "date"=>nil}]}, "user_id"=>"50", "id"=>"53"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 53], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 53], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:63:in `block in update_dependent_expense'
Completed 404 Not Found in 42578ms (Views: 0.4ms | ActiveRecord: 2.9ms | Allocations: 56247)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:29:12 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"rejected", "date"=>nil}, {"id"=>18, "invoice_number"=>304, "description"=>"Other", "amount"=>100, "status"=>"drafted", "date"=>nil}]}, "user_id"=>"50", "id"=>"54"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
 cannot act upon draft version: 54
Completed 403 Forbidden in 23034ms (Views: 3.1ms | ActiveRecord: 7.3ms | Allocations: 68054)


Started POST "/api/v1/expense_tracker/user/login?email=david@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-06 23:31:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"david@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "david@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 4.2ms | Allocations: 271)
Completed 200 OK in 380ms (Views: 9.5ms | ActiveRecord: 7.3ms | Allocations: 7260)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:32:29 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:108:in `process_report'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000012934de40>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mExpense Update (1.0ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-06 18:02:43.327093"], ["id", 18]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mReport Update (1.0ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-06 18:02:36.339949"], ["id", 54]]
  ↳ app/controllers/reports_controller.rb:20:in `update'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:30:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.8ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 3.5ms | Allocations: 140)
UserMailer#report_update: processed outbound mail in 15.7ms
Delivered mail 62eeacc364780_15d10f4b049464@CALTM00564.local.mail (3144.2ms)
Date: Sat, 06 Aug 2022 23:32:43 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eeacc364780_15d10f4b049464@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 7.7ms | Allocations: 259)
Completed 200 OK in 14470ms (Views: 16.6ms | ActiveRecord: 23.9ms | Allocations: 132105)


  [1m[36mExpense Load (2.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 18], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 0], ["updated_at", "2022-08-06 18:05:58.866422"], ["id", 18]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
Started GET "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:36:06 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"50", "id"=>"54", "report"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.8ms | Allocations: 958)
Completed 200 OK in 4521ms (Views: 2.2ms | ActiveRecord: 3.7ms | Allocations: 14801)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:36:28 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:108:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Report>
Completed 400 Bad Request in 10876ms (Views: 2.3ms | ActiveRecord: 5.6ms | Allocations: 53178)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:39:04 +0530
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:108:in `process_report'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001294869d8>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:41:11 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 50], ["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:108:in `process_report'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001088c6af0>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mExpense Update (1.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-06 18:11:36.180268"], ["id", 18]]
  ↳ app/models/report.rb:55:in `block in submit_dependent_expense'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:30:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 3.9ms | Allocations: 341)
  Rendered layout layouts/mailer.text.erb (Duration: 8.6ms | Allocations: 600)
UserMailer#report_update: processed outbound mail in 39.6ms
Delivered mail 62eeaed859a7d_16a10f4b0963b2@CALTM00564.local.mail (3067.7ms)
Date: Sat, 06 Aug 2022 23:41:36 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eeaed859a7d_16a10f4b0963b2@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (2.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 9.4ms | Allocations: 440)
Completed 200 OK in 25435ms (Views: 18.2ms | ActiveRecord: 25.0ms | Allocations: 176831)


Started POST "/api/v1/expense_tracker/user/login?email=mike@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-06 23:42:17 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"mike@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "mike@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 4.2ms | Allocations: 270)
Completed 200 OK in 280ms (Views: 10.1ms | ActiveRecord: 1.5ms | Allocations: 2206)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:46:05 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expense"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
Completed 500 Internal Server Error in 29822ms (Views: 2.4ms | ActiveRecord: 21.6ms | Allocations: 88769)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:47:19 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expense"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
Completed 500 Internal Server Error in 52443ms (Views: 2.4ms | ActiveRecord: 21.3ms | Allocations: 79297)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:48:20 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (1.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 304], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mExpense Update (1.6ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-06 18:19:00.942147"], ["approved_amount", 100], ["id", 18]]
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:65:in `block in update_dependent_expense'
[31mUnpermitted parameters: :status, :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010965c408>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:30:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 2.9ms | Allocations: 146)
  Rendered layout layouts/mailer.text.erb (Duration: 7.6ms | Allocations: 373)
UserMailer#report_update: processed outbound mail in 23.9ms
Delivered mail 62eeb0aaac9d9_16a10f5009642f@CALTM00564.local.mail (2870.6ms)
Date: Sat, 06 Aug 2022 23:49:22 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eeb0aaac9d9_16a10f5009642f@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 10.1ms | Allocations: 362)
Completed 200 OK in 65150ms (Views: 19.7ms | ActiveRecord: 21.5ms | Allocations: 178361)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-06 23:53:06 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:93:in `find_user'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:103:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:61:in `p'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:64:in `block in update_dependent_expense'
[31mUnpermitted parameters: :status, :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001080c7520>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"50", "id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:52:in `submit_dependent_expense'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/models/report.rb:30:in `notify_report_update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.8ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 3.6ms | Allocations: 140)
UserMailer#report_update: processed outbound mail in 15.9ms
Delivered mail 62eeb1ef11bb5_16a10f4b096562@CALTM00564.local.mail (2980.3ms)
Date: Sat, 06 Aug 2022 23:54:47 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eeb1ef11bb5_16a10f4b096562@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

testing mail

  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:20:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 7.9ms | Allocations: 265)
Completed 200 OK in 101206ms (Views: 17.8ms | ActiveRecord: 26.2ms | Allocations: 189818)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-07 00:16:19 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:22:in `inject'
Completed 500 Internal Server Error in 51100ms (Views: 1.3ms | ActiveRecord: 7.4ms | Allocations: 77145)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-07 00:17:23 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:22:in `p'
  [1m[36mExpense Load (1.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:23:in `inject'
Completed 500 Internal Server Error in 28699ms (ActiveRecord: 19.5ms | Allocations: 62677)


  
NameError (undefined local variable or method `amount' for #<Report id: 54, status: "submitted", created_at: "2022-08-05 10:05:06.712409000 +0000", updated_at: "2022-08-06 18:02:36.339949000 +0000", user_id: 50>):
  
app/models/report.rb:26:in `total_amount'
app/controllers/reports_controller.rb:49:in `process_report'
app/controllers/reports_controller.rb:27:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-07 00:18:44 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (2.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:22:in `p'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:23:in `inject'
Completed 500 Internal Server Error in 19012ms (ActiveRecord: 18.4ms | Allocations: 65635)


  
NameError (undefined local variable or method `amount' for #<Report id: 54, status: "submitted", created_at: "2022-08-05 10:05:06.712409000 +0000", updated_at: "2022-08-06 18:02:36.339949000 +0000", user_id: 50>):
  
app/models/report.rb:27:in `total_amount'
app/controllers/reports_controller.rb:49:in `process_report'
app/controllers/reports_controller.rb:27:in `update'
Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-07 00:19:28 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>5, "invoice_number"=>99, "description"=>"Other", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>1}, {"id"=>18, "invoice_number"=>304, "description"=>"xxxx", "amount"=>100, "status"=>"approved", "date"=>nil, "approved_amount"=>100}]}, "user_id"=>"50", "id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (3.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? /* loading for inspect */ LIMIT ?[0m  [["report_id", 54], ["LIMIT", 11]]
  ↳ app/models/report.rb:22:in `p'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 54]]
  ↳ app/models/report.rb:23:in `inject'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 54], ["id", 18], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in update_dependent_expense'
 actions other than processed are restricted: 54
Completed 500 Internal Server Error in 20336ms (ActiveRecord: 23.2ms | Allocations: 105111)


  
CustomError::AuthenticationError (actions other than processed are restricted):
  
app/controllers/reports_controller.rb:88:in `raise_restricted_action'
app/controllers/reports_controller.rb:78:in `admin_update_args'
app/controllers/reports_controller.rb:52:in `process_report'
app/controllers/reports_controller.rb:27:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateComments (20220807114515)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "comments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "comment" varchar, "commentable_type" varchar, "commentable_id" integer, "user_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_03de2dc08c"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_commentable" ON "comments" ("commentable_type", "commentable_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_comments_on_user_id" ON "comments" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220807114515"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/expense_tracker/users/50/expenses" for 127.0.0.1 at 2022-08-07 17:34:03 +0530
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"50"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 61]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 50]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 12.6ms | Allocations: 13645)
Completed 200 OK in 42ms (Views: 14.3ms | ActiveRecord: 1.4ms | Allocations: 34900)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/" for 127.0.0.1 at 2022-08-07 17:34:43 +0530
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/users/50/expenses/1"):
  
Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 17:49:33 +0530
  [1m[35m (1.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#create as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
Completed 500 Internal Server Error in 16539ms (Views: 1.9ms | ActiveRecord: 6.7ms | Allocations: 43465)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 17:59:22 +0530
Processing by CommentsController#create as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 87ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 7932)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:00:18 +0530
  [1m[35m (1.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#create as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 11815ms (ActiveRecord: 6.9ms | Allocations: 35431)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddParentIdToComments (20220807124608)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "comments" ADD "parent_id" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20220807124608"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:20:19 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#create as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
  [1m[36mComment Load (2.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/controllers/comments_controller.rb:8:in `p'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 26503ms (ActiveRecord: 6.6ms | Allocations: 39109)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:24:01 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#create as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/controllers/comments_controller.rb:8:in `p'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 37ms (ActiveRecord: 1.9ms | Allocations: 29450)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:25:04 +0530
Processing by CommentsController#create as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/controllers/comments_controller.rb:8:in `p'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 3ms (ActiveRecord: 0.1ms | Allocations: 3488)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:26:51 +0530
Processing by CommentsController#create as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/comments_controller.rb:6:in `create'
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Attach supporting docs..."], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", nil], ["created_at", "2022-08-07 12:56:51.229861"], ["updated_at", "2022-08-07 12:56:51.229861"], ["parent_id", 123]]
  ↳ app/controllers/comments_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/comments_controller.rb:6:in `create'
Completed 500 Internal Server Error in 15ms (Views: 0.1ms | ActiveRecord: 2.3ms | Allocations: 20063)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:29:01 +0530
Processing by CommentsController#create as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/comments_controller.rb:6:in `create'
  [1m[36mComment Create (0.6ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Attach supporting docs..."], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 12:59:01.206049"], ["updated_at", "2022-08-07 12:59:01.206049"], ["parent_id", 123]]
  ↳ app/controllers/comments_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/comments_controller.rb:6:in `create'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 19ms (ActiveRecord: 3.1ms | Allocations: 18337)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:39:46 +0530
Processing by CommentsController#create as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:6:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/comments_controller.rb:7:in `create'
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Attach supporting docs..."], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:09:46.297360"], ["updated_at", "2022-08-07 13:09:46.297360"], ["parent_id", 123]]
  ↳ app/controllers/comments_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/comments_controller.rb:7:in `create'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 16ms (ActiveRecord: 1.9ms | Allocations: 17026)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:40:17 +0530
Processing by CommentsController#create as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `create'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/comments_controller.rb:8:in `create'
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Attach supporting docs..."], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:10:17.450805"], ["updated_at", "2022-08-07 13:10:17.450805"], ["parent_id", 123]]
  ↳ app/controllers/comments_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/comments_controller.rb:8:in `create'
No template found for CommentsController#create, rendering head :no_content
Completed 204 No Content in 21ms (ActiveRecord: 2.7ms | Allocations: 18335)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:48:01 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (3.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000112acaf40>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:50:04 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x000000010a9149b0>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
Completed 500 Internal Server Error in 28ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 27346)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:51:47 +0530
  [1m[35m (1.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000108db14c0>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000108db14c0>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
Completed 500 Internal Server Error in 142117ms (Views: 2.8ms | ActiveRecord: 6.9ms | Allocations: 64736)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:54:12 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000108977fd0>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000108977fd0>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
Completed 500 Internal Server Error in 180836ms (Views: 1.1ms | ActiveRecord: 9.1ms | Allocations: 33606)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 18:57:16 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (3.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001085d02d8>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001085d02d8>, params: {"parent_id"=>123, "comment"=>"Attach supporting docs...", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Attach supporting docs..."], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:27:20.537501"], ["updated_at", "2022-08-07 13:27:20.537501"], ["parent_id", 123]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
No template found for CommentsController#add_expense_comment, rendering head :no_content
Completed 204 No Content in 3842ms (ActiveRecord: 16.1ms | Allocations: 41089)


Started GET "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:00:48 +0530
  
AbstractController::ActionNotFound (The action 'index_expense_comment' could not be found for CommentsController
Did you mean?  index_expense_comments):
  
actionpack (7.0.3.1) lib/abstract_controller/base.rb:146:in `process'
actionview (7.0.3.1) lib/action_view/rendering.rb:39:in `process'
actionpack (7.0.3.1) lib/action_controller/metal.rb:188:in `dispatch'
actionpack (7.0.3.1) lib/action_controller/metal.rb:251:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (7.0.3.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (7.0.3.1) lib/action_dispatch/routing/route_set.rb:852:in `call'
rack (2.2.4) lib/rack/tempfile_reaper.rb:15:in `call'
rack (2.2.4) lib/rack/etag.rb:27:in `call'
rack (2.2.4) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.4) lib/rack/head.rb:12:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.0.3.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack (2.2.4) lib/rack/session/abstract/id.rb:266:in `context'
rack (2.2.4) lib/rack/session/abstract/id.rb:260:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/cookies.rb:697:in `call'
activerecord (7.0.3.1) lib/active_record/migration.rb:603:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (7.0.3.1) lib/active_support/callbacks.rb:99:in `run_callbacks'
actionpack (7.0.3.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/actionable_exceptions.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/debug_exceptions.rb:28:in `call'
web-console (4.2.0) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.0) lib/web_console/middleware.rb:17:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/show_exceptions.rb:26:in `call'
railties (7.0.3.1) lib/rails/rack/logger.rb:40:in `call_app'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `block in call'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `block in tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:38:in `tagged'
activesupport (7.0.3.1) lib/active_support/tagged_logging.rb:114:in `tagged'
railties (7.0.3.1) lib/rails/rack/logger.rb:25:in `call'
sprockets-rails (3.4.2) lib/sprockets/rails/quiet_assets.rb:13:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/remote_ip.rb:93:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.4) lib/rack/method_override.rb:24:in `call'
rack (2.2.4) lib/rack/runtime.rb:22:in `call'
activesupport (7.0.3.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/server_timing.rb:20:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/static.rb:23:in `call'
rack (2.2.4) lib/rack/sendfile.rb:110:in `call'
actionpack (7.0.3.1) lib/action_dispatch/middleware/host_authorization.rb:137:in `call'
railties (7.0.3.1) lib/rails/engine.rb:530:in `call'
puma (5.6.4) lib/puma/configuration.rb:252:in `call'
puma (5.6.4) lib/puma/request.rb:77:in `block in handle_request'
puma (5.6.4) lib/puma/thread_pool.rb:340:in `with_force_shutdown'
puma (5.6.4) lib/puma/request.rb:76:in `handle_request'
puma (5.6.4) lib/puma/server.rb:441:in `process_client'
puma (5.6.4) lib/puma/thread_pool.rb:147:in `block in spawn_thread'
Started GET "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:01:25 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:10:in `index_expense_comments'
No template found for CommentsController#index_expense_comments, rendering head :no_content
Completed 204 No Content in 192ms (ActiveRecord: 7.8ms | Allocations: 14591)


Started GET "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:04:00 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:10:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (1.8ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 93.7ms | Allocations: 4620)
Completed 200 OK in 123ms (Views: 95.0ms | ActiveRecord: 5.8ms | Allocations: 6660)


Started GET "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:05:04 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:10:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (1.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  Rendered comments/index_expense_comments.jbuilder (Duration: 25.5ms | Allocations: 1250)
Completed 200 OK in 55ms (Views: 29.7ms | ActiveRecord: 3.4ms | Allocations: 3196)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:05:36 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000109e346d0>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (2.9ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:35:40.942988"], ["updated_at", "2022-08-07 13:35:40.942988"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
No template found for CommentsController#add_expense_comment, rendering head :no_content
Completed 204 No Content in 4094ms (ActiveRecord: 6.5ms | Allocations: 23667)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:07:07 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x000000010886e198>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:37:11.081924"], ["updated_at", "2022-08-07 13:37:11.081924"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 2.9ms | Allocations: 281)
Completed 200 OK in 3400ms (Views: 7.0ms | ActiveRecord: 13.7ms | Allocations: 33870)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:11:03 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001096ce760>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.1ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:41:08.125998"], ["updated_at", "2022-08-07 13:41:08.125998"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
Completed 500 Internal Server Error in 670397ms (Views: 1.5ms | ActiveRecord: 12.7ms | Allocations: 71719)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:22:17 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001087339e0>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:52:21.127914"], ["updated_at", "2022-08-07 13:52:21.127914"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Completed 500 Internal Server Error in 30192ms (Views: 1.7ms | ActiveRecord: 14.8ms | Allocations: 56467)


Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:22:59 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000109924e60>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:53:03.068735"], ["updated_at", "2022-08-07 13:53:03.068735"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:24:17 +0530
  [1m[35m (1.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (3.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001063742c0>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.8ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:54:20.352636"], ["updated_at", "2022-08-07 13:54:20.352636"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
Started POST "/api/v1/expense_tracker/users/50/expenses/1/comments" for 127.0.0.1 at 2022-08-07 19:26:08 +0530
  [1m[35m (1.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (2.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001157a4228>, params: {"comment"=>"super comment", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"50", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (1.7ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "super comment"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 61], ["created_at", "2022-08-07 13:56:11.945489"], ["updated_at", "2022-08-07 13:56:11.945489"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 4.3ms | Allocations: 435)
  Rendered layout layouts/mailer.text.erb (Duration: 7.6ms | Allocations: 684)
UserMailer#notify_comment: processed outbound mail in 36.7ms
Delivered mail 62efc47e170ec_53fff4b0-4ef@CALTM00564.local.mail (3113.8ms)
Date: Sun, 07 Aug 2022 19:26:14 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62efc47e170ec_53fff4b0-4ef@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: super comment
commented at: 2022-08-07 13:56:11 UTC
commentd by: mike


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 4.2ms | Allocations: 329)
Completed 200 OK in 8092ms (Views: 11.9ms | ActiveRecord: 15.5ms | Allocations: 81155)


Started POST "/api/v1/expense_tracker/users/50/expenses/54/comments" for 127.0.0.1 at 2022-08-07 22:41:34 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
Completed 404 Not Found in 8066ms (ActiveRecord: 4.4ms | Allocations: 16865)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=54):
  
app/controllers/comments_controller.rb:5:in `add_expense_comment'
Started POST "/api/v1/expense_tracker/users/50/expenses/54/comments" for 127.0.0.1 at 2022-08-07 22:42:20 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"super comment", "user_id"=>"50", "expense_id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
Completed 404 Not Found in 2537ms (Views: 2.7ms | ActiveRecord: 10.1ms | Allocations: 24113)


Started POST "/api/v1/expense_tracker/users/50/report/54/comments" for 127.0.0.1 at 2022-08-07 22:43:14 +0530
  
ActionController::RoutingError (No route matches [POST] "/api/v1/expense_tracker/users/50/report/54/comments"):
  
Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:43:27 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x0000000114a67510>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mComment Create (2.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:13:33.646631"], ["updated_at", "2022-08-07 17:13:33.646631"], ["parent_id", nil]]
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
Completed 500 Internal Server Error in 29143ms (Views: 2.1ms | ActiveRecord: 10.7ms | Allocations: 31755)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:44:03 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x0000000120e867c0>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:14:05.305486"], ["updated_at", "2022-08-07 17:14:05.305486"], ["parent_id", nil]]
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
Completed 500 Internal Server Error in 11666ms (Views: 2.1ms | ActiveRecord: 13.3ms | Allocations: 44597)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:44:54 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x00000001217af6d0>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mComment Create (1.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:14:56.493907"], ["updated_at", "2022-08-07 17:14:56.493907"], ["parent_id", nil]]
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
Completed 500 Internal Server Error in 10496ms (Views: 1.6ms | ActiveRecord: 13.6ms | Allocations: 38429)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:45:08 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (2.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x00000001155aada0>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mComment Create (2.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:15:09.297373"], ["updated_at", "2022-08-07 17:15:09.297373"], ["parent_id", nil]]
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
Completed 500 Internal Server Error in 6516ms (Views: 2.0ms | ActiveRecord: 8.6ms | Allocations: 32747)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:45:33 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x0000000120fc5730>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mComment Create (1.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:15:35.604203"], ["updated_at", "2022-08-07 17:15:35.604203"], ["parent_id", nil]]
  ↳ app/models/report.rb:53:in `add_comment'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:53:in `add_comment'
Completed 500 Internal Server Error in 50217ms (Views: 1.1ms | ActiveRecord: 14.8ms | Allocations: 52437)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:46:26 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x00000001148b69f0>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mComment Create (1.7ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:16:28.798610"], ["updated_at", "2022-08-07 17:16:28.798610"], ["parent_id", nil]]
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:19:in `add_report_comment'
Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:47:48 +0530
  [1m[35m (1.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x00000001118c5b60>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mComment Create (1.8ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:17:50.546033"], ["updated_at", "2022-08-07 17:17:50.546033"], ["parent_id", nil]]
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:19:in `add_report_comment'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 5.2ms | Allocations: 434)
  Rendered layout layouts/mailer.text.erb (Duration: 9.5ms | Allocations: 683)
UserMailer#notify_comment: processed outbound mail in 42.1ms
Delivered mail 62eff3c1928dc_1431af4b0-4cf@CALTM00564.local.mail (3170.1ms)
Date: Sun, 07 Aug 2022 22:47:53 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eff3c1928dc_1431af4b0-4cf@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: hey thr
commented at: 2022-08-07 17:17:50 UTC
commentd by: mike


have a great day!

No template found for CommentsController#add_report_comment, rendering head :no_content
Completed 204 No Content in 8015ms (ActiveRecord: 16.5ms | Allocations: 70379)


Started POST "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:50:36 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"50", "report_id"=>"54"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (1.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x000000011232c900>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"50", "report_id"=>"54"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mComment Create (1.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 54], ["user_id", 61], ["created_at", "2022-08-07 17:20:39.560748"], ["updated_at", "2022-08-07 17:20:39.560748"], ["parent_id", nil]]
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:17:in `add_report_comment'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 4.3ms | Allocations: 221)
  Rendered layout layouts/mailer.text.erb (Duration: 8.9ms | Allocations: 446)
UserMailer#notify_comment: processed outbound mail in 24.7ms
Delivered mail 62eff4689c97a_1431af4c4-366@CALTM00564.local.mail (3014.6ms)
Date: Sun, 07 Aug 2022 22:50:40 +0530
From: from@example.com
To: david@mail.com
Message-ID: <62eff4689c97a_1431af4c4-366@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: hey thr
commented at: 2022-08-07 17:20:39 UTC
commentd by: mike


have a great day!

  Rendering comments/add_report_comment.jbuilder
  Rendered comments/add_report_comment.jbuilder (Duration: 6.9ms | Allocations: 299)
Completed 200 OK in 6205ms (Views: 15.6ms | ActiveRecord: 17.0ms | Allocations: 51233)


Started GET "/api/v1/expense_tracker/users/50/expenses/54/comments" for 127.0.0.1 at 2022-08-07 22:52:06 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"50", "expense_id"=>"54"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
Completed 404 Not Found in 1390ms (Views: 2.3ms | ActiveRecord: 4.6ms | Allocations: 12625)


Started GET "/api/v1/expense_tracker/users/50/reports/:report_id/comments" for 127.0.0.1 at 2022-08-07 22:52:31 +0530
Processing by CommentsController#index_report_comments as */*
  Parameters: {"user_id"=>"50", "report_id"=>":report_id"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:21:in `index_report_comments'
Completed 404 Not Found in 2228ms (Views: 2.2ms | ActiveRecord: 1.8ms | Allocations: 8131)


Started GET "/api/v1/expense_tracker/users/50/reports/54/comments" for 127.0.0.1 at 2022-08-07 22:52:42 +0530
Processing by CommentsController#index_report_comments as */*
  Parameters: {"user_id"=>"50", "report_id"=>"54"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:21:in `index_report_comments'
  Rendering comments/index_report_comments.jbuilder
  [1m[36mComment Load (1.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 54], ["commentable_type", "Report"]]
  ↳ app/views/comments/index_report_comments.jbuilder:1
  Rendered comments/index_report_comments.jbuilder (Duration: 45.1ms | Allocations: 2325)
Completed 200 OK in 72ms (Views: 47.8ms | ActiveRecord: 3.0ms | Allocations: 3933)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-07 23:22:01 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000110e07318>, params: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "admin"], ["department", "Engineering"], ["status", 1], ["email", "admin@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-07 17:52:07.713274"], ["updated_at", "2022-08-07 17:52:07.713274"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 62], ["created_at", "2022-08-07 17:52:07.720062"], ["updated_at", "2022-08-07 17:52:07.720062"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 62], ["created_at", "2022-08-07 17:52:07.722515"], ["updated_at", "2022-08-07 17:52:07.722515"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 2.3ms | Allocations: 2160)
Completed 201 Created in 280ms (Views: 3.4ms | ActiveRecord: 4.4ms | Allocations: 15277)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-07 23:23:43 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001120853f0>, params: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "kasi@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-07 17:53:44.114870"], ["updated_at", "2022-08-07 17:53:44.114870"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 63], ["created_at", "2022-08-07 17:53:44.117582"], ["updated_at", "2022-08-07 17:53:44.117582"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.9ms | Allocations: 853)
Completed 201 Created in 261ms (Views: 1.0ms | ActiveRecord: 2.2ms | Allocations: 6108)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-07 23:24:28 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.4ms | Allocations: 265)
Completed 200 OK in 254ms (Views: 1.9ms | ActiveRecord: 0.1ms | Allocations: 2049)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:25:16 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001125c4c08 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-x9998w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"Travel"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 100], ["date", nil], ["invoice_number", 1], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 17:55:16.731903"], ["updated_at", "2022-08-07 17:55:16.731903"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 52]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "d2bk8wwezzh0oodlqkp9mn1la3d5"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 17:55:16.744645"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 73], ["created_at", "2022-08-07 17:55:16.745604"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 17:55:16.746272"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: d2bk8wwezzh0oodlqkp9mn1la3d5 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ed24a0b1-3998-4128-9ab9-510771abfd23) to Async(default) with arguments: #<GlobalID:0x00000001128bcf00 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/52>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 73]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 288)
Completed 200 OK in 44ms (Views: 1.1ms | ActiveRecord: 3.4ms | Allocations: 42436)


[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 52], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23] Performing ActiveStorage::PurgeJob (Job ID: ed24a0b1-3998-4128-9ab9-510771abfd23) from Async(default) enqueued at 2022-08-07T17:55:16Z with arguments: #<GlobalID:0x0000000112c3d4e0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/52>>
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 52], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 52]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 52], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 52]]
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 6k5fqrr9cevxcjg08f8jow7p9s8t[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ed24a0b1-3998-4128-9ab9-510771abfd23] Performed ActiveStorage::PurgeJob (Job ID: ed24a0b1-3998-4128-9ab9-510771abfd23) from Async(default) in 30.37ms
Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:25:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"200", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000112d44d70 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-s3rj44.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Travel"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 200], ["date", nil], ["invoice_number", 2], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 17:55:46.727898"], ["updated_at", "2022-08-07 17:55:46.727898"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 53]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "3li4htply4y96rbihtzcasg80a6m"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 17:55:46.731079"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 74], ["created_at", "2022-08-07 17:55:46.731838"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 17:55:46.732373"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 3li4htply4y96rbihtzcasg80a6m (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 67ce8c55-6117-4ca6-84d8-7855b44175f0) to Async(default) with arguments: #<GlobalID:0x0000000112f45340 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/53>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 74]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 102)
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 1.9ms | Allocations: 15693)


[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 53], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0] Performing ActiveStorage::PurgeJob (Job ID: 67ce8c55-6117-4ca6-84d8-7855b44175f0) from Async(default) enqueued at 2022-08-07T17:55:46Z with arguments: #<GlobalID:0x0000000112fa5650 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/53>>
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 53], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 53]]
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 53], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 53]]
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0]   [1m[36mTRANSACTION (18.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0] [36m  Disk Storage (0.1ms) [0m[31mDeleted file from key: lyeupjll3dy2nh9ez0r2reowrmic[0m
[ActiveJob] [ActiveStorage::PurgeJob] [67ce8c55-6117-4ca6-84d8-7855b44175f0] Performed ActiveStorage::PurgeJob (Job ID: 67ce8c55-6117-4ca6-84d8-7855b44175f0) from Async(default) in 24.58ms
Started GET "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:25:58 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.2ms | Allocations: 2022)
Completed 200 OK in 4ms (Views: 2.2ms | ActiveRecord: 0.3ms | Allocations: 4535)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:26:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001131af7e8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-tu8rmz.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"food"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 6332)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:26:18 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011324e4b0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-4h3ev4.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"food"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "food"], ["amount", 500], ["date", nil], ["invoice_number", 3], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 17:56:18.525054"], ["updated_at", "2022-08-07 17:56:18.525054"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 54]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "zo3t43p7vvd35ntch8dscbl1mb2c"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 17:56:18.534175"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 75], ["created_at", "2022-08-07 17:56:18.535074"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 17:56:18.535854"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: zo3t43p7vvd35ntch8dscbl1mb2c (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ec5cefd7-2e30-4ef6-8df5-1a42ca02c740) to Async(default) with arguments: #<GlobalID:0x000000010d956290 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/54>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 75]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 15341)


[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 54], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740] Performing ActiveStorage::PurgeJob (Job ID: ec5cefd7-2e30-4ef6-8df5-1a42ca02c740) from Async(default) enqueued at 2022-08-07T17:56:18Z with arguments: #<GlobalID:0x000000010e40d940 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/54>>
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 54], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 54]]
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 54], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 54]]
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740]   [1m[36mTRANSACTION (18.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: mo9ku1feem25mlt0k4id3jwjtvgk[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ec5cefd7-2e30-4ef6-8df5-1a42ca02c740] Performed ActiveStorage::PurgeJob (Job ID: ec5cefd7-2e30-4ef6-8df5-1a42ca02c740) from Async(default) in 24.24ms
Started GET "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:26:32 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 0.7ms | Allocations: 1164)
Completed 200 OK in 3ms (Views: 1.1ms | ActiveRecord: 0.2ms | Allocations: 3607)


Started GET "/api/v1/expense_tracker/users/50/expenses/1" for 127.0.0.1 at 2022-08-07 23:26:40 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"50", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1537)


Started GET "/api/v1/expense_tracker/users/63/expenses/1" for 127.0.0.1 at 2022-08-07 23:26:52 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"63", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.7ms | Allocations: 252)
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 3595)


Started GET "/api/v1/expense_tracker/users/63/expenses/2" for 127.0.0.1 at 2022-08-07 23:26:57 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"63", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 0.2ms | Allocations: 167)
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 3353)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/1" for 127.0.0.1 at 2022-08-07 23:28:11 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"description"=>"brokerage", "status"=>"approved", "amount"=>99}, "user_id"=>"63", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000111824850>, params: {"expense"=>{"description"=>"brokerage", "status"=>"approved", "amount"=>99}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "description" = ?, "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["description", "brokerage"], ["amount", 99], ["updated_at", "2022-08-07 17:58:11.950543"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.8ms | Allocations: 252)
Completed 200 OK in 14ms (Views: 1.0ms | ActiveRecord: 1.0ms | Allocations: 15233)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/1" for 127.0.0.1 at 2022-08-07 23:28:39 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"description"=>"brokerage", "status"=>"submitted", "amount"=>99, "approved_amount"=>1}, "user_id"=>"63", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000111ea5918>, params: {"expense"=>{"description"=>"brokerage", "status"=>"submitted", "amount"=>99, "approved_amount"=>1}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 17:58:40.841486"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 1.0ms | Allocations: 249)
  Rendered layout layouts/mailer.text.erb (Duration: 1.2ms | Allocations: 357)
UserMailer#expense_update: processed outbound mail in 3.3ms
Delivered mail 62effd50cf745_1431af4b0-2b4@CALTM00564.local.mail (2977.7ms)
Date: Sun, 07 Aug 2022 23:28:40 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62effd50cf745_1431af4b0-2b4@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 1
expense status: rejected
expense amount: 99
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 143)
Completed 200 OK in 4796ms (Views: 1.9ms | ActiveRecord: 2.0ms | Allocations: 15858)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/2" for 127.0.0.1 at 2022-08-07 23:29:19 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"63", "id"=>"2"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:78:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 2], ["biller", "Plajo"], ["created_at", "2022-08-07 17:59:20.993298"], ["updated_at", "2022-08-07 17:59:20.993298"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001123d6ae0>, params: {"expense"=>{"status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 17:59:20.999337"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 149)
Completed 200 OK in 1760ms (Views: 0.5ms | ActiveRecord: 3.1ms | Allocations: 20193)


Started POST "/api/v1/expense_tracker/users/63/expenses/1/comments" for 127.0.0.1 at 2022-08-07 23:30:13 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"share the reason for rejection", "user_id"=>"63", "expense_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001126e58a8>, params: {"comment"=>"share the reason for rejection", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"63", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "share the reason for rejection"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 63], ["created_at", "2022-08-07 18:00:13.309333"], ["updated_at", "2022-08-07 18:00:13.309333"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 132)
UserMailer#notify_comment: processed outbound mail in 0.6ms
Delivered mail 62effdad4c7c1_1431af4d8-188@CALTM00564.local.mail (2857.9ms)
Date: Sun, 07 Aug 2022 23:30:13 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62effdad4c7c1_1431af4d8-188@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: share the reason for rejection
commented at: 2022-08-07 18:00:13 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 2.6ms | Allocations: 178)
Completed 200 OK in 2871ms (Views: 4.2ms | ActiveRecord: 1.2ms | Allocations: 10359)


Started GET "/api/v1/expense_tracker/users/63/expenses/1/comments" for 127.0.0.1 at 2022-08-07 23:30:43 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"63", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  Rendered comments/index_expense_comments.jbuilder (Duration: 1.9ms | Allocations: 1773)
Completed 200 OK in 3ms (Views: 1.9ms | ActiveRecord: 0.3ms | Allocations: 3217)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:30:59 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001128844c0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-juwtyn.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"food"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "food"], ["amount", 600], ["date", nil], ["invoice_number", 4], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 18:00:59.820149"], ["updated_at", "2022-08-07 18:00:59.820149"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 55]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "tdhdcucl4e9gygwjlwewgd8om5rm"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 18:00:59.824721"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 76], ["created_at", "2022-08-07 18:00:59.825595"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:00:59.826367"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: tdhdcucl4e9gygwjlwewgd8om5rm (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 55], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: e57ed200-a1bc-4596-8c93-c782fc4c5ef0) to Async(default) with arguments: #<GlobalID:0x0000000112cd5fb0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/55>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 76]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 89)
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 15493)


[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 55], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0] Performing ActiveStorage::PurgeJob (Job ID: e57ed200-a1bc-4596-8c93-c782fc4c5ef0) from Async(default) enqueued at 2022-08-07T18:00:59Z with arguments: #<GlobalID:0x0000000112d2fec0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/55>>
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 55], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 55]]
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 55], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mActiveStorage::Blob Destroy (17.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 55]]
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: focued40vj4afdmgcrk8oxc5urna[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e57ed200-a1bc-4596-8c93-c782fc4c5ef0] Performed ActiveStorage::PurgeJob (Job ID: e57ed200-a1bc-4596-8c93-c782fc4c5ef0) from Async(default) in 23.31ms
Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:31:19 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000112dbea80 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-6tdp3p.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 6044)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:31:24 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000112f3f0a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-tqasj7.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "dummy"], ["amount", 600], ["date", nil], ["invoice_number", 5], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 18:01:24.548446"], ["updated_at", "2022-08-07 18:01:24.548446"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 56]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "zrgw2jkhzxwhvklbfjka95jl9lxt"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 18:01:24.552338"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 77], ["created_at", "2022-08-07 18:01:24.553089"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:01:24.553599"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: zrgw2jkhzxwhvklbfjka95jl9lxt (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 56], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 5b3e63db-038d-4195-bf26-de4b0d8e5b83) to Async(default) with arguments: #<GlobalID:0x0000000113124a08 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/56>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 77]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 15325)


[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 56], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83] Performing ActiveStorage::PurgeJob (Job ID: 5b3e63db-038d-4195-bf26-de4b0d8e5b83) from Async(default) enqueued at 2022-08-07T18:01:24Z with arguments: #<GlobalID:0x0000000113184728 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/56>>
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 56], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 56]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 56], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mActiveStorage::Blob Destroy (17.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 56]]
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: ec1n7vje3kb2b7mkw31kyfbxwys0[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5b3e63db-038d-4195-bf26-de4b0d8e5b83] Performed ActiveStorage::PurgeJob (Job ID: 5b3e63db-038d-4195-bf26-de4b0d8e5b83) from Async(default) in 23.56ms
Started GET "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:31:30 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.3ms | Allocations: 1454)
Completed 200 OK in 4ms (Views: 1.5ms | ActiveRecord: 0.7ms | Allocations: 3908)


Started POST "/api/v1/expense_tracker/users/63/reports" for 127.0.0.1 at 2022-08-07 23:32:05 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"63", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 1 is already mapped or processed report 
expense 2 is already mapped or processed report 
  [1m[36mReport Create (0.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-07 18:02:05.916751"], ["updated_at", "2022-08-07 18:02:05.916751"], ["user_id", 63]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:02:05.919982"], ["report_id", 1], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 0.5ms | Allocations: 332)
Completed 200 OK in 12ms (Views: 1.0ms | ActiveRecord: 1.2ms | Allocations: 13118)


Started PATCH "/api/v1/expense_tracker/users/50/reports/54" for 127.0.0.1 at 2022-08-07 23:33:46 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"approved", "user_id"=>"50", "id"=>"54", "report"=>{"status"=>"approved"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 50], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 1772)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:33:59 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"approved", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"approved"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than submit are restricted: 1
Completed 403 Forbidden in 12ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 11945)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:34:09 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000011188e688>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:04:10.802501"], ["id", 3]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.1ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 18:04:09.013123"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
Completed 500 Internal Server Error in 1848ms (Views: 0.1ms | ActiveRecord: 2.3ms | Allocations: 18922)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:36:31 +0530
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001125bff78>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:06:33.503468"], ["id", 3]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.1ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 18:06:31.632642"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
Completed 500 Internal Server Error in 1939ms (Views: 0.1ms | ActiveRecord: 3.6ms | Allocations: 38632)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:36:52 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000113277fb8>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (1.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:07:03.115364"], ["id", 3]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mReport Update (1.0ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 18:06:54.682049"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
Completed 500 Internal Server Error in 102333ms (Views: 1.7ms | ActiveRecord: 10.2ms | Allocations: 98756)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:38:34 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000011278d738>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (1.5ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:08:48.179687"], ["id", 3]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.9ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 18:08:42.077399"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 4.1ms | Allocations: 311)
Completed 200 OK in 10186ms (Views: 8.7ms | ActiveRecord: 22.7ms | Allocations: 93888)


Started GET "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:40:02 +0530
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"63", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 7.7ms | Allocations: 7939)
Completed 200 OK in 26ms (Views: 8.0ms | ActiveRecord: 2.2ms | Allocations: 23029)


Started POST "/api/v1/expense_tracker/users/63/reports/1/comments" for 127.0.0.1 at 2022-08-07 23:40:18 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"hey thr", "user_id"=>"63", "report_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x000000011313d918>, params: {"comment"=>"hey thr", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"63", "report_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "hey thr"], ["commentable_type", "Report"], ["commentable_id", 1], ["user_id", 63], ["created_at", "2022-08-07 18:10:18.334364"], ["updated_at", "2022-08-07 18:10:18.334364"], ["parent_id", nil]]
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:17:in `add_report_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 46)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 161)
UserMailer#notify_comment: processed outbound mail in 1.0ms
Delivered mail 62f0000a53233_1431af4d8027@CALTM00564.local.mail (3833.9ms)
Date: Sun, 07 Aug 2022 23:40:18 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0000a53233_1431af4d8027@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: hey thr
commented at: 2022-08-07 18:10:18 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_report_comment.jbuilder
  Rendered comments/add_report_comment.jbuilder (Duration: 1.1ms | Allocations: 161)
Completed 200 OK in 3849ms (Views: 4.0ms | ActiveRecord: 1.1ms | Allocations: 15417)


Started POST "/api/v1/expense_tracker/users/63/reports/1/comments" for 127.0.0.1 at 2022-08-07 23:40:34 +0530
Processing by CommentsController#add_report_comment as */*
  Parameters: {"comment"=>"upload supporting docs", "user_id"=>"63", "report_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:15:in `add_report_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :report_id. Context: { controller: CommentsController, action: add_report_comment, request: #<ActionDispatch::Request:0x000000010c20e8f8>, params: {"comment"=>"upload supporting docs", "controller"=>"comments", "action"=>"add_report_comment", "user_id"=>"63", "report_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "upload supporting docs"], ["commentable_type", "Report"], ["commentable_id", 1], ["user_id", 63], ["created_at", "2022-08-07 18:10:34.949134"], ["updated_at", "2022-08-07 18:10:34.949134"], ["parent_id", nil]]
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:55:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:17:in `add_report_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 27)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 133)
UserMailer#notify_comment: processed outbound mail in 0.7ms
Delivered mail 62f0001ae8f4b_1431af4ec1ae@CALTM00564.local.mail (2804.5ms)
Date: Sun, 07 Aug 2022 23:40:34 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0001ae8f4b_1431af4ec1ae@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: upload supporting docs
commented at: 2022-08-07 18:10:34 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_report_comment.jbuilder
  Rendered comments/add_report_comment.jbuilder (Duration: 0.5ms | Allocations: 81)
Completed 200 OK in 2813ms (Views: 1.3ms | ActiveRecord: 1.4ms | Allocations: 9385)


Started GET "/api/v1/expense_tracker/users/63/reports/1/comments" for 127.0.0.1 at 2022-08-07 23:40:44 +0530
Processing by CommentsController#index_report_comments as */*
  Parameters: {"user_id"=>"63", "report_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:21:in `index_report_comments'
  Rendering comments/index_report_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Report"]]
  ↳ app/views/comments/index_report_comments.jbuilder:1
  Rendered comments/index_report_comments.jbuilder (Duration: 1.1ms | Allocations: 1811)
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 3206)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-07 23:41:06 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 167)
Completed 200 OK in 254ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 1846)


Started GET "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:41:16 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 1.9ms | Allocations: 3531)
Completed 200 OK in 5ms (Views: 2.3ms | ActiveRecord: 0.3ms | Allocations: 6524)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:41:55 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>1}, "user_id"=>"63", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
[31mUnpermitted parameters: :status, :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001118ff568>, params: {"expense"=>{"status"=>"approved", "amount"=>1}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"4"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.1ms | Allocations: 121)
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 9044)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:42:15 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>11}, "user_id"=>"63", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
[31mUnpermitted parameters: :status, :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000111e241d8>, params: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>11}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"4"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:12:15.414830"], ["approved_amount", 11], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 118)
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.2ms | Allocations: 8018)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:44:00 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>12}, "user_id"=>"63", "id"=>"4"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
[31mUnpermitted parameters: :status, :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000011232e3b8>, params: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>12}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"4"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:14:00.025693"], ["approved_amount", 12], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 118)
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 7933)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:49:31 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>12}, "user_id"=>"63", "id"=>"4"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is still in  draft version. #<Pundit::NotAuthorizedError: not allowed to submitted? this Expense>
Completed 400 Bad Request in 19ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 18427)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:50:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>1, "approved_amount"=>12}, "user_id"=>"63", "id"=>"4"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is still in  draft version. #<Pundit::NotAuthorizedError: not allowed to submitted? this Expense>
Completed 400 Bad Request in 17ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 18367)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/2" for 127.0.0.1 at 2022-08-07 23:50:27 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10, "approved_amount"=>12}, "user_id"=>"63", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001120aebd8>, params: {"expense"=>{"status"=>"approved", "amount"=>10, "approved_amount"=>12}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:20:27.133240"], ["approved_amount", 12], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 181)
Completed 200 OK in 8ms (Views: 0.8ms | ActiveRecord: 0.8ms | Allocations: 10737)


Started GET "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-07 23:52:26 +0530
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"63", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 6.6ms | Allocations: 7839)
Completed 200 OK in 27ms (Views: 6.9ms | ActiveRecord: 2.4ms | Allocations: 22889)


Started GET "/api/v1/expense_tracker/users/63/reports/2" for 127.0.0.1 at 2022-08-07 23:52:41 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"63", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
Completed 404 Not Found in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3646)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-07 23:53:03 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 168)
Completed 200 OK in 256ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 1847)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:53:44 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>12}, "user_id"=>"63", "id"=>"4"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:79:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.5ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 4], ["biller", "Kimia"], ["created_at", "2022-08-07 18:23:46.366427"], ["updated_at", "2022-08-07 18:23:46.366427"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000111a5d090>, params: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>12}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"4"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 10], ["status", 2], ["updated_at", "2022-08-07 18:23:46.374188"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.4ms | Allocations: 179)
Completed 200 OK in 1620ms (Views: 1.5ms | ActiveRecord: 3.4ms | Allocations: 15701)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/4" for 127.0.0.1 at 2022-08-07 23:54:35 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "user_id"=>"63", "id"=>"4"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:79:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 5893ms (Views: 0.3ms | ActiveRecord: 4.0ms | Allocations: 40657)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/5" for 127.0.0.1 at 2022-08-07 23:55:00 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "user_id"=>"63", "id"=>"5"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:79:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000011261e208>, params: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"5"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 10], ["status", 4], ["updated_at", "2022-08-07 18:25:02.726619"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 32)
  Rendered layout layouts/mailer.text.erb (Duration: 0.3ms | Allocations: 147)
UserMailer#expense_update: processed outbound mail in 2.3ms
Delivered mail 62f0037eb6e33_1431af5002a5@CALTM00564.local.mail (3251.5ms)
Date: Sun, 07 Aug 2022 23:55:02 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0037eb6e33_1431af5002a5@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 5
expense status: rejected
expense amount: 10
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.7ms | Allocations: 149)
Completed 200 OK in 5028ms (Views: 1.8ms | ActiveRecord: 2.4ms | Allocations: 21909)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:55:19 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000110be7ab0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-wn1ocz.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.3ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "dummy"], ["amount", 600], ["date", nil], ["invoice_number", 6], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 18:25:19.072420"], ["updated_at", "2022-08-07 18:25:19.072420"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 57]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "bymkqnol1ureecq8v6nehidecjk8"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 18:25:19.080341"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 78], ["created_at", "2022-08-07 18:25:19.081696"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:25:19.083774"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: bymkqnol1ureecq8v6nehidecjk8 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 57], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 06926163-4fd7-4c0a-bdfc-649e1ea262a4) to Async(default) with arguments: #<GlobalID:0x0000000112086480 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/57>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 78]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 133)
Completed 200 OK in 30ms (Views: 0.4ms | ActiveRecord: 3.1ms | Allocations: 29494)


[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 57], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4] Performing ActiveStorage::PurgeJob (Job ID: 06926163-4fd7-4c0a-bdfc-649e1ea262a4) from Async(default) enqueued at 2022-08-07T18:25:19Z with arguments: #<GlobalID:0x0000000112514678 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/57>>
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 57], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 57]]
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 57], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 57]]
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: cx0vz2c0l8nnxum0hj5lopunzh6x[0m
[ActiveJob] [ActiveStorage::PurgeJob] [06926163-4fd7-4c0a-bdfc-649e1ea262a4] Performed ActiveStorage::PurgeJob (Job ID: 06926163-4fd7-4c0a-bdfc-649e1ea262a4) from Async(default) in 26.1ms
Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:55:23 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000112784f20 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-5xbvhy.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"7", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "dummy"], ["amount", 600], ["date", nil], ["invoice_number", 7], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 18:25:23.375932"], ["updated_at", "2022-08-07 18:25:23.375932"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 58]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "4u837qn3z89ehxkiiwps0uvc6xdf"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 18:25:23.378939"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 79], ["created_at", "2022-08-07 18:25:23.379697"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:25:23.380167"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 4u837qn3z89ehxkiiwps0uvc6xdf (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 58], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 422e8ce3-3955-464e-bf3c-c7dc94699499) to Async(default) with arguments: #<GlobalID:0x0000000112c6f990 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/58>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 79]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 102)
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 1.8ms | Allocations: 15704)


[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 58], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499] Performing ActiveStorage::PurgeJob (Job ID: 422e8ce3-3955-464e-bf3c-c7dc94699499) from Async(default) enqueued at 2022-08-07T18:25:23Z with arguments: #<GlobalID:0x0000000112dc4ed0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/58>>
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 58], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 58]]
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 58], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mActiveStorage::Blob Destroy (17.9ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 58]]
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499] [36m  Disk Storage (0.7ms) [0m[31mDeleted file from key: 6b57x01ftup36j2p10trcrlsp02y[0m
[ActiveJob] [ActiveStorage::PurgeJob] [422e8ce3-3955-464e-bf3c-c7dc94699499] Performed ActiveStorage::PurgeJob (Job ID: 422e8ce3-3955-464e-bf3c-c7dc94699499) from Async(default) in 24.69ms
Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:55:27 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000112fe4120 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220807-82714-mylivk.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"8", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "dummy"], ["amount", 600], ["date", nil], ["invoice_number", 8], ["status", 0], ["user_id", 63], ["created_at", "2022-08-07 18:25:27.235961"], ["updated_at", "2022-08-07 18:25:27.235961"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 59]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "0env9hckg5jtp1o3nzo6okck4syb"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-07 18:25:27.239270"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 80], ["created_at", "2022-08-07 18:25:27.239997"]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:25:27.240537"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 0env9hckg5jtp1o3nzo6okck4syb (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 59], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 9e2a87ee-82e6-4775-b340-a0a225e70a53) to Async(default) with arguments: #<GlobalID:0x00000001132b7a78 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/59>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 80]]
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:60:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 5.6ms | Allocations: 88)
Completed 200 OK in 20ms (Views: 6.0ms | ActiveRecord: 2.2ms | Allocations: 15344)


[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 59], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53] Performing ActiveStorage::PurgeJob (Job ID: 9e2a87ee-82e6-4775-b340-a0a225e70a53) from Async(default) enqueued at 2022-08-07T18:25:27Z with arguments: #<GlobalID:0x0000000105037040 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/59>>
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 59], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 59]]
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 59], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 59]]
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: ggd7lvpjmryacipblcm1ll8lytlg[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9e2a87ee-82e6-4775-b340-a0a225e70a53] Performed ActiveStorage::PurgeJob (Job ID: 9e2a87ee-82e6-4775-b340-a0a225e70a53) from Async(default) in 24.34ms
Started PATCH "/api/v1/expense_tracker/users/63/expenses/5" for 127.0.0.1 at 2022-08-07 23:55:39 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "user_id"=>"63", "id"=>"5"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:79:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 5178)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-07 23:55:45 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:79:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (1.0ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 6], ["biller", "Quamba"], ["created_at", "2022-08-07 18:25:46.654466"], ["updated_at", "2022-08-07 18:25:46.654466"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000110b8fe50>, params: {"expense"=>{"status"=>"submitted", "amount"=>10, "approved_amount"=>15}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"6"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 6], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 10], ["status", 2], ["updated_at", "2022-08-07 18:25:46.664852"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 125)
Completed 200 OK in 1563ms (Views: 0.6ms | ActiveRecord: 3.3ms | Allocations: 11653)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-07 23:55:56 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 256ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1152)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-07 23:56:19 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:75:in `process_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000113224778>, params: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"6"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 6], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (1.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-07 18:26:38.409935"], ["approved_amount", 15], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 7.7ms | Allocations: 161)
Completed 200 OK in 20375ms (Views: 15.6ms | ActiveRecord: 9.5ms | Allocations: 60901)


Started GET "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-07 23:59:29 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"63"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:66:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 9.5ms | Allocations: 9452)
Completed 200 OK in 33ms (Views: 9.9ms | ActiveRecord: 2.0ms | Allocations: 22556)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:00:00 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:66:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:76:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 6
Completed 403 Forbidden in 5ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 5492)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:01:17 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:66:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:76:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 6
Completed 403 Forbidden in 16ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 18079)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:03:01 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:67:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:77:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 6
Completed 403 Forbidden in 15ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 18134)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:03:13 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:67:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:77:in `process_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:04:10 +0530
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:67:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:77:in `process_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 6
Completed 403 Forbidden in 191882ms (Views: 1.4ms | ActiveRecord: 12.7ms | Allocations: 65752)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/6" for 127.0.0.1 at 2022-08-08 00:07:30 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"6"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106a0d668>, params: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"6"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 6], ["id", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (1.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-07 18:37:40.596563"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 8.5ms | Allocations: 451)
  Rendered layout layouts/mailer.text.erb (Duration: 13.9ms | Allocations: 699)
UserMailer#expense_update: processed outbound mail in 920.3ms
Delivered mail 62f00677d5c71_a009f4c4-49d@CALTM00564.local.mail (3181.2ms)
Date: Mon, 08 Aug 2022 00:07:43 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f00677d5c71_a009f4c4-49d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 6
expense status: approved
expense amount: 10
approved amount: 15.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 9.9ms | Allocations: 318)
Completed 200 OK in 10816ms (Views: 18.4ms | ActiveRecord: 20.6ms | Allocations: 88028)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 00:08:07 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 3.8ms | Allocations: 275)
Completed 200 OK in 272ms (Views: 8.4ms | ActiveRecord: 1.5ms | Allocations: 2083)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/7" for 127.0.0.1 at 2022-08-08 00:08:21 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "user_id"=>"63", "id"=>"7"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001072a91a0>, params: {"expense"=>{"status"=>"approved", "amount"=>10000, "approved_amount"=>15}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"7"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 7], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.8ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 10000], ["updated_at", "2022-08-07 18:38:24.641101"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 150)
Completed 200 OK in 3618ms (Views: 0.5ms | ActiveRecord: 4.9ms | Allocations: 18630)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/7" for 127.0.0.1 at 2022-08-08 00:08:40 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"63", "id"=>"7"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106be6e80>, params: {"expense"=>{"status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"7"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 7], ["id", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:38:42.549422"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 22)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 131)
UserMailer#expense_update: processed outbound mail in 1.7ms
Delivered mail 62f006b2879bc_a009f500-35d@CALTM00564.local.mail (2748.5ms)
Date: Mon, 08 Aug 2022 00:08:42 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f006b2879bc_a009f500-35d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 7
expense status: rejected
expense amount: 10000
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 143)
Completed 200 OK in 4413ms (Views: 1.9ms | ActiveRecord: 2.1ms | Allocations: 21950)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/8" for 127.0.0.1 at 2022-08-08 00:09:00 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"63", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 63]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 63], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.4ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 8], ["biller", "Zoozzy"], ["created_at", "2022-08-07 18:39:02.540751"], ["updated_at", "2022-08-07 18:39:02.540751"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000106fc87b0>, params: {"expense"=>{"status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"63", "id"=>"8"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 8], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-07 18:39:02.547914"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 150)
Completed 200 OK in 1682ms (Views: 0.8ms | ActiveRecord: 3.5ms | Allocations: 14069)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 00:09:12 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 96)
Completed 200 OK in 255ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1175)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/8" for 127.0.0.1 at 2022-08-08 00:09:26 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"rejecte"}, "user_id"=>"63", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 8
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 4756)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/8" for 127.0.0.1 at 2022-08-08 00:09:33 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"rejected"}, "user_id"=>"63", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 62]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 8], ["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-07 18:39:33.169789"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 20)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 126)
UserMailer#expense_update: processed outbound mail in 0.7ms
Delivered mail 62f006e52a212_a009f4ec-2d3@CALTM00564.local.mail (2629.1ms)
Date: Mon, 08 Aug 2022 00:09:33 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f006e52a212_a009f4ec-2d3@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 8
expense status: rejected
expense amount: 600
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 2.3ms | Allocations: 114)
Completed 200 OK in 2643ms (Views: 3.1ms | ActiveRecord: 1.0ms | Allocations: 12373)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 10:07:13 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000010774c3b0>, params: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "admin"], ["department", "Engineering"], ["status", 1], ["email", "admin@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 04:37:13.747130"], ["updated_at", "2022-08-08 04:37:13.747130"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 64], ["created_at", "2022-08-08 04:37:13.749865"], ["updated_at", "2022-08-08 04:37:13.749865"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 64], ["created_at", "2022-08-08 04:37:13.751587"], ["updated_at", "2022-08-08 04:37:13.751587"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 1319)
Completed 201 Created in 267ms (Views: 2.5ms | ActiveRecord: 3.4ms | Allocations: 10340)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 10:07:29 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001078cf048>, params: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "kasi@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 04:37:29.404941"], ["updated_at", "2022-08-08 04:37:29.404941"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 65], ["created_at", "2022-08-08 04:37:29.407849"], ["updated_at", "2022-08-08 04:37:29.407849"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 853)
Completed 201 Created in 260ms (Views: 0.9ms | ActiveRecord: 2.3ms | Allocations: 6149)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 10:07:47 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 253ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 1195)


Started POST "/api/v1/expense_tracker/users/63/expenses" for 127.0.0.1 at 2022-08-08 10:08:11 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"600", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107d042d0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-40969-4grpr2.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"8", "description"=>"dummy"}, "user_id"=>"63"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1857)


Started POST "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:08:45 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107d5c6d8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-40969-m3haok.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"Travel"}, "user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 100], ["date", nil], ["invoice_number", 1], ["status", 0], ["user_id", 65], ["created_at", "2022-08-08 04:38:45.432676"], ["updated_at", "2022-08-08 04:38:45.432676"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 73]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "udham3t5y6jarjzpf7rjtis8suz6"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 04:38:45.445081"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 81], ["created_at", "2022-08-08 04:38:45.446167"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 04:38:45.446986"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: udham3t5y6jarjzpf7rjtis8suz6 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 73], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 075a3072-7206-4eab-9fa8-a0df197f87ae) to Async(default) with arguments: #<GlobalID:0x000000011028dbe0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/73>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 81]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.6ms | Allocations: 261)
Completed 200 OK in 47ms (Views: 0.9ms | ActiveRecord: 2.9ms | Allocations: 44137)


[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 73], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae] Performing ActiveStorage::PurgeJob (Job ID: 075a3072-7206-4eab-9fa8-a0df197f87ae) from Async(default) enqueued at 2022-08-08T04:38:45Z with arguments: #<GlobalID:0x0000000110305618 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/73>>
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 73], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 73]]
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 73], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 73]]
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: d2bk8wwezzh0oodlqkp9mn1la3d5[0m
[ActiveJob] [ActiveStorage::PurgeJob] [075a3072-7206-4eab-9fa8-a0df197f87ae] Performed ActiveStorage::PurgeJob (Job ID: 075a3072-7206-4eab-9fa8-a0df197f87ae) from Async(default) in 30.61ms
Started POST "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:09:01 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011040ea00 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-40969-ivqnir.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Food"}, "user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 150], ["date", nil], ["invoice_number", 2], ["status", 0], ["user_id", 65], ["created_at", "2022-08-08 04:39:01.184206"], ["updated_at", "2022-08-08 04:39:01.184206"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 74]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "sgvkso3zklg96l8hqxe17x7s3suf"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 04:39:01.194685"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 82], ["created_at", "2022-08-08 04:39:01.195798"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 04:39:01.196362"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: sgvkso3zklg96l8hqxe17x7s3suf (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 74], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef) to Async(default) with arguments: #<GlobalID:0x000000010673bae8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/74>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 82]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 102)
Completed 200 OK in 22ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 15714)


[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 74], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef] Performing ActiveStorage::PurgeJob (Job ID: 5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef) from Async(default) enqueued at 2022-08-08T04:39:01Z with arguments: #<GlobalID:0x0000000106a06cf0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/74>>
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 74], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 74]]
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 74], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mActiveStorage::Blob Destroy (17.9ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 74]]
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef]   [1m[36mTRANSACTION (2.0ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: 3li4htply4y96rbihtzcasg80a6m[0m
[ActiveJob] [ActiveStorage::PurgeJob] [5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef] Performed ActiveStorage::PurgeJob (Job ID: 5dd9d4ce-1f37-46c3-a8bd-50d180efa9ef) from Async(default) in 26.35ms
Started POST "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:09:41 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"1500", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106b5dce8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-40969-5gjafa.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Hotel accomdation"}, "user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 6312)


Started POST "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:09:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"1500", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000106cf3eb8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-40969-hj034e.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"Hotel accomdation"}, "user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.2ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Hotel accomdation"], ["amount", 1500], ["date", nil], ["invoice_number", 3], ["status", 0], ["user_id", 65], ["created_at", "2022-08-08 04:39:46.421664"], ["updated_at", "2022-08-08 04:39:46.421664"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 75]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "8kebk2awurwssg6pktzhbkuw5fam"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 04:39:46.426580"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 83], ["created_at", "2022-08-08 04:39:46.427264"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 04:39:46.427944"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 8kebk2awurwssg6pktzhbkuw5fam (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 75], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ab63385a-f21d-4d3d-9fd0-44a537d2c242) to Async(default) with arguments: #<GlobalID:0x0000000106f58780 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/75>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 83]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 15330)


[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 75], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242] Performing ActiveStorage::PurgeJob (Job ID: ab63385a-f21d-4d3d-9fd0-44a537d2c242) from Async(default) enqueued at 2022-08-08T04:39:46Z with arguments: #<GlobalID:0x0000000107009a30 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/75>>
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 75], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 75]]
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 75], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 75]]
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242]   [1m[36mTRANSACTION (17.8ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: zo3t43p7vvd35ntch8dscbl1mb2c[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ab63385a-f21d-4d3d-9fd0-44a537d2c242] Performed ActiveStorage::PurgeJob (Job ID: ab63385a-f21d-4d3d-9fd0-44a537d2c242) from Async(default) in 24.6ms
Started GET "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:10:15 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.2ms | Allocations: 2194)
Completed 200 OK in 5ms (Views: 2.3ms | ActiveRecord: 0.3ms | Allocations: 4932)


Started PATCH "/api/v1/expense_tracker/users/63/expenses/8" for 127.0.0.1 at 2022-08-08 10:10:41 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"rejected"}, "user_id"=>"63", "id"=>"8"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1641)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:10:50 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"rejected"}, "user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001072a9ce0>, params: {"expense"=>{"status"=>"rejected"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"65", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.1ms | Allocations: 120)
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 7207)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:11:41 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>110}, "user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000107675d38>, params: {"expense"=>{"status"=>"submitted", "amount"=>110}, "controller"=>"expenses", "action"=>"update", "user_id"=>"65", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 110], ["status", 4], ["updated_at", "2022-08-08 04:41:42.865457"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 20)
  Rendered layout layouts/mailer.text.erb (Duration: 0.4ms | Allocations: 126)
UserMailer#expense_update: processed outbound mail in 1.5ms
Delivered mail 62f09406d4dba_a009f4d8-1fa@CALTM00564.local.mail (3273.9ms)
Date: Mon, 08 Aug 2022 10:11:42 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f09406d4dba_a009f4d8-1fa@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 1
expense status: rejected
expense amount: 110
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 114)
Completed 200 OK in 5109ms (Views: 2.5ms | ActiveRecord: 2.6ms | Allocations: 14020)


Started POST "/api/v1/expense_tracker/users/65/reports" for 127.0.0.1 at 2022-08-08 10:12:49 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"65", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 1 is already mapped or processed report 
  [1m[36mReport Create (0.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-08 04:42:49.485653"], ["updated_at", "2022-08-08 04:42:49.485653"], ["user_id", 65]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 04:42:49.489019"], ["report_id", 1], ["id", 2]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 04:42:49.490433"], ["report_id", 1], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 0.5ms | Allocations: 382)
Completed 200 OK in 16ms (Views: 1.1ms | ActiveRecord: 2.1ms | Allocations: 16724)


Started GET "/api/v1/expense_tracker/users/65/reports/1" for 127.0.0.1 at 2022-08-08 10:13:23 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"65", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.9ms | Allocations: 1904)
Completed 200 OK in 6ms (Views: 2.1ms | ActiveRecord: 0.8ms | Allocations: 5583)


Started PATCH "/api/v1/expense_tracker/users/63/reports/1" for 127.0.0.1 at 2022-08-08 10:13:36 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"approved", "user_id"=>"63", "id"=>"1", "report"=>{"status"=>"approved"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1671)


Started PATCH "/api/v1/expense_tracker/users/65/reports/1" for 127.0.0.1 at 2022-08-08 10:13:43 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"approved", "user_id"=>"65", "id"=>"1", "report"=>{"status"=>"approved"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than submit are restricted: 1
Completed 403 Forbidden in 10ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 11758)


Started PATCH "/api/v1/expense_tracker/users/65/reports/1" for 127.0.0.1 at 2022-08-08 10:13:56 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"65", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000011000e450>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"65", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:39:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 04:43:58.859105"], ["id", 2]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 04:44:00.775955"], ["id", 3]]
  ↳ app/models/report.rb:42:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.2ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 04:43:56.313110"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 1.3ms | Allocations: 338)
Completed 200 OK in 4475ms (Views: 1.8ms | ActiveRecord: 3.9ms | Allocations: 17330)


Started POST "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 10:15:04 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"kindly process this expense asap", "user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001102fdb20>, params: {"comment"=>"kindly process this expense asap", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"65", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "kindly process this expense asap"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 65], ["created_at", "2022-08-08 04:45:04.106772"], ["updated_at", "2022-08-08 04:45:04.106772"], ["parent_id", nil]]
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:48:in `add_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 210)
  Rendered layout layouts/mailer.text.erb (Duration: 0.8ms | Allocations: 317)
UserMailer#notify_comment: processed outbound mail in 1.6ms
Delivered mail 62f094d01c51a_a009f50002@CALTM00564.local.mail (2827.1ms)
Date: Mon, 08 Aug 2022 10:15:04 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f094d01c51a_a009f50002@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: kindly process this expense asap
commented at: 2022-08-08 04:45:04 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 1.3ms | Allocations: 249)
Completed 200 OK in 2845ms (Views: 3.2ms | ActiveRecord: 1.5ms | Allocations: 14147)


Started GET "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 10:15:25 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  Rendered comments/index_expense_comments.jbuilder (Duration: 1.7ms | Allocations: 1914)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 3491)


Started GET "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:20:25 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (3.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 19.8ms | Allocations: 16403)
Completed 500 Internal Server Error in 33ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 20178)


Started GET "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:21:06 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"65", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  Rendered expenses/show.jbuilder (Duration: 10.4ms | Allocations: 8255)
Completed 500 Internal Server Error in 32ms (ActiveRecord: 1.7ms | Allocations: 28854)


  
ActionView::Template::Error (undefined method `map' for #<Expense id: 1, description: "Travel", amount: 110, date: nil, invoice_number: 1, status: "rejected", user_id: 65, created_at: "2022-08-08 04:38:45.432676000 +0000", updated_at: "2022-08-08 04:41:42.865457000 +0000", report_id: nil, approved_amount: nil>
Did you mean?  tap):
    1: json.expense(@expense) do
    2:     json.comments(@expense.comments)
    3: end
  
app/views/expenses/show.jbuilder:1
Started GET "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:22:17 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/expenses/show.jbuilder:3
  Rendered expenses/show.jbuilder (Duration: 12.0ms | Allocations: 14642)
Completed 200 OK in 16ms (Views: 12.3ms | ActiveRecord: 0.6ms | Allocations: 18517)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 10:24:10 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.8ms | Allocations: 519)
Completed 200 OK in 261ms (Views: 2.4ms | ActiveRecord: 0.6ms | Allocations: 12977)


Started GET "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:24:31 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/expenses/show.jbuilder:3
  Rendered expenses/show.jbuilder (Duration: 11.0ms | Allocations: 6904)
Completed 200 OK in 50ms (Views: 11.9ms | ActiveRecord: 4.1ms | Allocations: 26949)


Started GET "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 10:24:40 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/views/expenses/index.jbuilder:4
  Rendered expenses/index.jbuilder (Duration: 2.4ms | Allocations: 2168)
Completed 200 OK in 15ms (Views: 2.5ms | ActiveRecord: 0.3ms | Allocations: 4933)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:24:48 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>110}, "user_id"=>"65", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is still in  draft version. #<Pundit::NotAuthorizedError: not allowed to submitted? this Expense>
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 5687)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/1" for 127.0.0.1 at 2022-08-08 10:26:58 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>110}, "user_id"=>"65", "id"=>"1"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is still in  draft version. #<Pundit::NotAuthorizedError: not allowed to submitted? this Expense>
Completed 400 Bad Request in 15ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 18358)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/2" for 127.0.0.1 at 2022-08-08 10:27:28 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>110}, "user_id"=>"65", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
 actions other than approved or rejected are restricted: 2
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 4852)


Started PATCH "/api/v1/expense_tracker/users/65/expenses/2" for 127.0.0.1 at 2022-08-08 10:27:51 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>110}, "user_id"=>"65", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 04:57:51.129114"], ["approved_amount", 110], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.9ms | Allocations: 287)
  Rendered layout layouts/mailer.text.erb (Duration: 1.5ms | Allocations: 521)
UserMailer#expense_update: processed outbound mail in 7.1ms
Delivered mail 62f097cf2e489_156d5f2583837@CALTM00564.local.mail (3233.5ms)
Date: Mon, 08 Aug 2022 10:27:51 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f097cf2e489_156d5f2583837@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 2
expense status: approved
expense amount: 150
approved amount: 110.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 1.7ms | Allocations: 270)
Completed 200 OK in 3306ms (Views: 4.0ms | ActiveRecord: 1.2ms | Allocations: 33782)


Started GET "/api/v1/expense_tracker/users/65/reports/1" for 127.0.0.1 at 2022-08-08 10:30:28 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"65", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 65], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 4.4ms | Allocations: 2658)
Completed 200 OK in 10ms (Views: 3.1ms | ActiveRecord: 3.4ms | Allocations: 8728)


Started GET "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 13:44:25 +0530
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"65"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 64]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 65]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 21.3ms | Allocations: 11224)
Completed 200 OK in 55ms (Views: 23.5ms | ActiveRecord: 2.1ms | Allocations: 32481)


Started POST "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:44:39 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"kindly process this expense asap", "user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000107d1d618>, params: {"comment"=>"kindly process this expense asap", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"65", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "kindly process this expense asap"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 64], ["created_at", "2022-08-08 08:14:39.793153"], ["updated_at", "2022-08-08 08:14:39.793153"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.9ms | Allocations: 266)
  Rendered layout layouts/mailer.text.erb (Duration: 2.0ms | Allocations: 500)
UserMailer#notify_comment: processed outbound mail in 6.6ms
Delivered mail 62f0c5efca064_17b6bf230696e0@CALTM00564.local.mail (3146.1ms)
Date: Mon, 08 Aug 2022 13:44:39 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0c5efca064_17b6bf230696e0@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: kindly process this expense asap
commented at: 2022-08-08 08:14:39 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 2.2ms | Allocations: 260)
Completed 200 OK in 3194ms (Views: 5.3ms | ActiveRecord: 2.6ms | Allocations: 28703)


Started POST "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:45:27 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"kindly process this expense asap", "user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000113c6e580>, params: {"comment"=>"kindly process this expense asap", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"65", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.5ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "kindly process this expense asap"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 64], ["created_at", "2022-08-08 08:15:27.593895"], ["updated_at", "2022-08-08 08:15:27.593895"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 215)
  Rendered layout layouts/mailer.text.erb (Duration: 1.1ms | Allocations: 440)
UserMailer#notify_comment: processed outbound mail in 2.3ms
Delivered mail 62f0c61f9261b_17b6bf244697a5@CALTM00564.local.mail (2718.2ms)
Date: Mon, 08 Aug 2022 13:45:27 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0c61f9261b_17b6bf244697a5@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: kindly process this expense asap
commented at: 2022-08-08 08:15:27 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 1.2ms | Allocations: 217)
Completed 200 OK in 2732ms (Views: 3.1ms | ActiveRecord: 1.1ms | Allocations: 10943)


Started POST "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:46:39 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>25, "comment"=>"will keep you posted on this", "user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001162d37e8>, params: {"parent_id"=>25, "comment"=>"will keep you posted on this", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"65", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "will keep you posted on this"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 64], ["created_at", "2022-08-08 08:16:39.556125"], ["updated_at", "2022-08-08 08:16:39.556125"], ["parent_id", 25]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 27)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 134)
UserMailer#notify_comment: processed outbound mail in 0.8ms
Delivered mail 62f0c66788fc6_17b6bf258698e2@CALTM00564.local.mail (2926.7ms)
Date: Mon, 08 Aug 2022 13:46:39 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0c66788fc6_17b6bf258698e2@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: will keep you posted on this
commented at: 2022-08-08 08:16:39 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 0.6ms | Allocations: 87)
Completed 200 OK in 2938ms (Views: 1.7ms | ActiveRecord: 1.5ms | Allocations: 9516)


Started GET "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:47:07 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  Rendered comments/index_expense_comments.jbuilder (Duration: 2.2ms | Allocations: 2025)
Completed 200 OK in 4ms (Views: 2.3ms | ActiveRecord: 0.3ms | Allocations: 3501)


Started GET "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:51:55 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 23]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.2ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 24]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 25]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 26]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  Rendered comments/index_expense_comments.jbuilder (Duration: 16.5ms | Allocations: 5742)
Completed 200 OK in 26ms (Views: 21.3ms | ActiveRecord: 1.0ms | Allocations: 7586)


Started POST "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:53:16 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"parent_id"=>26, "comment"=>"Thanks", "user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001166cffb8>, params: {"parent_id"=>26, "comment"=>"Thanks", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"65", "expense_id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Thanks"], ["commentable_type", "Expense"], ["commentable_id", 1], ["user_id", 64], ["created_at", "2022-08-08 08:23:16.906574"], ["updated_at", "2022-08-08 08:23:16.906574"], ["parent_id", 26]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.7ms | Allocations: 214)
  Rendered layout layouts/mailer.text.erb (Duration: 1.2ms | Allocations: 438)
UserMailer#notify_comment: processed outbound mail in 2.8ms
Delivered mail 62f0c7f4df310_17b6bf2306997f@CALTM00564.local.mail (2935.1ms)
Date: Mon, 08 Aug 2022 13:53:16 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0c7f4df310_17b6bf2306997f@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: Thanks
commented at: 2022-08-08 08:23:16 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 0.9ms | Allocations: 198)
Completed 200 OK in 2949ms (Views: 1.4ms | ActiveRecord: 1.6ms | Allocations: 10363)


Started GET "/api/v1/expense_tracker/users/65/expenses/1/comments" for 127.0.0.1 at 2022-08-08 13:53:23 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"65", "expense_id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 23]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 24]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.3ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 25]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.9ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 26]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 27]]
  ↳ app/views/comments/index_expense_comments.jbuilder:6
  Rendered comments/index_expense_comments.jbuilder (Duration: 28.1ms | Allocations: 5036)
Completed 200 OK in 30ms (Views: 26.9ms | ActiveRecord: 1.7ms | Allocations: 6518)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 15:07:58 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001110d5ae0>, params: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "kasi@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 09:37:58.574380"], ["updated_at", "2022-08-08 09:37:58.574380"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 66], ["created_at", "2022-08-08 09:37:58.577462"], ["updated_at", "2022-08-08 09:37:58.577462"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 1196)
Completed 201 Created in 268ms (Views: 2.4ms | ActiveRecord: 2.6ms | Allocations: 8406)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 15:08:04 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113afe3a8>, params: {"user"=>{"email"=>"kasi@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
unable to onboard user, exception ["Email has already been taken"]
Completed 400 Bad Request in 256ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 4770)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 15:08:13 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"krishna@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000113cd6220>, params: {"user"=>{"email"=>"krishna@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "krishna@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "krishna"], ["department", "Engineering"], ["status", 1], ["email", "krishna@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 09:38:13.889106"], ["updated_at", "2022-08-08 09:38:13.889106"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.5ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 67], ["created_at", "2022-08-08 09:38:13.891286"], ["updated_at", "2022-08-08 09:38:13.891286"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 67]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.7ms | Allocations: 853)
Completed 201 Created in 261ms (Views: 0.9ms | ActiveRecord: 3.1ms | Allocations: 6034)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 15:08:25 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00000001162667d8>, params: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "admin"], ["department", "Engineering"], ["status", 1], ["email", "admin@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 09:38:26.072847"], ["updated_at", "2022-08-08 09:38:26.072847"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 68], ["created_at", "2022-08-08 09:38:26.076008"], ["updated_at", "2022-08-08 09:38:26.076008"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 68], ["created_at", "2022-08-08 09:38:26.077845"], ["updated_at", "2022-08-08 09:38:26.077845"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 968)
Completed 201 Created in 262ms (Views: 0.9ms | ActiveRecord: 3.1ms | Allocations: 8100)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:08:32 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 261)
Completed 200 OK in 256ms (Views: 2.0ms | ActiveRecord: 0.1ms | Allocations: 2020)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:08:42 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 91)
Completed 200 OK in 251ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 1249)


Started POST "/api/v1/expense_tracker/user/login?email=krishna@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:09:10 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"krishna@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "krishna@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 91)
Completed 200 OK in 255ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 1110)


Started POST "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 15:09:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"1500", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001166fce50 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-c7hqpp.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"Hotel accomdation"}, "user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1866)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:09:45 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116794868 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-yj2tbj.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"Hotel accomdation"}, "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Hotel accomdation"], ["amount", 100], ["date", nil], ["invoice_number", 1], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:39:45.615298"], ["updated_at", "2022-08-08 09:39:45.615298"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 81]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "6h9r387t1wjv5wwr4hkmm01n5dhh"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:39:45.626738"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 84], ["created_at", "2022-08-08 09:39:45.627740"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:39:45.628253"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 6h9r387t1wjv5wwr4hkmm01n5dhh (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 81], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 14d1b711-35f4-48f7-9ff1-fed025b9048a) to Async(default) with arguments: #<GlobalID:0x0000000113aefc68 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/81>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 84]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 279)
Completed 200 OK in 44ms (Views: 1.2ms | ActiveRecord: 3.3ms | Allocations: 37607)


[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 81], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a] Performing ActiveStorage::PurgeJob (Job ID: 14d1b711-35f4-48f7-9ff1-fed025b9048a) from Async(default) enqueued at 2022-08-08T09:39:45Z with arguments: #<GlobalID:0x0000000113cd5398 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/81>>
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 81], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 81]]
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 81], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 81]]
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: udham3t5y6jarjzpf7rjtis8suz6[0m
[ActiveJob] [ActiveStorage::PurgeJob] [14d1b711-35f4-48f7-9ff1-fed025b9048a] Performed ActiveStorage::PurgeJob (Job ID: 14d1b711-35f4-48f7-9ff1-fed025b9048a) from Async(default) in 27.88ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:10:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"1001", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001162f9c68 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-tc9fc3.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Food"}, "user_id"=>"67"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 1001], ["date", nil], ["invoice_number", 2], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:40:00.553454"], ["updated_at", "2022-08-08 09:40:00.553454"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 82]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vqaj08btegkcytw8dd4ghmlzyv4w"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:40:00.556910"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 85], ["created_at", "2022-08-08 09:40:00.557622"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:40:00.558247"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: vqaj08btegkcytw8dd4ghmlzyv4w (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 82], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ea25d721-ab9d-4d7b-846a-069bcc7cebcf) to Async(default) with arguments: #<GlobalID:0x00000001165bfc40 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/82>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 85]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 102)
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 15703)


[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 82], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf] Performing ActiveStorage::PurgeJob (Job ID: ea25d721-ab9d-4d7b-846a-069bcc7cebcf) from Async(default) enqueued at 2022-08-08T09:40:00Z with arguments: #<GlobalID:0x000000011662c958 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/82>>
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 82], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 82]]
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 82], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 82]]
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf] [36m  Disk Storage (18.2ms) [0m[31mDeleted file from key: sgvkso3zklg96l8hqxe17x7s3suf[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ea25d721-ab9d-4d7b-846a-069bcc7cebcf] Performed ActiveStorage::PurgeJob (Job ID: ea25d721-ab9d-4d7b-846a-069bcc7cebcf) from Async(default) in 23.83ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:10:22 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001166e5fe8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-lue21e.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Travel"}, "user_id"=>"67"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 6159)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:10:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011693ecb8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-6f07t8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"Travel"}, "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", nil], ["invoice_number", 3], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:40:26.753963"], ["updated_at", "2022-08-08 09:40:26.753963"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 83]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "luendmjyjsi9pefl8k1yarklc2fk"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:40:26.757641"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 86], ["created_at", "2022-08-08 09:40:26.758399"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:40:26.759129"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: luendmjyjsi9pefl8k1yarklc2fk (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 83], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 366b6251-abfe-4eb6-a21a-967ab173f807) to Async(default) with arguments: #<GlobalID:0x000000011339cab0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/83>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 86]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 15346)


[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 83], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807] Performing ActiveStorage::PurgeJob (Job ID: 366b6251-abfe-4eb6-a21a-967ab173f807) from Async(default) enqueued at 2022-08-08T09:40:26Z with arguments: #<GlobalID:0x00000001137be1e8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/83>>
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 83], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 83]]
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 83], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 83]]
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807]   [1m[36mTRANSACTION (18.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: 8kebk2awurwssg6pktzhbkuw5fam[0m
[ActiveJob] [ActiveStorage::PurgeJob] [366b6251-abfe-4eb6-a21a-967ab173f807] Performed ActiveStorage::PurgeJob (Job ID: 366b6251-abfe-4eb6-a21a-967ab173f807) from Async(default) in 24.46ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:11:00 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000113c0f558 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-p7w1of.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"Travel"}, "date"=>"\"12-12-2022\"", "user_id"=>"67"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", nil], ["invoice_number", 4], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:41:00.738063"], ["updated_at", "2022-08-08 09:41:00.738063"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 76]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "27k1txrqgnoy34pgmgt7rrfski0c"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:41:00.742722"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 87], ["created_at", "2022-08-08 09:41:00.744270"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:41:00.744930"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 27k1txrqgnoy34pgmgt7rrfski0c (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 76], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: b3570d18-d64f-453f-971b-3362c1224abe) to Async(default) with arguments: #<GlobalID:0x0000000116320598 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/76>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 87]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.3ms | Allocations: 88)
Completed 200 OK in 18ms (Views: 0.6ms | ActiveRecord: 2.7ms | Allocations: 15355)


[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 76], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe] Performing ActiveStorage::PurgeJob (Job ID: b3570d18-d64f-453f-971b-3362c1224abe) from Async(default) enqueued at 2022-08-08T09:41:00Z with arguments: #<GlobalID:0x00000001163bac88 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/76>>
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 76], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 76]]
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 76], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mActiveStorage::Blob Destroy (17.8ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 76]]
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: tdhdcucl4e9gygwjlwewgd8om5rm[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b3570d18-d64f-453f-971b-3362c1224abe] Performed ActiveStorage::PurgeJob (Job ID: b3570d18-d64f-453f-971b-3362c1224abe) from Async(default) in 24.45ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:11:10 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001165bc2e8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-6fdtsu.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"Travel"}, "date"=>"12-12-2022", "user_id"=>"67"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 5994)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:11:14 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001166fc748 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-c4l01o.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel"}, "date"=>"12-12-2022", "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", nil], ["invoice_number", 5], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:41:14.264185"], ["updated_at", "2022-08-08 09:41:14.264185"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 77]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "fjzzjn1xo13gt2fkt4zz89nrondm"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:41:14.267882"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 88], ["created_at", "2022-08-08 09:41:14.268617"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (1.9ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:41:14.274148"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: fjzzjn1xo13gt2fkt4zz89nrondm (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 77], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 849dcea0-6b2c-48f8-a784-8766e211cc81) to Async(default) with arguments: #<GlobalID:0x0000000116358290 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/77>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 88]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 88)
Completed 200 OK in 55ms (Views: 0.7ms | ActiveRecord: 4.3ms | Allocations: 15368)


[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 77], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81] Performing ActiveStorage::PurgeJob (Job ID: 849dcea0-6b2c-48f8-a784-8766e211cc81) from Async(default) enqueued at 2022-08-08T09:41:14Z with arguments: #<GlobalID:0x0000000106374bd0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/77>>
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 77], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 77]]
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 77], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mActiveStorage::Blob Destroy (17.7ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 77]]
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: zrgw2jkhzxwhvklbfjka95jl9lxt[0m
[ActiveJob] [ActiveStorage::PurgeJob] [849dcea0-6b2c-48f8-a784-8766e211cc81] Performed ActiveStorage::PurgeJob (Job ID: 849dcea0-6b2c-48f8-a784-8766e211cc81) from Async(default) in 23.79ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:11:24 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000110dbe258 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-emg56y.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel"}, "date"=>"12/12/2022", "user_id"=>"67"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 6000)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:11:27 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001110b7180 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-shl4bw.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"Travel"}, "date"=>"12/12/2022", "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", nil], ["invoice_number", 6], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:41:27.967226"], ["updated_at", "2022-08-08 09:41:27.967226"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 78]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "5d326mq9vzpu2vqiexl3825lya7z"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:41:27.970989"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 89], ["created_at", "2022-08-08 09:41:27.971810"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:41:27.972286"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: 5d326mq9vzpu2vqiexl3825lya7z (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 78], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 4e493809-dd95-4001-a74d-1aca5eec3460) to Async(default) with arguments: #<GlobalID:0x0000000113adcde8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/78>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 89]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 15344)


[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 78], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460] Performing ActiveStorage::PurgeJob (Job ID: 4e493809-dd95-4001-a74d-1aca5eec3460) from Async(default) enqueued at 2022-08-08T09:41:27Z with arguments: #<GlobalID:0x0000000113cfc8f8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/78>>
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 78], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 78]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 78], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mActiveStorage::Blob Destroy (0.4ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 78]]
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460]   [1m[36mTRANSACTION (17.3ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: bymkqnol1ureecq8v6nehidecjk8[0m
[ActiveJob] [ActiveStorage::PurgeJob] [4e493809-dd95-4001-a74d-1aca5eec3460] Performed ActiveStorage::PurgeJob (Job ID: 4e493809-dd95-4001-a74d-1aca5eec3460) from Async(default) in 23.08ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:12:56 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001162ae830 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-7j3miy.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"Travel"}, "date"=>"2013-10-07", "user_id"=>"67"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 5980)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:12:59 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116517068 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-3hkras.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"7", "description"=>"Travel"}, "date"=>"2013-10-07", "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", nil], ["invoice_number", 7], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:42:59.648131"], ["updated_at", "2022-08-08 09:42:59.648131"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 79]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "vdw72c46e764k9qo1o5dwjmkt8bz"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:42:59.652590"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 90], ["created_at", "2022-08-08 09:42:59.653534"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:42:59.654021"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: vdw72c46e764k9qo1o5dwjmkt8bz (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 79], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 9012c2a8-27d4-436f-9db8-8687fa4648bc) to Async(default) with arguments: #<GlobalID:0x0000000116637f38 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/79>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 90]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 88)
Completed 200 OK in 16ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 15335)


[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 79], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc] Performing ActiveStorage::PurgeJob (Job ID: 9012c2a8-27d4-436f-9db8-8687fa4648bc) from Async(default) enqueued at 2022-08-08T09:42:59Z with arguments: #<GlobalID:0x00000001166bd660 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/79>>
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 79], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 79]]
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 79], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 79]]
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc]   [1m[36mTRANSACTION (23.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: 4u837qn3z89ehxkiiwps0uvc6xdf[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9012c2a8-27d4-436f-9db8-8687fa4648bc] Performed ActiveStorage::PurgeJob (Job ID: 9012c2a8-27d4-436f-9db8-8687fa4648bc) from Async(default) in 33.27ms
Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:13:20 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011678dea0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-36fv2c.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"7", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"67"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 7], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 6024)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:13:24 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"150", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001068de170 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-e1jhue.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"8", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 8], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 150], ["date", "2013-10-07"], ["invoice_number", 8], ["status", 0], ["user_id", 67], ["created_at", "2022-08-08 09:43:24.405047"], ["updated_at", "2022-08-08 09:43:24.405047"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 8], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 80]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "hxntqjrm3xhghy3dj099rqi5t646"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:43:24.411035"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 8], ["blob_id", 91], ["created_at", "2022-08-08 09:43:24.412412"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:43:24.413599"], ["id", 8]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: hxntqjrm3xhghy3dj099rqi5t646 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 80], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a41d5561-62f9-4779-acf0-3ab934166248) to Async(default) with arguments: #<GlobalID:0x0000000110fec7f0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/80>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 91]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 95)
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 15391)


[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 80], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248] Performing ActiveStorage::PurgeJob (Job ID: a41d5561-62f9-4779-acf0-3ab934166248) from Async(default) enqueued at 2022-08-08T09:43:24Z with arguments: #<GlobalID:0x0000000113366258 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/80>>
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 80], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 80]]
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 80], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mActiveStorage::Blob Destroy (18.1ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 80]]
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 0env9hckg5jtp1o3nzo6okck4syb[0m
[ActiveJob] [ActiveStorage::PurgeJob] [a41d5561-62f9-4779-acf0-3ab934166248] Performed ActiveStorage::PurgeJob (Job ID: a41d5561-62f9-4779-acf0-3ab934166248) from Async(default) in 24.34ms
Started GET "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 15:17:03 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"65"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 1536)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:17:07 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 67]]
  ↳ app/models/user.rb:38:in `admin?'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to access_enabled? this User>
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 2863)


Started GET "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:17:15 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 67]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 67]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 3.1ms | Allocations: 2055)
Completed 200 OK in 6ms (Views: 3.2ms | ActiveRecord: 0.3ms | Allocations: 4640)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:22:21 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.4ms | Allocations: 92)
Completed 200 OK in 255ms (Views: 0.9ms | ActiveRecord: 0.3ms | Allocations: 1118)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:22:32 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 0.9ms | Allocations: 732)
Completed 200 OK in 4ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 3151)


Started POST "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:22:46 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"125", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001165064e8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-gi35th.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"9", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to create? this User>
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2327)


Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:22:54 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"125", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011650c6b8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-dnmntf.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"9", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 125], ["date", "2013-10-07"], ["invoice_number", 9], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 09:52:54.606880"], ["updated_at", "2022-08-08 09:52:54.606880"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 9], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 60]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "fizb33y7reosdm7h3wz5pivevpan"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:52:54.611568"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 9], ["blob_id", 92], ["created_at", "2022-08-08 09:52:54.613190"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:52:54.613874"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: fizb33y7reosdm7h3wz5pivevpan (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 60], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 6c5e656d-97fb-40d2-a62f-05617a13ec5b) to Async(default) with arguments: #<GlobalID:0x00000001166b7710 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/60>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 92]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 15366)


[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 60], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b] Performing ActiveStorage::PurgeJob (Job ID: 6c5e656d-97fb-40d2-a62f-05617a13ec5b) from Async(default) enqueued at 2022-08-08T09:52:54Z with arguments: #<GlobalID:0x0000000116727010 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/60>>
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 60], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 60]]
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 60], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 60]]
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b]   [1m[36mTRANSACTION (18.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b] [36m  Disk Storage (0.8ms) [0m[31mDeleted file from key: nn4r50w8r83uzfzpykit3erm2sx4[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6c5e656d-97fb-40d2-a62f-05617a13ec5b] Performed ActiveStorage::PurgeJob (Job ID: 6c5e656d-97fb-40d2-a62f-05617a13ec5b) from Async(default) in 24.67ms
Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:23:09 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000116986a90 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-f22u5b.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"10", "description"=>"Food", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 10], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 09:53:09.651930"], ["updated_at", "2022-08-08 09:53:09.651930"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 10], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 61]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ak7lfy0rim2alaoxuo3mvognvjo5"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:53:09.656638"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 10], ["blob_id", 93], ["created_at", "2022-08-08 09:53:09.657436"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:53:09.658128"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.4ms) [0m[32mUploaded file to key: ak7lfy0rim2alaoxuo3mvognvjo5 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 3895c7e9-c949-421a-baf3-1a3ec667212c) to Async(default) with arguments: #<GlobalID:0x0000000110d85ea8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/61>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.3ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 93]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 15352)


[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 61], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c] Performing ActiveStorage::PurgeJob (Job ID: 3895c7e9-c949-421a-baf3-1a3ec667212c) from Async(default) enqueued at 2022-08-08T09:53:09Z with arguments: #<GlobalID:0x0000000111037160 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/61>>
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 61], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 61]]
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 61], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 61]]
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: xa8ou054wag2krapyvk9kewqn9e7[0m
[ActiveJob] [ActiveStorage::PurgeJob] [3895c7e9-c949-421a-baf3-1a3ec667212c] Performed ActiveStorage::PurgeJob (Job ID: 3895c7e9-c949-421a-baf3-1a3ec667212c) from Async(default) in 25.21ms
Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:23:41 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001133dc9a8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-whnsfz.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"11", "description"=>"Food", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 11], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 11], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 09:53:41.463047"], ["updated_at", "2022-08-08 09:53:41.463047"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 11], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 62]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "ii1o7nwo8u54gtk81u3jch5e5u2p"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 09:53:41.467044"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 11], ["blob_id", 94], ["created_at", "2022-08-08 09:53:41.467956"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 09:53:41.468463"], ["id", 11]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.5ms) [0m[32mUploaded file to key: ii1o7nwo8u54gtk81u3jch5e5u2p (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: b434d273-6250-4884-82e1-8d1047faad7e) to Async(default) with arguments: #<GlobalID:0x0000000113c95c48 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/62>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 94]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.4ms | Allocations: 244)
Completed 200 OK in 16ms (Views: 1.2ms | ActiveRecord: 2.3ms | Allocations: 15952)


[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 62], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e] Performing ActiveStorage::PurgeJob (Job ID: b434d273-6250-4884-82e1-8d1047faad7e) from Async(default) enqueued at 2022-08-08T09:53:41Z with arguments: #<GlobalID:0x000000011626f9f0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/62>>
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 62], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 62]]
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 62], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 62]]
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e]   [1m[36mTRANSACTION (17.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e] [36m  Disk Storage (1.0ms) [0m[31mDeleted file from key: 01cpvj8kmes0ic4wbes0ge15m37l[0m
[ActiveJob] [ActiveStorage::PurgeJob] [b434d273-6250-4884-82e1-8d1047faad7e] Performed ActiveStorage::PurgeJob (Job ID: b434d273-6250-4884-82e1-8d1047faad7e) from Async(default) in 24.45ms
Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:24:01 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 1316)
Completed 200 OK in 4ms (Views: 1.8ms | ActiveRecord: 0.5ms | Allocations: 3981)


Started GET "/api/v1/expense_tracker/users/65/expenses" for 127.0.0.1 at 2022-08-08 15:24:24 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"65"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 1543)


Started GET "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:24:28 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to access_enabled? this User>
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 2856)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:24:32 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.0ms | Allocations: 1203)
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 3637)


Started PATCH "/api/v1/expense_tracker/users/66/expenses/1" for 127.0.0.1 at 2022-08-08 15:25:46 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>110}, "user_id"=>"66", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
Completed 404 Not Found in 4ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 4609)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:25:54 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.0ms | Allocations: 1203)
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 3641)


Started PATCH "/api/v1/expense_tracker/users/66/expenses/9" for 127.0.0.1 at 2022-08-08 15:26:01 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>110}, "user_id"=>"66", "id"=>"9"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :status, :approved_amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000011692dee0>, params: {"expense"=>{"status"=>"approved", "approved_amount"=>110}, "controller"=>"expenses", "action"=>"update", "user_id"=>"66", "id"=>"9"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 9], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.8ms | Allocations: 259)
Completed 200 OK in 18ms (Views: 1.1ms | ActiveRecord: 0.4ms | Allocations: 14483)


Started PATCH "/api/v1/expense_tracker/users/66/expenses/9" for 127.0.0.1 at 2022-08-08 15:26:33 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>130}, "user_id"=>"66", "id"=>"9"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x000000011108e460>, params: {"expense"=>{"status"=>"submitted", "amount"=>130}, "controller"=>"expenses", "action"=>"update", "user_id"=>"66", "id"=>"9"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 9], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (3.3ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 130], ["status", 4], ["updated_at", "2022-08-08 09:56:34.393284"], ["id", 9]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 243)
  Rendered layout layouts/mailer.text.erb (Duration: 0.9ms | Allocations: 467)
UserMailer#expense_update: processed outbound mail in 2.5ms
Delivered mail 62f0ddd2620e2_17b6bf21c7004d@CALTM00564.local.mail (3096.3ms)
Date: Mon, 08 Aug 2022 15:26:34 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0ddd2620e2_17b6bf21c7004d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 9
expense status: rejected
expense amount: 130
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.7ms | Allocations: 156)
Completed 200 OK in 4189ms (Views: 1.7ms | ActiveRecord: 4.7ms | Allocations: 22872)


Started POST "/api/v1/expense_tracker/users/66/expenses/9/comments" for 127.0.0.1 at 2022-08-08 15:28:02 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"Process this request as soon as possible", "user_id"=>"66", "expense_id"=>"9"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001162a6220>, params: {"comment"=>"Process this request as soon as possible", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"66", "expense_id"=>"9"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Process this request as soon as possible"], ["commentable_type", "Expense"], ["commentable_id", 9], ["user_id", 66], ["created_at", "2022-08-08 09:58:02.854680"], ["updated_at", "2022-08-08 09:58:02.854680"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.6ms | Allocations: 179)
  Rendered layout layouts/mailer.text.erb (Duration: 0.7ms | Allocations: 283)
UserMailer#notify_comment: processed outbound mail in 1.3ms
Delivered mail 62f0de2ad1ca9_17b6bf23070122@CALTM00564.local.mail (2893.5ms)
Date: Mon, 08 Aug 2022 15:28:02 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0de2ad1ca9_17b6bf23070122@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: Process this request as soon as possible
commented at: 2022-08-08 09:58:02 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 2.9ms | Allocations: 218)
Completed 200 OK in 2908ms (Views: 6.0ms | ActiveRecord: 1.3ms | Allocations: 9912)


Started PATCH "/api/v1/expense_tracker/users/66/expenses/10" for 127.0.0.1 at 2022-08-08 15:29:08 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>130}, "user_id"=>"66", "id"=>"10"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.5ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 10], ["biller", "Centimia"], ["created_at", "2022-08-08 09:59:10.971401"], ["updated_at", "2022-08-08 09:59:10.971401"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001165149d0>, params: {"expense"=>{"status"=>"submitted", "amount"=>130}, "controller"=>"expenses", "action"=>"update", "user_id"=>"66", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 10], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 130], ["status", 2], ["updated_at", "2022-08-08 09:59:10.978138"], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.3ms | Allocations: 155)
Completed 200 OK in 2267ms (Views: 0.8ms | ActiveRecord: 3.9ms | Allocations: 20408)


Started POST "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:29:19 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"Process this request as soon as possible", "user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x000000011692d4e0>, params: {"comment"=>"Process this request as soon as possible", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"66", "expense_id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Process this request as soon as possible"], ["commentable_type", "Expense"], ["commentable_id", 10], ["user_id", 66], ["created_at", "2022-08-08 09:59:19.270518"], ["updated_at", "2022-08-08 09:59:19.270518"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 132)
UserMailer#notify_comment: processed outbound mail in 1.3ms
Delivered mail 62f0de7746871_17b6bf258702c2@CALTM00564.local.mail (2756.2ms)
Date: Mon, 08 Aug 2022 15:29:19 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0de7746871_17b6bf258702c2@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: Process this request as soon as possible
commented at: 2022-08-08 09:59:19 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 0.6ms | Allocations: 91)
Completed 200 OK in 2781ms (Views: 1.5ms | ActiveRecord: 1.5ms | Allocations: 9265)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:29:39 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 1.2ms | Allocations: 231)
Completed 200 OK in 254ms (Views: 1.8ms | ActiveRecord: 0.1ms | Allocations: 1573)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:30:08 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.1ms | Allocations: 1235)
Completed 200 OK in 5ms (Views: 1.3ms | ActiveRecord: 0.8ms | Allocations: 3864)


Started GET "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:30:13 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 67]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.5ms | Allocations: 1898)
Completed 200 OK in 4ms (Views: 1.6ms | ActiveRecord: 0.3ms | Allocations: 4351)


Started PATCH "/api/v1/expense_tracker/users/66/expenses/10" for 127.0.0.1 at 2022-08-08 15:30:48 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>130, "approved_amount"=>70}, "user_id"=>"66", "id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001137cdd00>, params: {"expense"=>{"status"=>"approved", "amount"=>130, "approved_amount"=>70}, "controller"=>"expenses", "action"=>"update", "user_id"=>"66", "id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 10], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 10:00:48.369402"], ["approved_amount", 70], ["id", 10]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 21)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 127)
UserMailer#expense_update: processed outbound mail in 0.9ms
Delivered mail 62f0ded05afb3_17b6bf2447037d@CALTM00564.local.mail (2803.9ms)
Date: Mon, 08 Aug 2022 15:30:48 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0ded05afb3_17b6bf2447037d@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 10
expense status: approved
expense amount: 130
approved amount: 70.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.6ms | Allocations: 121)
Completed 200 OK in 2816ms (Views: 1.9ms | ActiveRecord: 1.0ms | Allocations: 12605)


Started GET "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:31:44 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 10], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 29]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 2.2ms | Allocations: 1711)
Completed 200 OK in 5ms (Views: 2.3ms | ActiveRecord: 0.7ms | Allocations: 3213)


Started POST "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:32:35 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"Thanks for your patience, yor request has been processed", "user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x0000000116329990>, params: {"comment"=>"Thanks for your patience, yor request has been processed", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"66", "expense_id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.7ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Thanks for your patience, yor request has been processed"], ["commentable_type", "Expense"], ["commentable_id", 10], ["user_id", 68], ["created_at", "2022-08-08 10:02:35.406103"], ["updated_at", "2022-08-08 10:02:35.406103"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 130)
UserMailer#notify_comment: processed outbound mail in 3.1ms
Delivered mail 62f0df3b656d7_17b6bf2307044@CALTM00564.local.mail (2902.8ms)
Date: Mon, 08 Aug 2022 15:32:35 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0df3b656d7_17b6bf2307044@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: Thanks for your patience, yor request has been processed
commented at: 2022-08-08 10:02:35 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 0.9ms | Allocations: 88)
Completed 200 OK in 2918ms (Views: 2.0ms | ActiveRecord: 1.3ms | Allocations: 8996)


Started GET "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:32:43 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 10], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 29]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 30]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 1.9ms | Allocations: 2333)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.3ms | Allocations: 3733)


Started POST "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:33:13 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"Thanks for your patience, yor request has been processed", "parent_id"=>29, "user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x000000011668fe40>, params: {"comment"=>"Thanks for your patience, yor request has been processed", "parent_id"=>29, "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"66", "expense_id"=>"10"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.7ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "Thanks for your patience, yor request has been processed"], ["commentable_type", "Expense"], ["commentable_id", 10], ["user_id", 68], ["created_at", "2022-08-08 10:03:13.506326"], ["updated_at", "2022-08-08 10:03:13.506326"], ["parent_id", 29]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 23)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 127)
UserMailer#notify_comment: processed outbound mail in 0.9ms
Delivered mail 62f0df617cba8_17b6bf258705b6@CALTM00564.local.mail (3139.1ms)
Date: Mon, 08 Aug 2022 15:33:13 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0df617cba8_17b6bf258705b6@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: Thanks for your patience, yor request has been processed
commented at: 2022-08-08 10:03:13 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 0.4ms | Allocations: 87)
Completed 200 OK in 3150ms (Views: 2.6ms | ActiveRecord: 1.5ms | Allocations: 8998)


Started GET "/api/v1/expense_tracker/users/66/expenses/10/comments" for 127.0.0.1 at 2022-08-08 15:33:20 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"66", "expense_id"=>"10"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 10], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 29]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 30]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 31]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 5.9ms | Allocations: 3251)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.2ms | Allocations: 4640)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:33:45 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 91)
Completed 200 OK in 256ms (Views: 1.3ms | ActiveRecord: 0.1ms | Allocations: 1121)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:34:09 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 6388)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:34:25 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[9, 10, 11], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 9], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 10], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 9 is already mapped or processed report 
expense 10 is already mapped or processed report 
  [1m[36mReport Create (0.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-08 10:04:25.820715"], ["updated_at", "2022-08-08 10:04:25.820715"], ["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:04:25.825347"], ["report_id", 1], ["id", 11]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 0.7ms | Allocations: 339)
Completed 200 OK in 15ms (Views: 1.3ms | ActiveRecord: 1.9ms | Allocations: 11706)


Started GET "/api/v1/expense_tracker/users/66/reports/1" for 127.0.0.1 at 2022-08-08 15:34:46 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 2.2ms | Allocations: 1860)
Completed 200 OK in 8ms (Views: 2.4ms | ActiveRecord: 1.2ms | Allocations: 5560)


Started PATCH "/api/v1/expense_tracker/users/65/reports/1" for 127.0.0.1 at 2022-08-08 15:34:52 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"65", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 1653)


Started PATCH "/api/v1/expense_tracker/users/66/reports/1" for 127.0.0.1 at 2022-08-08 15:34:58 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"66", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001165541e8>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:37:in `submit_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:37:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 11], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.7ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 10:04:59.904317"], ["id", 11]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.1ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 10:04:58.849459"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 8.2ms | Allocations: 301)
Completed 200 OK in 1082ms (Views: 8.8ms | ActiveRecord: 3.3ms | Allocations: 19589)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:37:17 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[12, 13, 14], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
Completed 400 Bad Request in 40ms (Views: 0.1ms | ActiveRecord: 1.1ms | Allocations: 3522)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:37:26 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[12, 13], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
Completed 400 Bad Request in 3ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 3463)


Started GET "/api/v1/expense_tracker/users/67/expenses" for 127.0.0.1 at 2022-08-08 15:37:36 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"67"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 67], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
User is not active or logged in #<Pundit::NotAuthorizedError: not allowed to access_enabled? this User>
Completed 403 Forbidden in 4ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 2860)


Started GET "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:37:42 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 0.8ms | Allocations: 1210)
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 3655)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:37:55 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[12, 11], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 11 is already mapped or processed report 1
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 6071)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:38:04 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[11], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 11], ["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 11 is already mapped or processed report 1
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 6050)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:38:12 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[10], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 10], ["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 10 is already mapped or processed report 
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
Completed 400 Bad Request in 6ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 6054)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:38:18 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[9], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 9], ["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 9 is already mapped or processed report 
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
Completed 400 Bad Request in 5ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 6058)


Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:38:48 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[16, 78], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
Completed 400 Bad Request in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 3451)


Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:39:06 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x00000001165a6d80 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-ps0wag.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"12", "description"=>"Food1", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food1"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 12], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 10:09:06.499630"], ["updated_at", "2022-08-08 10:09:06.499630"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 12], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 63]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "mrkrpavsjqqhl6ktt78juwcijshm"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 10:09:06.504064"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 12], ["blob_id", 95], ["created_at", "2022-08-08 10:09:06.505196"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:09:06.505683"], ["id", 12]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: mrkrpavsjqqhl6ktt78juwcijshm (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 9020d92b-4bd2-4182-9c1b-8997b7e317fa) to Async(default) with arguments: #<GlobalID:0x000000011672d1e0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/63>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 95]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 100)
Completed 200 OK in 22ms (Views: 2.8ms | ActiveRecord: 2.4ms | Allocations: 15534)


[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 63], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa] Performing ActiveStorage::PurgeJob (Job ID: 9020d92b-4bd2-4182-9c1b-8997b7e317fa) from Async(default) enqueued at 2022-08-08T10:09:06Z with arguments: #<GlobalID:0x00000001167c47e8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/63>>
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 63], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 63]]
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 63], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mActiveStorage::Blob Destroy (17.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 63]]
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa]   [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa] [36m  Disk Storage (0.9ms) [0m[31mDeleted file from key: snutgrdfimptc0kbw307t0ec6ox7[0m
[ActiveJob] [ActiveStorage::PurgeJob] [9020d92b-4bd2-4182-9c1b-8997b7e317fa] Performed ActiveStorage::PurgeJob (Job ID: 9020d92b-4bd2-4182-9c1b-8997b7e317fa) from Async(default) in 25.53ms
Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:39:41 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000107d1e040 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-o45gwl.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"12", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 12], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
Errors found with expense: , exception ["Invoice number has already been taken"]
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 6048)


Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:39:47 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000110af96f8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-jkgw4l.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"13", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 13], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 13], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 10:09:47.726917"], ["updated_at", "2022-08-08 10:09:47.726917"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 13], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 64]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "dh2b85jegiantkycz2vscad8ypuh"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 10:09:47.731261"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 13], ["blob_id", 96], ["created_at", "2022-08-08 10:09:47.732933"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:09:47.735825"], ["id", 13]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: dh2b85jegiantkycz2vscad8ypuh (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: e8f983a4-c0b9-4804-80e2-4db724c6c65f) to Async(default) with arguments: #<GlobalID:0x00000001137e5838 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/64>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 96]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 99)
Completed 200 OK in 21ms (Views: 0.5ms | ActiveRecord: 2.5ms | Allocations: 15383)


[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 64], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f] Performing ActiveStorage::PurgeJob (Job ID: e8f983a4-c0b9-4804-80e2-4db724c6c65f) from Async(default) enqueued at 2022-08-08T10:09:47Z with arguments: #<GlobalID:0x0000000113c87fd0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/64>>
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 64], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 64]]
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 64], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 64]]
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f]   [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f] [36m  Disk Storage (1.0ms) [0m[31mDeleted file from key: 4yvwci6rer8g12tomrlnlr36bgu3[0m
[ActiveJob] [ActiveStorage::PurgeJob] [e8f983a4-c0b9-4804-80e2-4db724c6c65f] Performed ActiveStorage::PurgeJob (Job ID: e8f983a4-c0b9-4804-80e2-4db724c6c65f) from Async(default) in 10.28ms
Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 15:39:55 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011625d048 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-97131-xsjwru.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"14", "description"=>"Travel1", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 14], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel1"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 14], ["status", 0], ["user_id", 66], ["created_at", "2022-08-08 10:09:55.472474"], ["updated_at", "2022-08-08 10:09:55.472474"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 14], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 65]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "fvtubfi70xyqjy2tx2llzmgiutdm"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 10:09:55.477019"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 14], ["blob_id", 97], ["created_at", "2022-08-08 10:09:55.478045"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:09:55.478664"], ["id", 14]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: fvtubfi70xyqjy2tx2llzmgiutdm (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 823b013c-2426-4bab-841c-7e1560f29eaf) to Async(default) with arguments: #<GlobalID:0x000000011652de58 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/65>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 97]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 99)
Completed 200 OK in 18ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 15393)


[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 65], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf] Performing ActiveStorage::PurgeJob (Job ID: 823b013c-2426-4bab-841c-7e1560f29eaf) from Async(default) enqueued at 2022-08-08T10:09:55Z with arguments: #<GlobalID:0x00000001165bc310 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/65>>
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 65], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 65]]
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 65], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 65]]
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf]   [1m[36mTRANSACTION (17.0ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 7eqm51zbqysciz4ybjmksv9abxi3[0m
[ActiveJob] [ActiveStorage::PurgeJob] [823b013c-2426-4bab-841c-7e1560f29eaf] Performed ActiveStorage::PurgeJob (Job ID: 823b013c-2426-4bab-841c-7e1560f29eaf) from Async(default) in 23.09ms
Started POST "/api/v1/expense_tracker/users/66/reports" for 127.0.0.1 at 2022-08-08 15:40:07 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[12, 13, 14], "user_id"=>"66", "report"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 12], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 13], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 14], ["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mReport Create (0.4ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-08 10:10:07.368099"], ["updated_at", "2022-08-08 10:10:07.368099"], ["user_id", 66]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 12], ["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:10:07.370123"], ["report_id", 2], ["id", 12]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 13], ["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:10:07.372042"], ["report_id", 2], ["id", 13]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 14], ["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 10:10:07.373283"], ["report_id", 2], ["id", 14]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 0.4ms | Allocations: 271)
Completed 200 OK in 13ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 14905)


Started PATCH "/api/v1/expense_tracker/users/66/reports/1" for 127.0.0.1 at 2022-08-08 15:40:40 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"66", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, report is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Report>
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 0.9ms | Allocations: 5179)


Started GET "/api/v1/expense_tracker/users/66/reports/1" for 127.0.0.1 at 2022-08-08 15:40:52 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.0ms | Allocations: 869)
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 0.6ms | Allocations: 4184)


Started GET "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:40:59 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.6ms | Allocations: 1020)
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 4300)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:41:14 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"66", "id"=>"2", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 66]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001133ce498>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:37:in `submit_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:37:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 12], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 10:11:16.202030"], ["id", 12]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 13], ["id", 13], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 10:11:17.328314"], ["id", 13]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mUser Load (3.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 14], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 10:11:18.152909"], ["id", 14]]
  ↳ app/models/report.rb:40:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.2ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 10:11:14.371044"], ["id", 2]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 0.5ms | Allocations: 274)
Completed 200 OK in 3793ms (Views: 0.9ms | ActiveRecord: 7.8ms | Allocations: 21259)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:41:42 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 256ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1118)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:43:02 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 12], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 10:13:02.919573"], ["approved_amount", 250], ["id", 12]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 14], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Update (0.2ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 10:13:02.925339"], ["id", 14]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
 actions other than processed are restricted: 2
Completed 403 Forbidden in 33ms (Views: 0.7ms | ActiveRecord: 4.3ms | Allocations: 13593)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 15:43:42 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 91)
Completed 200 OK in 257ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1117)


Started GET "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:43:54 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.1ms | Allocations: 1020)
Completed 200 OK in 5ms (Views: 1.4ms | ActiveRecord: 0.9ms | Allocations: 4343)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:44:02 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
 actions other than processed are restricted: 2
Completed 403 Forbidden in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 5693)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:45:04 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000113a3cd70>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mReport Update (0.3ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 10:15:04.384181"], ["id", 2]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 1.7ms
Completed 500 Internal Server Error in 44ms (Views: 0.1ms | ActiveRecord: 8.7ms | Allocations: 31861)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:46:11 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (3.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001133c5988>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 1.6ms
Completed 500 Internal Server Error in 51ms (ActiveRecord: 5.4ms | Allocations: 34123)


  
NameError (undefined local variable or method `e' for #<ReportsController:0x00000000033d88>

    logger.error("error #{e.inspect}")
                          ^):
  
app/controllers/application_controller.rb:30:in `error_response_handler'
Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:46:27 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000117514d08>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 1.4ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 26ms (Views: 0.1ms | ActiveRecord: 2.3ms | Allocations: 31125)


Started GET "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:47:37 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 0.8ms | Allocations: 1216)
Completed 200 OK in 5ms (Views: 1.3ms | ActiveRecord: 0.3ms | Allocations: 5452)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:48:11 +0530
  [1m[35m (1.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:47:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010cd8d008>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (2.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 10654.4ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 59375ms (Views: 2.0ms | ActiveRecord: 25.0ms | Allocations: 148803)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:49:16 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.7ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x00000001099b7d78>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.8ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 25901.3ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 38602ms (Views: 2.1ms | ActiveRecord: 27.3ms | Allocations: 132954)


Started GET "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:51:05 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"66", "id"=>"2", "report"=>{}}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 66], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 117.5ms | Allocations: 8339)
Completed 200 OK in 346ms (Views: 123.6ms | ActiveRecord: 16.6ms | Allocations: 24738)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:51:29 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.6ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e97e140>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 3463.4ms
error #<NameError: undefined local variable or method `amount' for #<Report id: 2, status: "processed", created_at: "2022-08-08 10:10:07.368099000 +0000", updated_at: "2022-08-08 10:15:04.384181000 +0000", user_id: 66>>
Completed 500 Internal Server Error in 65042ms (Views: 1.9ms | ActiveRecord: 10.2ms | Allocations: 126731)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:52:37 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e46d548>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 2363.8ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 30957ms (Views: 1.9ms | ActiveRecord: 24.8ms | Allocations: 132830)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:53:13 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.5ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e655cc0>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 36307.8ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 142941ms (Views: 1.6ms | ActiveRecord: 24.5ms | Allocations: 128641)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:55:38 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e93ce98>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 38271.5ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 59654ms (Views: 1.1ms | ActiveRecord: 23.5ms | Allocations: 169167)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:56:43 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010db567e8>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 6138.9ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 11953ms (Views: 1.6ms | ActiveRecord: 21.7ms | Allocations: 158483)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:57:58 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e9a6c30>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
UserMailer#report_update: processed outbound mail in 15406.0ms
error #<TypeError: nil can't be coerced into Integer>
Completed 500 Internal Server Error in 68053ms (Views: 2.3ms | ActiveRecord: 23.7ms | Allocations: 172961)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 15:59:12 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.8ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.8ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e65fc20>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 5069.9ms | Allocations: 50507)
  Rendered layout layouts/mailer.text.erb (Duration: 5072.8ms | Allocations: 50617)
UserMailer#report_update: processed outbound mail in 12873.1ms
error #<ActionView::Template::Error: undefined method `approved_amount' for #<Report id: 2, status: "processed", created_at: "2022-08-08 10:10:07.368099000 +0000", updated_at: "2022-08-08 10:15:04.384181000 +0000", user_id: 66>>
Completed 500 Internal Server Error in 31385ms (Views: 2.5ms | ActiveRecord: 22.5ms | Allocations: 227562)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 16:01:43 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.9ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:50:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e946060>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1992.1ms | Allocations: 29872)
  Rendered layout layouts/mailer.text.erb (Duration: 2000.4ms | Allocations: 30151)
UserMailer#report_update: processed outbound mail in 7642.0ms
Delivered mail 62f0e61c9b0ed_1171af4b0-4be@CALTM00564.local.mail (3493.8ms)
Date: Mon, 08 Aug 2022 16:01:56 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0e61c9b0ed_1171af4b0-4be@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

email: kasi@mail.com

expense status: processed
expense amount: 1500
approved amount: .


have a great day!

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 11.5ms | Allocations: 427)
Completed 200 OK in 17012ms (Views: 21.1ms | ActiveRecord: 8.5ms | Allocations: 180297)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 16:03:24 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.9ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (1.2ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:51:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010d9b4480>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 11191.3ms | Allocations: 51768)
  Rendered layout layouts/mailer.text.erb (Duration: 11197.2ms | Allocations: 51898)
UserMailer#report_update: processed outbound mail in 69446.3ms
Delivered mail 62f0e6c231ad5_1171af4c4-31c@CALTM00564.local.mail (3079.9ms)
Date: Mon, 08 Aug 2022 16:04:42 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0e6c231ad5_1171af4c4-31c@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

email: kasi@mail.com

expense status: processed
expense amount: 1500
approved amount: .


have a great day!

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 11.3ms | Allocations: 327)
Completed 200 OK in 77869ms (Views: 22.5ms | ActiveRecord: 23.0ms | Allocations: 263963)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 16:04:48 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (1.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.3ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:52:in `block in update_dependent_expense'
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:52:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e466f40>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (2.7ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 14905.8ms | Allocations: 96144)
  Rendered layout layouts/mailer.text.erb (Duration: 14912.6ms | Allocations: 96273)
UserMailer#report_update: processed outbound mail in 74138.0ms
Delivered mail 62f0e71deac75_1171af4d8-262@CALTM00564.local.mail (2981.3ms)
Date: Mon, 08 Aug 2022 16:06:13 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0e71deac75_1171af4d8-262@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

email: kasi@mail.com

expense status: processed
expense amount: 1500
approved amount: 250.


have a great day!

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 12.5ms | Allocations: 327)
Completed 200 OK in 85050ms (Views: 23.5ms | ActiveRecord: 27.3ms | Allocations: 394412)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 16:06:57 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "user_id"=>"66", "id"=>"2"}
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 68], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 68]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 12], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 2], ["id", 14], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x000000010e336b20>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>12, "status"=>"approved", "approved_amount"=>250}, {"id"=>14, "status"=>"rejected"}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"66", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 2]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 35)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 151)
UserMailer#report_update: processed outbound mail in 2.4ms
Delivered mail 62f0e74fbfdb5_1171af4ec-125@CALTM00564.local.mail (2836.9ms)
Date: Mon, 08 Aug 2022 16:07:03 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0e74fbfdb5_1171af4ec-125@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

email: kasi@mail.com

expense status: processed
expense amount: 1500
approved amount: 250.


have a great day!

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 0.8ms | Allocations: 358)
Completed 200 OK in 2885ms (Views: 3.6ms | ActiveRecord: 3.1ms | Allocations: 35294)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 16:46:23 +0530
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x000000011938d5f0>, params: {"user"=>{"email"=>"admin@mail.com", "name"=>"admin", "department"=>"Engineering", "roles"=>["basic", "admin"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "admin"], ["department", "Engineering"], ["status", 1], ["email", "admin@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 11:16:24.126614"], ["updated_at", "2022-08-08 11:16:24.126614"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 69], ["created_at", "2022-08-08 11:16:24.136419"], ["updated_at", "2022-08-08 11:16:24.136419"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 1], ["user_id", 69], ["created_at", "2022-08-08 11:16:24.138538"], ["updated_at", "2022-08-08 11:16:24.138538"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.8ms | Allocations: 2528)
Completed 201 Created in 271ms (Views: 4.7ms | ActiveRecord: 3.2ms | Allocations: 25475)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 16:46:45 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000119d255e0>, params: {"user"=>{"email"=>"kasi@mail.com", "name"=>"kasi", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "kasi"], ["department", "Engineering"], ["status", 1], ["email", "kasi@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 11:16:45.359224"], ["updated_at", "2022-08-08 11:16:45.359224"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.3ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 70], ["created_at", "2022-08-08 11:16:45.363190"], ["updated_at", "2022-08-08 11:16:45.363190"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 1.5ms | Allocations: 1140)
Completed 201 Created in 267ms (Views: 2.4ms | ActiveRecord: 3.1ms | Allocations: 7014)


Started POST "/api/v1/expense_tracker/user/onboard" for 127.0.0.1 at 2022-08-08 16:46:55 +0530
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"krishna@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}}
[31mUnpermitted parameter: :roles. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x0000000119dd5710>, params: {"user"=>{"email"=>"krishna@mail.com", "name"=>"krishna", "department"=>"Engineering", "roles"=>["basic"]}, "controller"=>"users", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "krishna@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "department", "status", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "krishna"], ["department", "Engineering"], ["status", 1], ["email", "krishna@mail.com"], ["password_digest", "[FILTERED]"], ["created_at", "2022-08-08 11:16:55.532990"], ["updated_at", "2022-08-08 11:16:55.532990"]]
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:8:in `create'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mUserRole Create (0.2ms)[0m  [1m[32mINSERT INTO "user_roles" ("role", "user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["role", 0], ["user_id", 71], ["created_at", "2022-08-08 11:16:55.535755"], ["updated_at", "2022-08-08 11:16:55.535755"]]
  ↳ app/models/user.rb:29:in `block in add_roles'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/user.rb:29:in `block in add_roles'
  Rendering users/create.jbuilder
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 71]]
  ↳ app/views/users/create.jbuilder:3
  Rendered users/create.jbuilder (Duration: 0.8ms | Allocations: 854)
Completed 201 Created in 256ms (Views: 1.0ms | ActiveRecord: 2.4ms | Allocations: 6173)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 16:47:06 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.7ms | Allocations: 279)
Completed 200 OK in 254ms (Views: 1.3ms | ActiveRecord: 0.3ms | Allocations: 2266)


Started POST "/api/v1/expense_tracker/users/66/expenses" for 127.0.0.1 at 2022-08-08 16:47:26 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010e0f9bf0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-7qedf0.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"Other", "date"=>"2013-10-07"}, "user_id"=>"66"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
error #<ActiveRecord::RecordNotFound: Couldn't find User with 'id'=66>
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.1ms | Allocations: 2464)


Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:47:44 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"500", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000010f2aab38 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-xj0fma.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"1", "description"=>"Other", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Other"], ["amount", 500], ["date", "2013-10-07"], ["invoice_number", 1], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:17:44.172221"], ["updated_at", "2022-08-08 11:17:44.172221"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 84]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "1stlo7r35ff1zwov4h1q6izrcgo4"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:17:44.184521"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 1], ["blob_id", 98], ["created_at", "2022-08-08 11:17:44.185497"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:17:44.186049"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 1stlo7r35ff1zwov4h1q6izrcgo4 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 84], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 47cece02-fcc0-4e3b-86b3-143b97b0be0b) to Async(default) with arguments: #<GlobalID:0x0000000119a4e6a0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/84>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 98]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.5ms | Allocations: 291)
Completed 200 OK in 50ms (Views: 1.0ms | ActiveRecord: 3.3ms | Allocations: 53073)


[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 84], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b] Performing ActiveStorage::PurgeJob (Job ID: 47cece02-fcc0-4e3b-86b3-143b97b0be0b) from Async(default) enqueued at 2022-08-08T11:17:44Z with arguments: #<GlobalID:0x0000000119b05e18 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/84>>
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 84], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 84]]
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 84], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 84]]
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b]   [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 6h9r387t1wjv5wwr4hkmm01n5dhh[0m
[ActiveJob] [ActiveStorage::PurgeJob] [47cece02-fcc0-4e3b-86b3-143b97b0be0b] Performed ActiveStorage::PurgeJob (Job ID: 47cece02-fcc0-4e3b-86b3-143b97b0be0b) from Async(default) in 35.68ms
Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:48:07 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"250", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000119d5fec0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-vrwjtm.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"2", "description"=>"Food", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.5ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Food"], ["amount", 250], ["date", "2013-10-07"], ["invoice_number", 2], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:18:08.006914"], ["updated_at", "2022-08-08 11:18:08.006914"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 85]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "8lqfp85rd0d7tju0jstprirg14he"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:18:08.010734"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 2], ["blob_id", 99], ["created_at", "2022-08-08 11:18:08.011676"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:18:08.012185"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: 8lqfp85rd0d7tju0jstprirg14he (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 85], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b) to Async(default) with arguments: #<GlobalID:0x0000000119f3ca90 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/85>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 99]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 114)
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 15728)


[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 85], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b] Performing ActiveStorage::PurgeJob (Job ID: 2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b) from Async(default) enqueued at 2022-08-08T11:18:08Z with arguments: #<GlobalID:0x000000010c559ad0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/85>>
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 85], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 85]]
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 85], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mActiveStorage::Blob Destroy (0.4ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 85]]
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b]   [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: vqaj08btegkcytw8dd4ghmlzyv4w[0m
[ActiveJob] [ActiveStorage::PurgeJob] [2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b] Performed ActiveStorage::PurgeJob (Job ID: 2a6ff6ce-f2a5-4aa4-a344-8b55bea22c9b) from Async(default) in 23.39ms
Started GET "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:48:48 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"70"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.7ms | Allocations: 2140)
Completed 200 OK in 5ms (Views: 1.8ms | ActiveRecord: 0.6ms | Allocations: 4976)


Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:49:41 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"100", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011900c1b0 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-jouf6w.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"3", "description"=>"miscellaneous", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 3], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "miscellaneous"], ["amount", 100], ["date", "2013-10-07"], ["invoice_number", 3], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:19:41.906871"], ["updated_at", "2022-08-08 11:19:41.906871"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 3], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 86]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "199yfmwu8jieic6tpbtiddxe99yl"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:19:41.910585"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 3], ["blob_id", 100], ["created_at", "2022-08-08 11:19:41.911734"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:19:41.912320"], ["id", 3]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 199yfmwu8jieic6tpbtiddxe99yl (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 86], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 97b9b230-d5de-4783-be07-f6ac37914daa) to Async(default) with arguments: #<GlobalID:0x00000001194444a8 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/86>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 100]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.3ms | Allocations: 103)
Completed 200 OK in 15ms (Views: 0.6ms | ActiveRecord: 2.3ms | Allocations: 15609)


[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 86], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa] Performing ActiveStorage::PurgeJob (Job ID: 97b9b230-d5de-4783-be07-f6ac37914daa) from Async(default) enqueued at 2022-08-08T11:19:41Z with arguments: #<GlobalID:0x00000001194eea48 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/86>>
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 86], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 86]]
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 86], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 86]]
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa]   [1m[36mTRANSACTION (17.2ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa] [36m  Disk Storage (0.4ms) [0m[31mDeleted file from key: luendmjyjsi9pefl8k1yarklc2fk[0m
[ActiveJob] [ActiveStorage::PurgeJob] [97b9b230-d5de-4783-be07-f6ac37914daa] Performed ActiveStorage::PurgeJob (Job ID: 97b9b230-d5de-4783-be07-f6ac37914daa) from Async(default) in 22.6ms
Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:50:19 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"1000", "document"=>#<ActionDispatch::Http::UploadedFile:0x000000011996d420 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-3l8y5t.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"4", "description"=>"Rental", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 4], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Rental"], ["amount", 1000], ["date", "2013-10-07"], ["invoice_number", 4], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:20:19.308253"], ["updated_at", "2022-08-08 11:20:19.308253"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 4], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 87]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "rz387mg8zzs00eka9eak0kywo0h5"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:20:19.311689"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 4], ["blob_id", 101], ["created_at", "2022-08-08 11:20:19.312487"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:20:19.312955"], ["id", 4]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.3ms) [0m[32mUploaded file to key: rz387mg8zzs00eka9eak0kywo0h5 (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 87], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: f748d615-4dbc-413b-b031-138be4c486ec) to Async(default) with arguments: #<GlobalID:0x0000000119aa4a78 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/87>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 101]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 100)
Completed 200 OK in 14ms (Views: 0.5ms | ActiveRecord: 2.5ms | Allocations: 15362)


[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 87], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec] Performing ActiveStorage::PurgeJob (Job ID: f748d615-4dbc-413b-b031-138be4c486ec) from Async(default) enqueued at 2022-08-08T11:20:19Z with arguments: #<GlobalID:0x0000000119b9fb08 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/87>>
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 87], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 87]]
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 87], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 87]]
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec]   [1m[36mTRANSACTION (17.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: 27k1txrqgnoy34pgmgt7rrfski0c[0m
[ActiveJob] [ActiveStorage::PurgeJob] [f748d615-4dbc-413b-b031-138be4c486ec] Performed ActiveStorage::PurgeJob (Job ID: f748d615-4dbc-413b-b031-138be4c486ec) from Async(default) in 23.21ms
Started GET "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:51:52 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"70"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.2ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 0.9ms | Allocations: 1361)
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 0.8ms | Allocations: 3795)


Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 16:52:15 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"400", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000119d97c08 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-pfwys8.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"5", "description"=>"Travel", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 5], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Travel"], ["amount", 400], ["date", "2013-10-07"], ["invoice_number", 5], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:22:15.299602"], ["updated_at", "2022-08-08 11:22:15.299602"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 5], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 88]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "pcknrb74xxeh58e16ic087195lrk"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:22:15.303557"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 5], ["blob_id", 102], ["created_at", "2022-08-08 11:22:15.308040"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:22:15.309136"], ["id", 5]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: pcknrb74xxeh58e16ic087195lrk (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 88], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: d2c819f0-fca5-49be-873d-c104029fbd0a) to Async(default) with arguments: #<GlobalID:0x000000010c553a18 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/88>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 102]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 99)
Completed 200 OK in 21ms (Views: 0.6ms | ActiveRecord: 2.7ms | Allocations: 15363)


[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 88], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a] Performing ActiveStorage::PurgeJob (Job ID: d2c819f0-fca5-49be-873d-c104029fbd0a) from Async(default) enqueued at 2022-08-08T11:22:15Z with arguments: #<GlobalID:0x000000010da4d388 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/88>>
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 88], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 88]]
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 88], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 88]]
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a]   [1m[36mTRANSACTION (18.6ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a] [36m  Disk Storage (0.5ms) [0m[31mDeleted file from key: fjzzjn1xo13gt2fkt4zz89nrondm[0m
[ActiveJob] [ActiveStorage::PurgeJob] [d2c819f0-fca5-49be-873d-c104029fbd0a] Performed ActiveStorage::PurgeJob (Job ID: d2c819f0-fca5-49be-873d-c104029fbd0a) from Async(default) in 24.17ms
Started POST "/api/v1/expense_tracker/user/login?email=krishna@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 16:53:58 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"krishna@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "krishna@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 93)
Completed 200 OK in 253ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1128)


Started POST "/api/v1/expense_tracker/users/71/expenses" for 127.0.0.1 at 2022-08-08 16:54:09 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"2000", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000119016e80 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-ui6thy.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"6", "description"=>"Accomadation", "date"=>"2013-10-07"}, "user_id"=>"71"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 71], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 71], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 71], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 6], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.4ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Accomadation"], ["amount", 2000], ["date", "2013-10-07"], ["invoice_number", 6], ["status", 0], ["user_id", 71], ["created_at", "2022-08-08 11:24:09.908290"], ["updated_at", "2022-08-08 11:24:09.908290"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 6], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 89]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "7htani850rmnx6x5ldsjycg62qin"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:24:09.911854"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 6], ["blob_id", 103], ["created_at", "2022-08-08 11:24:09.912688"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:24:09.913325"], ["id", 6]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: 7htani850rmnx6x5ldsjycg62qin (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 89], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8) to Async(default) with arguments: #<GlobalID:0x0000000119457df0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/89>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 103]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.1ms | Allocations: 99)
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 15376)


[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 89], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8] Performing ActiveStorage::PurgeJob (Job ID: ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8) from Async(default) enqueued at 2022-08-08T11:24:09Z with arguments: #<GlobalID:0x0000000119704080 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/89>>
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 89], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mActiveStorage::VariantRecord Load (0.0ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 89]]
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 89], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mActiveStorage::Blob Destroy (0.2ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 89]]
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8]   [1m[36mTRANSACTION (17.9ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8] [36m  Disk Storage (0.3ms) [0m[31mDeleted file from key: 5d326mq9vzpu2vqiexl3825lya7z[0m
[ActiveJob] [ActiveStorage::PurgeJob] [ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8] Performed ActiveStorage::PurgeJob (Job ID: ee9e0b41-61ed-4f65-95ff-d2fb31bcdce8) from Async(default) in 23.39ms
Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 16:54:27 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 91)
Completed 200 OK in 253ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 1115)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 17:01:11 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.3ms | Allocations: 92)
Completed 200 OK in 273ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 1702)


Started POST "/api/v1/expense_tracker/user/logout" for 127.0.0.1 at 2022-08-08 17:01:28 +0530
Processing by SessionsController#destroy as JSON
  Parameters: {"session"=>{}}
  Rendering sessions/destroy.jbuilder
  Rendered sessions/destroy.jbuilder (Duration: 1.6ms | Allocations: 132)
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.0ms | Allocations: 709)


Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 17:01:32 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"2000", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000119a874c8 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-jf2ev3.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"9", "description"=>"Accomadation", "date"=>"2013-10-07"}, "user_id"=>"70"}
User not logged in
error #<CustomError::AuthenticationError: Please login and then proceed further>
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 746)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 17:01:40 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (3.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.1ms | Allocations: 91)
Completed 200 OK in 259ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 1106)


Started POST "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 17:01:48 +0530
Processing by ExpensesController#create as JSON
  Parameters: {"expense"=>{"amount"=>"2000", "document"=>#<ActionDispatch::Http::UploadedFile:0x0000000119aed980 @tempfile=#<Tempfile:/var/folders/td/_jwrfhwd5yqd3ftzk2w35ssm0000gp/T/RackMultipart20220808-65231-wckm9f.pdf>, @original_filename="sample.pdf", @content_type="application/pdf", @headers="Content-Disposition: form-data; name=\"expense[document]\"; filename=\"sample.pdf\"\r\nContent-Type: application/pdf\r\n">, "invoice_number"=>"9", "description"=>"Accomadation", "date"=>"2013-10-07"}, "user_id"=>"70"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? LIMIT ?[0m  [["invoice_number", 9], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Create (0.6ms)[0m  [1m[32mINSERT INTO "expenses" ("description", "amount", "date", "invoice_number", "status", "user_id", "created_at", "updated_at", "report_id", "approved_amount") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["description", "Accomadation"], ["amount", 2000], ["date", "2013-10-07"], ["invoice_number", 9], ["status", 0], ["user_id", 70], ["created_at", "2022-08-08 11:31:48.243391"], ["updated_at", "2022-08-08 11:31:48.243391"], ["report_id", nil], ["approved_amount", nil]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 7], ["record_type", "Expense"], ["name", "document"], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Destroy (0.1ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 90]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)[0m  [["key", "x4bikuek0v8gwuayfkvgn206rfyr"], ["filename", "sample.pdf"], ["content_type", "application/pdf"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 3028], ["checksum", "S0GjR1EyvYYbMKh44wqlag=="], ["created_at", "2022-08-08 11:31:48.248364"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "document"], ["record_type", "Expense"], ["record_id", 7], ["blob_id", 104], ["created_at", "2022-08-08 11:31:48.249390"]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mExpense Update (0.0ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:31:48.250262"], ["id", 7]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: x4bikuek0v8gwuayfkvgn206rfyr (checksum: S0GjR1EyvYYbMKh44wqlag==)[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 90], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 6ce28dcb-a160-4164-9e1b-8fc31d561ecf) to Async(default) with arguments: #<GlobalID:0x0000000119d75d88 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/90>>
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mActiveStorage::Blob Update (0.2ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "metadata" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["metadata", "{\"identified\":true,\"analyzed\":true}"], ["id", 104]]
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:65:in `add_user_expense'
  Rendering expenses/create.jbuilder
  Rendered expenses/create.jbuilder (Duration: 0.2ms | Allocations: 99)
Completed 200 OK in 20ms (Views: 0.5ms | ActiveRecord: 2.7ms | Allocations: 15509)


[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 90], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf] Performing ActiveStorage::PurgeJob (Job ID: 6ce28dcb-a160-4164-9e1b-8fc31d561ecf) from Async(default) enqueued at 2022-08-08T11:31:48Z with arguments: #<GlobalID:0x0000000119de48a0 @uri=#<URI::GID gid://expense-tracker/ActiveStorage::Blob/90>>
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 90], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mActiveStorage::VariantRecord Load (0.1ms)[0m  [1m[34mSELECT "active_storage_variant_records".* FROM "active_storage_variant_records" WHERE "active_storage_variant_records"."blob_id" = ?[0m  [["blob_id", 90]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 90], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mActiveStorage::Blob Destroy (0.3ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 90]]
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf]   [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf] [36m  Disk Storage (0.6ms) [0m[31mDeleted file from key: vdw72c46e764k9qo1o5dwjmkt8bz[0m
[ActiveJob] [ActiveStorage::PurgeJob] [6ce28dcb-a160-4164-9e1b-8fc31d561ecf] Performed ActiveStorage::PurgeJob (Job ID: 6ce28dcb-a160-4164-9e1b-8fc31d561ecf) from Async(default) in 28.39ms
Started GET "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 17:02:39 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"70"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 4.9ms | Allocations: 1724)
Completed 200 OK in 9ms (Views: 5.0ms | ActiveRecord: 0.9ms | Allocations: 4190)


Started GET "/api/v1/expense_tracker/users/70/expenses/1" for 127.0.0.1 at 2022-08-08 17:03:02 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"70", "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.7ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 1], ["commentable_type", "Expense"]]
  ↳ app/views/expenses/show.jbuilder:3
  Rendered expenses/show.jbuilder (Duration: 20.0ms | Allocations: 13449)
Completed 200 OK in 28ms (Views: 19.8ms | ActiveRecord: 1.6ms | Allocations: 16806)


Started PATCH "/api/v1/expense_tracker/users/70/expenses/1" for 127.0.0.1 at 2022-08-08 17:04:05 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted", "amount"=>400}, "user_id"=>"70", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x00000001193341f8>, params: {"expense"=>{"status"=>"submitted", "amount"=>400}, "controller"=>"expenses", "action"=>"update", "user_id"=>"70", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "amount" = ?, "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["amount", 400], ["status", 4], ["updated_at", "2022-08-08 11:34:07.398982"], ["id", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 1.0ms | Allocations: 282)
  Rendered layout layouts/mailer.text.erb (Duration: 1.9ms | Allocations: 515)
UserMailer#expense_update: processed outbound mail in 7.8ms
Delivered mail 62f0f4af6bd81_fecff23019445@CALTM00564.local.mail (3269.6ms)
Date: Mon, 08 Aug 2022 17:04:07 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0f4af6bd81_fecff23019445@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 1
expense status: rejected
expense amount: 400
approved amount: .



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 3.2ms | Allocations: 259)
Completed 200 OK in 5434ms (Views: 4.4ms | ActiveRecord: 2.5ms | Allocations: 34623)


Started PATCH "/api/v1/expense_tracker/users/70/expenses/2" for 127.0.0.1 at 2022-08-08 17:04:38 +0530
Error occurred while parsing request parameters.
Contents:

{
    "expense" :{
        "status": "submitted",
    }
}
Processing by ExpensesController#update as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
error #<ActionDispatch::Http::Parameters::ParseError: Error occurred while parsing request parameters>
Completed 500 Internal Server Error in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2101)


Started PATCH "/api/v1/expense_tracker/users/70/expenses/2" for 127.0.0.1 at 2022-08-08 17:04:45 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"submitted"}, "user_id"=>"70", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.5ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mInvoice Create (0.3ms)[0m  [1m[32mINSERT INTO "invoices" ("invoice_number", "biller", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["invoice_number", 2], ["biller", "Jaxnation"], ["created_at", "2022-08-08 11:34:46.628195"], ["updated_at", "2022-08-08 11:34:46.628195"]]
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/concerns/invoice_validator.rb:5:in `store_invoice_validations'
[31mUnpermitted parameter: :status. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000119bfd438>, params: {"expense"=>{"status"=>"submitted"}, "controller"=>"expenses", "action"=>"update", "user_id"=>"70", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 11:34:46.641913"], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.2ms | Allocations: 155)
Completed 200 OK in 1543ms (Views: 0.5ms | ActiveRecord: 3.3ms | Allocations: 20295)


Started PATCH "/api/v1/expense_tracker/users/70/expenses/2" for 127.0.0.1 at 2022-08-08 17:05:58 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "amount"=>200}, "user_id"=>"70", "id"=>"2"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:84:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
Forbidden request, expense is not in draft version. #<Pundit::NotAuthorizedError: not allowed to update? this Expense>
error #<CustomError::ValidationError: Forbidden, cannot edit expense once it is submitted for approval>
Completed 400 Bad Request in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 5283)


Started GET "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 17:07:06 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"70"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.4ms | Allocations: 1677)
Completed 200 OK in 5ms (Views: 1.6ms | ActiveRecord: 0.3ms | Allocations: 4147)


Started POST "/api/v1/expense_tracker/users/70/expenses/2/comments" for 127.0.0.1 at 2022-08-08 17:07:38 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"validate asap", "user_id"=>"70", "expense_id"=>"2"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x00000001190f9cd0>, params: {"comment"=>"validate asap", "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"70", "expense_id"=>"2"} }[0m
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.4ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "validate asap"], ["commentable_type", "Expense"], ["commentable_id", 2], ["user_id", 70], ["created_at", "2022-08-08 11:37:38.517600"], ["updated_at", "2022-08-08 11:37:38.517600"], ["parent_id", nil]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 1.4ms | Allocations: 211)
  Rendered layout layouts/mailer.text.erb (Duration: 1.7ms | Allocations: 318)
UserMailer#notify_comment: processed outbound mail in 3.3ms
Delivered mail 62f0f5828302f_fecff2441957b@CALTM00564.local.mail (2702.2ms)
Date: Mon, 08 Aug 2022 17:07:38 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0f5828302f_fecff2441957b@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: validate asap
commented at: 2022-08-08 11:37:38 UTC
commentd by: kasi


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 1.7ms | Allocations: 256)
Completed 200 OK in 2778ms (Views: 3.7ms | ActiveRecord: 6.7ms | Allocations: 14399)


Started GET "/api/v1/expense_tracker/users/70/expenses/2/comments" for 127.0.0.1 at 2022-08-08 17:07:56 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"70", "expense_id"=>"2"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 2], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 32]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 3.1ms | Allocations: 3091)
Completed 200 OK in 7ms (Views: 3.6ms | ActiveRecord: 0.6ms | Allocations: 4686)


Started GET "/api/v1/expense_tracker/users/70/expenses/2" for 127.0.0.1 at 2022-08-08 17:08:09 +0530
Processing by ExpensesController#show as */*
  Parameters: {"user_id"=>"70", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.4ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:27:in `show'
  Rendering expenses/show.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 2], ["commentable_type", "Expense"]]
  ↳ app/views/expenses/show.jbuilder:3
  Rendered expenses/show.jbuilder (Duration: 1.6ms | Allocations: 1086)
Completed 200 OK in 5ms (Views: 1.8ms | ActiveRecord: 0.6ms | Allocations: 4298)


Started GET "/api/v1/expense_tracker/users/70/expenses/2/comments" for 127.0.0.1 at 2022-08-08 17:08:18 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"70", "expense_id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 2], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 32]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 3.1ms | Allocations: 1543)
Completed 200 OK in 4ms (Views: 3.2ms | ActiveRecord: 0.2ms | Allocations: 2937)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 17:08:28 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 93)
Completed 200 OK in 250ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 1112)


Started PATCH "/api/v1/expense_tracker/users/70/expenses/2" for 127.0.0.1 at 2022-08-08 17:09:21 +0530
Processing by ExpensesController#update as JSON
  Parameters: {"expense"=>{"status"=>"approved", "approved_amount"=>50, "amount"=>99}, "user_id"=>"70", "id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:80:in `process_expense'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameter: :amount. Context: { controller: ExpensesController, action: update, request: #<ActionDispatch::Request:0x0000000119f24ad0>, params: {"expense"=>{"status"=>"approved", "approved_amount"=>50, "amount"=>99}, "controller"=>"expenses", "action"=>"update", "user_id"=>"70", "id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mExpense Update (0.4ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 11:39:21.547898"], ["approved_amount", 50], ["id", 2]]
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/expenses_controller.rb:37:in `update'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/expense_update.text.erb within layouts/mailer
  Rendered user_mailer/expense_update.text.erb within layouts/mailer (Duration: 0.0ms | Allocations: 21)
  Rendered layout layouts/mailer.text.erb (Duration: 0.1ms | Allocations: 127)
UserMailer#expense_update: processed outbound mail in 7.5ms
Delivered mail 62f0f5e98df69_fecff244196c9@CALTM00564.local.mail (2700.5ms)
Date: Mon, 08 Aug 2022 17:09:21 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0f5e98df69_fecff244196c9@CALTM00564.local.mail>
Subject: Expense update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Please find below details on your expense 

email: kasi@mail.com
expense invoice number is: 2
expense status: approved
expense amount: 250
approved amount: 50.



have a great day!


  Rendering expenses/update.jbuilder
  Rendered expenses/update.jbuilder (Duration: 0.9ms | Allocations: 121)
Completed 200 OK in 2805ms (Views: 3.9ms | ActiveRecord: 3.6ms | Allocations: 12594)


Started POST "/api/v1/expense_tracker/users/70/expenses/2/comments" for 127.0.0.1 at 2022-08-08 17:10:19 +0530
Processing by CommentsController#add_expense_comment as */*
  Parameters: {"comment"=>"it has been aproved", "parent_id"=>32, "user_id"=>"70", "expense_id"=>"2"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:5:in `add_expense_comment'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :expense_id. Context: { controller: CommentsController, action: add_expense_comment, request: #<ActionDispatch::Request:0x000000010c478490>, params: {"comment"=>"it has been aproved", "parent_id"=>32, "controller"=>"comments", "action"=>"add_expense_comment", "user_id"=>"70", "expense_id"=>"2"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mComment Create (0.3ms)[0m  [1m[32mINSERT INTO "comments" ("comment", "commentable_type", "commentable_id", "user_id", "created_at", "updated_at", "parent_id") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["comment", "it has been aproved"], ["commentable_type", "Expense"], ["commentable_id", 2], ["user_id", 69], ["created_at", "2022-08-08 11:40:19.695907"], ["updated_at", "2022-08-08 11:40:19.695907"], ["parent_id", 32]]
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/expense.rb:46:in `add_comment'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:7:in `add_expense_comment'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/notify_comment.text.erb within layouts/mailer
  Rendered user_mailer/notify_comment.text.erb within layouts/mailer (Duration: 0.1ms | Allocations: 26)
  Rendered layout layouts/mailer.text.erb (Duration: 0.2ms | Allocations: 130)
UserMailer#notify_comment: processed outbound mail in 1.2ms
Delivered mail 62f0f623ab17a_fecff26c1973a@CALTM00564.local.mail (2709.7ms)
Date: Mon, 08 Aug 2022 17:10:19 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0f623ab17a_fecff26c1973a@CALTM00564.local.mail>
Subject: Comment update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

You have a comment: it has been aproved
commented at: 2022-08-08 11:40:19 UTC
commentd by: admin


have a great day!

  Rendering comments/add_expense_comment.jbuilder
  Rendered comments/add_expense_comment.jbuilder (Duration: 2.1ms | Allocations: 87)
Completed 200 OK in 2722ms (Views: 3.2ms | ActiveRecord: 1.4ms | Allocations: 9007)


Started GET "/api/v1/expense_tracker/users/70/expenses/2/comments" for 127.0.0.1 at 2022-08-08 17:11:05 +0530
Processing by CommentsController#index_expense_comments as */*
  Parameters: {"user_id"=>"70", "expense_id"=>"2"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.0ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/comments_controller.rb:11:in `index_expense_comments'
  Rendering comments/index_expense_comments.jbuilder
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = ? AND "comments"."commentable_type" = ?[0m  [["commentable_id", 2], ["commentable_type", "Expense"]]
  ↳ app/views/comments/index_expense_comments.jbuilder:1
  [1m[36mComment Load (0.0ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 32]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  [1m[36mComment Load (0.1ms)[0m  [1m[34mSELECT "comments".* FROM "comments" WHERE "comments"."parent_id" = ?[0m  [["parent_id", 33]]
  ↳ app/views/comments/index_expense_comments.jbuilder:2
  Rendered comments/index_expense_comments.jbuilder (Duration: 2.5ms | Allocations: 2460)
Completed 200 OK in 4ms (Views: 2.8ms | ActiveRecord: 0.3ms | Allocations: 3854)


Started POST "/api/v1/expense_tracker/user/login?email=kasi@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 17:11:41 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"kasi@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "kasi@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.2ms | Allocations: 91)
Completed 200 OK in 253ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 1102)


Started GET "/api/v1/expense_tracker/users/70/expenses" for 127.0.0.1 at 2022-08-08 17:12:11 +0530
Processing by ExpensesController#index as */*
  Parameters: {"user_id"=>"70"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/expenses_controller.rb:70:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  Rendering expenses/index.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/views/expenses/index.jbuilder:3
  Rendered expenses/index.jbuilder (Duration: 1.8ms | Allocations: 1676)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.8ms | Allocations: 4121)


Started POST "/api/v1/expense_tracker/users/70/reports" for 127.0.0.1 at 2022-08-08 17:12:58 +0530
Processing by ReportsController#create as JSON
  Parameters: {"expenses"=>[1, 2, 3, 4, 5], "user_id"=>"70", "report"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/controllers/reports_controller.rb:43:in `expenses'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 1], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 2], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
expense 1 is already mapped or processed report 
expense 2 is already mapped or processed report 
  [1m[36mReport Create (0.6ms)[0m  [1m[32mINSERT INTO "reports" ("status", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)[0m  [["status", 0], ["created_at", "2022-08-08 11:42:58.622917"], ["updated_at", "2022-08-08 11:42:58.622917"], ["user_id", 70]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.5ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:42:58.627364"], ["report_id", 1], ["id", 3]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:42:58.630930"], ["report_id", 1], ["id", 4]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "updated_at" = ?, "report_id" = ? WHERE "expenses"."id" = ?[0m  [["updated_at", "2022-08-08 11:42:58.633380"], ["report_id", 1], ["id", 5]]
  ↳ app/controllers/reports_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:9:in `create'
  Rendering reports/create.jbuilder
  Rendered reports/create.jbuilder (Duration: 0.8ms | Allocations: 451)
Completed 200 OK in 27ms (Views: 2.1ms | ActiveRecord: 2.9ms | Allocations: 21106)


Started GET "/api/v1/expense_tracker/users/70/reports/1" for 127.0.0.1 at 2022-08-08 17:14:31 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"70", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.3ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 4.1ms | Allocations: 2010)
Completed 200 OK in 10ms (Views: 4.2ms | ActiveRecord: 1.4ms | Allocations: 5708)


Started PATCH "/api/v1/expense_tracker/users/66/reports/2" for 127.0.0.1 at 2022-08-08 17:15:02 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"66", "id"=>"2", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 66], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
error #<ActiveRecord::RecordNotFound: Couldn't find User with 'id'=66>
Completed 404 Not Found in 5ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1677)


Started PATCH "/api/v1/expense_tracker/users/70/reports/1" for 127.0.0.1 at 2022-08-08 17:15:09 +0530
Processing by ReportsController#update as JSON
  Parameters: {"status"=>"submitted", "user_id"=>"70", "id"=>"1", "report"=>{"status"=>"submitted"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 70]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.1ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:53:in `process_report'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
[31mUnpermitted parameters: :user_id, :id, :report. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000119dc4500>, params: {"status"=>"submitted", "controller"=>"reports", "action"=>"update", "user_id"=>"70", "id"=>"1", "report"=>{"status"=>"submitted"}} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:38:in `submit_dependent_expense'
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:38:in `submit_dependent_expense'
  [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 3], ["id", 3], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 11:45:11.057739"], ["id", 3]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 11:45:12.046150"], ["id", 4]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 5], ["id", 5], ["LIMIT", 1]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mExpense Update (0.1ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ? WHERE "expenses"."id" = ?[0m  [["status", 4], ["updated_at", "2022-08-08 11:45:13.568453"], ["id", 5]]
  ↳ app/models/report.rb:41:in `block in submit_dependent_expense'
  [1m[36mReport Update (0.1ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 2], ["updated_at", "2022-08-08 11:45:09.990581"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 1.2ms | Allocations: 426)
Completed 200 OK in 3620ms (Views: 1.7ms | ActiveRecord: 3.8ms | Allocations: 28753)


Started POST "/api/v1/expense_tracker/user/login?email=admin@mail.com&password=[FILTERED]" for 127.0.0.1 at 2022-08-08 17:15:57 +0530
Processing by SessionsController#create as JSON
  Parameters: {"email"=>"admin@mail.com", "password"=>"[FILTERED]", "session"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "admin@mail.com"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:8:in `create'
  Rendering sessions/create.jbuilder
  Rendered sessions/create.jbuilder (Duration: 0.4ms | Allocations: 94)
Completed 200 OK in 258ms (Views: 0.9ms | ActiveRecord: 0.7ms | Allocations: 1165)


Started PATCH "/api/v1/expense_tracker/users/70/reports/1" for 127.0.0.1 at 2022-08-08 17:16:28 +0530
Processing by ReportsController#update as JSON
  Parameters: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>4, "status"=>"approved", "approved_amount"=>250}]}, "user_id"=>"70", "id"=>"1"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.6ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mCACHE UserRole Load (0.0ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (0.4ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:48:in `process_report'
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ? AND "expenses"."id" = ? LIMIT ?[0m  [["report_id", 1], ["id", 4], ["LIMIT", 1]]
  ↳ app/models/report.rb:48:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
  [1m[36mExpense Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "expenses" WHERE "expenses"."invoice_number" = ? AND "expenses"."id" != ? LIMIT ?[0m  [["invoice_number", 4], ["id", 4], ["LIMIT", 1]]
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
  [1m[36mExpense Update (0.3ms)[0m  [1m[33mUPDATE "expenses" SET "status" = ?, "updated_at" = ?, "approved_amount" = ? WHERE "expenses"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 11:46:28.810501"], ["approved_amount", 250], ["id", 4]]
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/models/report.rb:49:in `block in update_dependent_expense'
[31mUnpermitted parameter: :expenses. Context: { controller: ReportsController, action: update, request: #<ActionDispatch::Request:0x0000000119315410>, params: {"report"=>{"status"=>"processed", "expenses"=>[{"id"=>4, "status"=>"approved", "approved_amount"=>250}]}, "controller"=>"reports", "action"=>"update", "user_id"=>"70", "id"=>"1"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mReport Update (0.3ms)[0m  [1m[33mUPDATE "reports" SET "status" = ?, "updated_at" = ? WHERE "reports"."id" = ?[0m  [["status", 3], ["updated_at", "2022-08-08 11:46:28.816708"], ["id", 1]]
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/reports_controller.rb:28:in `update'
  [1m[36mExpense Load (0.2ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/models/report.rb:24:in `inject'
  Rendering layout layouts/mailer.text.erb
  Rendering user_mailer/report_update.text.erb within layouts/mailer
  Rendered user_mailer/report_update.text.erb within layouts/mailer (Duration: 1.9ms | Allocations: 203)
  Rendered layout layouts/mailer.text.erb (Duration: 2.1ms | Allocations: 309)
UserMailer#report_update: processed outbound mail in 10.2ms
Delivered mail 62f0f794ccdac_fecff258198b8@CALTM00564.local.mail (3029.4ms)
Date: Mon, 08 Aug 2022 17:16:28 +0530
From: from@example.com
To: kasi@mail.com
Message-ID: <62f0f794ccdac_fecff258198b8@CALTM00564.local.mail>
Subject: Report update
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

email: kasi@mail.com

expense status: processed
expense amount: 1500
approved amount: 250.


have a great day!

  Rendering reports/update.jbuilder
  Rendered reports/update.jbuilder (Duration: 1.1ms | Allocations: 291)
Completed 200 OK in 3081ms (Views: 2.3ms | ActiveRecord: 4.1ms | Allocations: 17908)


Started GET "/api/v1/expense_tracker/users/70/reports/1" for 127.0.0.1 at 2022-08-08 17:16:59 +0530
Processing by ReportsController#show as JSON
  Parameters: {"user_id"=>"70", "id"=>"1", "report"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 70], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:38:in `find_user'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 69], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:10:in `current_user'
  [1m[36mUserRole Load (0.1ms)[0m  [1m[34mSELECT "user_roles".* FROM "user_roles" WHERE "user_roles"."user_id" = ?[0m  [["user_id", 69]]
  ↳ app/models/user.rb:38:in `admin?'
  [1m[36mReport Load (2.0ms)[0m  [1m[34mSELECT "reports".* FROM "reports" WHERE "reports"."user_id" = ? AND "reports"."id" = ? LIMIT ?[0m  [["user_id", 70], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:18:in `show'
  Rendering reports/show.jbuilder
  [1m[36mExpense Load (0.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" WHERE "expenses"."report_id" = ?[0m  [["report_id", 1]]
  ↳ app/views/reports/show.jbuilder:3
  Rendered reports/show.jbuilder (Duration: 1.5ms | Allocations: 1022)
Completed 200 OK in 10ms (Views: 1.8ms | ActiveRecord: 2.8ms | Allocations: 4333)


